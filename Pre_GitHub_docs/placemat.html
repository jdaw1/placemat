<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">
<html lang='en'>

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>Glasses placemat: how to avoid confusion at a port tasting</title>
<meta content="Labelled place settings for glasses used in a wine tasting" name="description">
<meta content="glasses, port, madeira, placemat, place setting, tasting" name="keywords">
<meta content="Julian D. A. Wiseman" name="author">
<meta content="general" name="rating">
<meta content="index,follow,noimageclick" name="robots">
<meta content="8 hours" name="expires">
<meta content="7 days" name="revisit">
<link href="../../favicon.ico" rel="SHORTCUT ICON">
<link rel="stylesheet" type="text/css" href="placemat.css">
</head>

<body>
<table width="100%" border="0" id="top">
<tr>
	<td width="30%" align="left"><a href="../../index.html">Main index</a></td>
	<td width="40%" align="center"><a href="placemats_list.html">List of placemats</a></td>
	<td width="30%" align="right"><a href="../../author.html">About author</a></td>
</tr></table>
<hr>

<div style="float: right;  margin-top: 0;  padding-top: 0;">
	<p style="border: none;  margin-top: 0;  padding-top: 0;">
		<a href="http://validator.w3.org/check?uri=http%3A%2F%2Fwww.jdawiseman.com%2Fpapers%2Fplacemat%2Fplacemat.html"><img src="../../graphics/valid-html401.png" alt="Valid HTML 4.01 Transitional" height="31" width="88"></a> 
		<a href="http://jigsaw.w3.org/css-validator/validator?uri=www.jdawiseman.com%2Fpapers%2Fplacemat%2Fplacemat.html"><img src="../../graphics/valid-css.png" alt="Valid CSS" height="31" width="88"></a>
	</p>
</div>

<h1>Glasses placemat: how to avoid confusion at a port tasting</h1>
<p align="right"><i>Julian D. A. Wiseman</i></p>

<p><b>Contents:</b> <a href="#pubhist">Publication history</a>; 
<a href="#example">example output</a> (and in <a href="placemat.pdf">PDF</a>); 
<a href="#control">How to control the PostScript program</a>; 
<a href="#other_parameters">Other easy parameters</a>; 
<a href="#complicated_parameters">Non-easy parameters</a>; 
<a href="#code">Code within parameters</a>; 
<a href="#errors">Errors: causation and avoidance</a>; 
<a href="#comment">How to comment</a>; 
<a href="#invite">Who to invite?</a>; 
<a href="#version_history">Recent changes</a>.</p>


<p id="pubhist"><b>Publication history:</b> only at <a href="http://www.jdawiseman.com/papers/placemat/placemat.html">www.jdawiseman.com</a>. 
Usual <a href="../../index.html#disclaimer">disclaimer</a> and <a href="../../index.html#copyright">copyright</a> terms apply. 
Also see the main feature, <b>the <a href="http://www.jdawiseman.com/papers/placemat/placemat.ps">PostScript program</a> itself</b>.</p>

<hr>

<div class="TextAside AsideDifferent" style="float: right; width: 50%;" id="preface"><p style="margin-top: 0;  padding-top: 0;"><a href="#preface">&bull;</a> 
This is the &lsquo;documentation&rsquo;, such as it is, for the latest version, 
dated January 2021, which prior precedent suggests will not be the last. 
The code is mostly debugged, but errors surely remain. 
Per <a href="../../index.html#disclaimer">disclaimer</a>, it is provided as-is, without guarantee and without liability: it is free.</p>
<p>Also see the 
<a href="placemats_list.html">complete list of previous placemats, some with comments</a>; 
the <a href="page_size_advice.html">advice about choosing of the page size</a>; 
the <a href="obscure_parameters.html">obscure parameters</a>; 
<a href="placemat-code.html">how to use code in parameters</a>;  
<a href="diacritics_timesbold.html"><tt>/TimesNewRomanPS-BoldMT</tt>&rsquo;s accented characters and their PostScript glyphs</a>, 
which includes diacritics as well as accents.
Further, PostScript programmers are invited to peruse the infrequently updated 
<a href="postscript_routines.html">list of re-usable routines</a>.</p></div>

<h2 id="introduction"><a href="#introduction">&bull;</a> Introduction</h2>

<p>So you and your lucky guests are to enjoy a port tasting. 
Of course, there will be many glasses, each person having one for each port. 
But it is important to avoid the what-is-in-this-glass confusion: 
each person will need a wine tasting placemat, 
clearly labelling each glass&rsquo;s spot.</p>

<p><a href="../../author.html">The author</a> has devised a 
<a href="http://www.jdawiseman.com/papers/placemat/placemat.ps">PostScript program</a> to create such pages, and all the other paperwork required to manage such tastings, large or small. 
Glasses pages are set as in the <a href="placemat.pdf">PDF example</a>, the first two pages of which (to hold the glasses, and on which to write tasting notes) are also rendered 
<a href="#example">immediately below</a>.</p>

<div style="clear: both; margin: 4px 0px 0px 0px; text-align: center;" id="example"><a class="BorderGraphic" style="margin: 0px 0px 4px 0px;" href="placemat.pdf"><img alt="Example of an 5-glass port tasting placemat" width="548" height="797" src="placemat.png"></a> <a class="BorderGraphic" style="margin: 0px 0px 4px 0px;" href="placemat.pdf"><img alt="Example of tasting-note sheet" width="549" height="797" src="placemat_tn.png"></a></div>

<div id="examples">
<p>The <a href="placemats_list.html">complete list of placemats</a> has many examples.</p>

<p>For a few of the &ge;2012 placemats, the parameters used in the construction are quoted in a thread on ThePortForum, 
<a href="http://www.theportforum.com/viewtopic.php?t=5837&amp;start=99999#bottom">Parameters for the placemat software</a>. 
Users wishing to replicate a feature might be helped by some of those examples.</p>
</div>

<div class="BigBoxDifferent" id="advice_for_beginners">
	<table style="width: 100%;  margin-top: 0;"><tr>
		<td style="vertical-align: top; text-align: left;  "><p style="margin-top: 0;">&darr;<a href="#control">Skip</a>&darr;</p></td>
		<td style="vertical-align: top; text-align: center;"><h2><a href="#advice_for_beginners">&bull;</a>&nbsp;Making Your First Placemat: Advice for Beginners</h2></td>
		<td style="vertical-align: top; text-align: right; "><p style="margin-top: 0;">&darr;<a href="#control">Skip</a>&darr;</p></td>
	</tr></table>

	<p id="advice_for_beginners_early"><a href="#advice_for_beginners_early">&bull;</a> 
	Don&rsquo;t try to make your first placemats with little time to spare. 
	Start a week in advance, to allow time for learning and improvements, and to avoid the other things that need doing just before a tasting. 
	Yes, it can be done in a few minutes&mdash;but not your first placemats.</p>

	<p id="advice_for_beginners_wizard"><a href="#advice_for_beginners_wizard">&bull;</a> 
	First there is a decision. 
	<a href="http://www.theportforum.com/memberlist.php?mode=viewprofile&amp;u=9967">Mike Meehan</a>, a friend of the author of the PostScript program, has made a <a href="http://www.planetmeehan.com/tpf/wizard.php">web-based user interface</a> (a &lsquo;Wizard&rsquo;). 
	The Wizard has the great advantage of simplifying the making of the placemats, and does some hand-holding of the user. 
	The Wizard also, both advantage and disadvantage, hides almost all of the 400+ parameters, putting many placemat features and settings beyond its reach. 
	The Wizard also has the disadvantage that to change or clone the placemats relies on Mike&rsquo;s server being available, which <a href="http://www.theportforum.com/viewtopic.php?p=113560#p113560">it wasn&rsquo;t in late 2019</a>.
	So the Wizard might be better for non-geeks. 
	If using the Wizard, continue at <a href="http://www.planetmeehan.com/tpf/wizard.php">www.planetmeehan.com/tpf/wizard.php</a>. 
	If not using the Wizard, then continue with this manual, the rest of which assumes not using the Wizard.</p>

	<div class="TextAside" style="float: right;  width: 30%;  border: 2px solid #666666;  font-size: smaller;  background-color: #fafafa;  padding: 1px;">
		<h3 style="text-align: center;  margin-top: 1px;">Sublime Text 3</h3>
		<p>Instructions from <a href="http://www.sublimetext.com/forum/viewtopic.php?t=17312&amp;start=11">Sublime forum</a> (Dec 2014): <span style="font-family: sans-serif;">View&nbsp;&gt;&nbsp;Show&nbsp;Console</span>, into which paste</p>
		<p style="font-family: monospace;  font-size: 50%;  word-wrap: break-word;">import shutil;import urllib.request;import os;import tempfile;l='https://raw.githubusercontent.com/textmate/postscript.tmbundle/master/Syntaxes/Postscript.tmLanguage';d=urllib.request.urlopen(l);f=d.read().decode('utf-8');p=os.path.join(sublime.packages_path(),'User','PostScript.tmLanguage');_, t = tempfile.mkstemp(dir=tempfile.gettempdir());th = open(t, 'w');th.writelines(f);th.close();shutil.move(t, p) if f.find('plist') != -1 else sublime.error_dialog('Something went wrong, file is corrupt');dh = open(p);ok = True if dh.read().find("Postscript") != "-1" else False;sublime.message_dialog('Installation completted successfully') if ok is True else sublime.error_dialog('Installation aborted - deleting file %s ' % p);os.remove(p) if not ok else print("File created successfully");</p></div> 
	<p id="advice_for_beginners_editor"><a href="#advice_for_beginners_editor">&bull;</a> 
	A code editor, a good text editor, is a boon, and it should be one that understands PostScript. 
	The basic text editor that came pre-installed on your computer will make life harder than it needs to be. 
	A code editor that understands PostScript will prevent many errors and save much labour. 
	On both Mac and PC <a href="http://www.sublimetext.com/3">Sublime Text&nbsp;3</a> is my preferred editor; making Sublime understand PostScript requires the step in the box on the right.	
	On a PC <a href="http://notepad-plus.sourceforge.net/uk/site.htm">NotePad++</a> is also good. 
	<a href="http://aquamacs.org/">Aquamacs Emacs</a> is suitable for Emacs experts. 
	(And for OS&nbsp;X versions &le;10.8 my preference was <a href="http://alphatcl.sourceforge.net/wiki/">Alpha&nbsp;X</a>, which doesn&rsquo;t work at all under macOS&nbsp;&ge;10.12.)</p>

	<p id="advice_for_beginners_download"><a href="#advice_for_beginners_download">&bull;</a> 
	Bookmark <a href="http://www.jdawiseman.com/papers/placemat/placemat.html">this manual</a>,
	and download to your machine a copy of the <a href="http://www.jdawiseman.com/papers/placemat/placemat.ps">PostScript code</a> 
	(update this copy every time: new versions fix bugs; add features; improve default settings).
	Store it in a directory named something like &ldquo;placemats&rdquo;. 
	Make a copy of <a href="http://www.jdawiseman.com/papers/placemat/placemat.ps">the original PostScript</a>.
	Give it a name which will make sense in aeons to come: perhaps <i>YYYYMMDD</i>.ps, or <i>YYYYMMDD_TastingName</i>.ps. 
	Perhaps see the files names in the <a href="placemats_list.html">list of old placemats</a>.</p>

	<p id="advice_for_beginners_convert"><a href="#advice_for_beginners_convert">&bull;</a> 
	You have saved a .ps file. 
	This file is to be opened in two different ways: with the code editor; and with a program to convert it from .ps to .pdf. 
	Let&rsquo;s master the latter. 
	On a Mac right-click the file, and &lsquo;Open With&rsquo; Preview. 
	It should convert to a PDF. 
	On a PC, in your preferred web browser, open <a href="http://online2pdf.com/convert-ps-to-pdf">online2pdf.com/convert-ps-to-pdf</a> (or, with fewer fonts available, <a href="http://www.ps2pdf.com/convert-ps-to-pdf">ps2pdf.org</a>); 
	&lsquo;Select files&hellip;&rsquo;; and &lsquo;Convert&rsquo; it. 
	You can now convert the PostScript to PDF.</p>

	<p id="advice_for_beginners_basics"><a href="#advice_for_beginners_basics">&bull;</a> 
	Open the file with the code editor, perhaps by right-clicking and choosing from the &lsquo;Open With&rsquo; applications (Sublime Text, NotePad++, whatever). 
	For a sense of which of the many features might be wanted look at the <a href="placemats_list.html">complete list of old placemats</a>, some of which have helpful comments and advice. 
	Then use the text editor to edit the copy of the PostScript, changing to values appropriate for your tasting the:</p>
	<ul>
		<li>wines, by changing <tt><a href="#circlearrays">Circlearrays</a></tt>, <tt><a href="#titles">Titles</a></tt>, <tt><a href="#belowtitles">Belowtitles</a></tt>, and perhaps later the <tt><a href="#abovetitles_overtitles">Abovetitles</a></tt> and <tt><a href="#abovetitles_overtitles">Overtitles</a></tt>;</li>
		<li>people, by changing <tt><a href="#names">Names</a></tt>;</li>
		<li>the <a href="#headers_footers">page header</a>, by changing <tt><a href="#headers_footers_externallinks">HeadersLeft</a></tt> and <tt>HeadersCenter</tt> and maybe <tt>HeadersRight</tt>;</li>
		<li><a href="#papertype_orientation">page size</a> (perhaps <tt>TastingNotesPaperType</tt> as well as <tt>PaperType</tt>), most obviously if wanting <tt><span class="nametype">/USL</span></tt> = 8&frac12;&Prime;&times;11&Prime; rather than the default of <tt><span class="nametype" title="210mm&times;297mm &asymp;&nbsp;8.27&Prime;&times;11.69&Prime;">/A4</span></tt>. 
		(For advice on choosing the page size see <a href="page_size_advice.html">Glasses placemat: choosing a paper size</a>.)</li>
	</ul><p>Convert to PDF, to test that all is well.</p>

	<p id="advice_for_beginners_decanterlabels"><a href="#advice_for_beginners_decanterlabels">&bull;</a> 
	Alter as necessary 
	<span title="Labels to hang around the neck of the decanters"><tt><a href="#decanterlabels">DecanterLabelsNumCopies</a></tt></span>, 
	<span title="So everybody knows who everybody else is, even late in the tasting"><tt><a href="#placenames">PlaceNames</a></tt></span>, 
	<span title="Pouring in advance? Do label the sets of glasses with what is in them."><tt><a href="#prepour">PrePourNumCopies</a></tt></span>, 
	<span title="To record the time each bottle is decanted, the condition of the cork, and the qualities of the sediment"><tt><a href="#decantingnotes">DecantingNotesNumCopies</a></tt></span>, 
	<span title="To display the corks"><tt><a href="#corkdisplay">CorkDisplayNumCopies</a></tt></span>, 
	<span title="On which to write the votes for Wine Of The Night"><tt><a href="#voterecorder">VoteRecorders</a></tt></span>, 
	<span title="Sticky labels for the bottles; or&mdash;if there are fewer glasses than wines, or not enough table space for glasses sheets&mdash;for the glasses."><tt><a href="#stickylabels">StickyLabelsNumCopies</a></tt> and <tt>StickyLabelsTypes</tt></span>.</p>

	<p id="advice_for_beginners_logo"><a href="#advice_for_beginners_logo">&bull;</a> 
	If it isn&rsquo;t a <a href="http://www.theportforum.com/">ThePortForum</a> event, 
	remove the <img width="16" height="16" src="tpf_bw_16.gif" alt="small black-and-white ThePortForum logo" style="vertical-align: text-top;"> logos 
	by setting <tt><a href="#theportforum_logo">ThePortForumIconPlacement</a></tt> 
	and <tt><a href="#theportforum_logo">ThePortForumIconTastingNotePlacement</a></tt> to <tt><span class="nametype">/None</span></tt>. 
	Convert to PDF.</p>

	<p id="advice_for_beginners_decorate"><a href="#advice_for_beginners_decorate">&bull;</a> 
	Perhaps (and perhaps not) change the <a href="#other_parameters_decoration">glass-decoration settings</a>: set <tt><a href="#inlinetitles">InlineTitles</a></tt> to <tt><span class="operator">false</span></tt>; activate others. 
	Play and experiment. Convert to PDF after each significant change, and admire the results.
	Choose a small subset of the decorative features to go in the final placemats. 
	Too many flamboyant features looks cluttered and horrible, so be parsimonious.
	Perhaps change the the fonts&mdash;a list of valid PostScript font names being most easily made by distilling <a href="http://www.jdawiseman.com/papers/placemat/fonts_illustrated.ps">fonts_illustrated.ps</a>. 
	Convert to PDF.</p>

	<p id="advice_for_beginners_externallinks"><a href="#advice_for_beginners_externallinks">&bull;</a> 
	Some PDF viewers can show a sidebar, typically containing bookmarks to places within the document. 
	This can also contain external links, typically to the likes of: the thread in which the tasting was arranged; the latest version of the PDF file; location of the tasting; perhaps a winemaker&rsquo;s website; etc. 
	These are configured in the array <tt><a href="#externallinks">ExternalLinks</a></tt>, which is of length a multiple three, boolean then text description then URL, then the next boolean/description/URL, etc.
	Populate <tt><a href="#externallinks">ExternalLinks</a></tt>.</p>

	<p id="advice_for_beginners_upload"><a href="#advice_for_beginners_upload">&bull;</a> 
	If the tasting is being arranged via <a href="http://www.theportforum.com/viewforum.php?f=3">ThePortForum</a> or another wine bulletin board,
	upload the PDF to the web, and post in an appropriate thread a link labelled something like &ldquo;Current <span class="PseudoLink" title="Here on jdawiseman.com this isn&rsquo;t a link, but should be when you post in a thread.">draft of the placemats</span>&rdquo;. 
	Allow some time for comments and corrections and changes. 
	Update as appropriate.</p>

	<p id="advice_for_beginners_author_to_help"><a href="#advice_for_beginners_author_to_help">&bull;</a> 
	Perhaps send to <a href="../../author.html">the author</a> links to the .ps and .pdf. 
	Time and convenience permitting, help might be forthcoming. 
	Please send the URLs of the uploaded .ps and .pdf files, rather than filling email with large enclosures. 
	Allow some days for a response.</p>

	<div id="advice_for_beginners_print"><p><a href="#advice_for_beginners_print">&bull;</a> 
	The day before the tasting print the mats using a toner printer.</p>
	<ul>
		<li>The print dialogue box probably controls scaling: set to &ldquo;No automatic page scaling&rdquo;, or scaling of 100%, or equivalent. 
		(Automatic page scaling can be very wrong, scaling to invisible and irrelevant artefacts in the PDF.)</li>
		<li>On some Konica Minolta printers, and perhaps others, checking &ldquo;Choose paper size by PDF page size&rdquo; means the output is very small, a mirror image, and on paper of the wrong size. 
		This is not good. 
		On other printers this setting can be useful&mdash;experiment as necessary.</li>
		<li>If printing on a Mac from the Preview application, 
		and perhaps also with other operating systems or applications, 
		set the paper size to the &ldquo;(borderless)&rdquo; variant.</li>
		<li>Print single-sided&mdash;obviously duplex wouldn&rsquo;t work.</li>
		<li>Use toner not ink, as a single drop of wine or water causes ink to smudge.</li>
		<li>Print onto brilliant white paper of the correct size. 
		In the US prefer 96 bright paper to the slightly-yellow 92.</li>
	</ul></div>

	<div id="advice_for_beginners_decanter_labels"><p><a href="#advice_for_beginners_decanter_labels">&bull;</a> 
	Neatly fold the <a href="#placenames">place-names</a> pages. 
	Cut the <a href="#NeckTags">neck tags</a>. 
	And construct the <a href="#decanterlabels">decanter labels</a>: cut a neat rectangle around each; 
	paste to the back of a business card (perhaps cards made obsolete by a promotion or a change of employer&mdash;keep old cards); 
	allow the glue to dry; 
	punch holes top-left and top-right; 
	hang on the decanter, perhaps using a <a href="http://www.amazon.co.uk/exec/obidos/ASIN/B007ZT2DHM/jdaw">36&Prime; metal ball chain</a> 
	(filling an unlabelled decanter risks needless confusion, so hang before filling).</p>
	</div>

	<p id="advice_for_beginners_feedback"><a href="#advice_for_beginners_feedback">&bull;</a> 
	A beginner reads these instructions as a beginner. 
	I wrote and use the code, so can&rsquo;t read these instructions as a beginner. 
	So I might have misjudged what needs explaining. 
	If you get stuck, even if only briefly, please send <a href="../../author.html">me</a> details, so that instructions can be made clearer. 
	Thank you.</p>

	<p id="advice_for_beginners_decanter_enjoy"><a href="#advice_for_beginners_decanter_enjoy">&bull;</a> 
	Enjoy the tasting.</p>
</div>

<h2 id="control"><a href="#control">&bull;</a>&nbsp;How to control the PostScript program</h2>

<div class="TextAside AsideDifferent" style="clear: both;  float: right;  width: 25%;  font-size: smaller;"><h3 style="text-align: center;  padding: 0;  margin: 1px 0 0 0;">Mac Distiller</h3>
<p>Mac users with Adobe Distiller might wish to have multiple simultaneous instances of Distiller. 
This can be done with <a href="DistillerNewInstance.applescript">DistillerNewInstance&#8203;.applescript</a>, which needs to be opened in the Script Editor, then File > Export&hellip;, File Format = Application. 
This AppleScript was made with help from <a href="http://stackoverflow.com/questions/58608408/applescript-to-pass-dragged-document-to-another-application">StackOverflow.com</a>.</p></div>

<p>PostScript programs are in the form of a text file, which can be interpreted by 
<a href="https://www.acrobat.com/en_us/free-trial-download.html">Adobe Distiller</a>, by Preview on the Mac OS X, by 
<a href="http://www.gnu.org/software/ghostscript/ghostscript.html">GNU Ghostscript</a>, 
or by any PostScript printer (though sending raw PostScript to a printer might require some technical knowledge). 
Several websites offer free PS&rarr;PDF conversion, including <a href="http://online2pdf.com/convert-ps-to-pdf">online2pdf.com/convert-ps-to-pdf</a> and (with fewer fonts) <a href="http://www.ps2pdf.com/convert-ps-to-pdf">ps2pdf.org</a> 
(fonts available on <a href="fonts_ps2pdf.pdf">ps2pdf</a> and <a href="fonts_online2pdf.pdf">online2pdf</a>). 
The text file can be edited in any text editor, though it is easier to use a text editor that has been configured to edit PostScript files&mdash;see <a href="#advice_for_beginners_editor">comment in <i>Making Your First Placemat: Advice for Beginners</i></a>.</p> 

<p>After some opening comments (after a &ldquo;<tt><span class="comment">%</span></tt>&rdquo; character the remainder of a line is a comment), 
<a href="http://www.jdawiseman.com/papers/placemat/placemat.ps">the program</a> defines some arrays, 
starting with <tt>Titles</tt>, <tt>Belowtitles</tt>, and <tt>Circlearrays</tt>. Each of these arrays has 
the same length, typically equal to the number of glass-settings on the page 
(five in the <a href="#example">example above</a>), and 
the program copes with any sensible number of glasses.</p>

<p id="titles"><a href="#titles">&loz;</a> In <a href="#example">the example</a> provided, <tt>Titles</tt> is defined thus:</p>
<div><pre><span class="nametype">/Titles</span> <span class="array">[</span>
	<span class="stringtype">(F85)</span>
	<span class="stringtype">(F85)</span>
	<span class="stringtype">(F85)</span>
	<span class="stringtype">(F77)</span>
	<span class="stringtype">(F70)</span>
<span class="array">]</span> <span class="operator">def</span></pre></div>

<p>Observe that the array is delimited with square parentheses <tt><span class="array">[</span></tt>&hellip;<tt><span class="array">]</span></tt>, and that each of the strings is delimited with round parentheses <tt><span class="stringtype">(</span></tt>&hellip;<tt><span class="stringtype">)</span></tt>. 
White space outside strings is ignored. 
The page looks best if each of the <tt>Titles</tt> is short, ideally &le;4 characters.</p>

<p style="font-size: small;">(Throughout this manual PostScript is shown in monospace with a pale grey background. 
Most code editors helpfully colour the different types of element. 
The colouring of Sublime Text is approximately echoed here: <tt><span class="nametype">/names</span></tt>;
<tt><span class="operator">operators</span></tt>; 
<tt><span class="stringtype">(strings)</span></tt>; 
<tt><span class="array">array and code parentheses [&nbsp;] {&nbsp;}</span></tt>;
and <tt><span class="comment">%&nbsp;comments</span></tt>.)</p>

<p id="belowtitles"><a href="#belowtitles">&loz;</a> <tt>Belowtitles</tt> is an array of the same length, though, in <a href="#example">the example</a>, some of the strings are empty:</p>
<div><pre><span class="nametype">/Belowtitles</span> <span class="array">[</span>
	<span class="stringtype">(Imperial)</span>
	<span class="stringtype">(Magnum)</span>
	<span class="stringtype">(Single)</span>
	<span class="stringtype">()</span>
	<span class="stringtype">()</span>
<span class="array">]</span> <span class="operator">def</span></pre></div>

<p>If an auction house is hosting the tasting, <tt>Belowtitles</tt> might contain lot numbers: 
<tt><span class="stringtype">(123)</span></tt>, or even <tt><span class="array">[</span><span class="stringtype">(123)</span>&nbsp;<span class="nametype">/arrowright</span>&nbsp;<span class="stringtype">(129)</span><span class="array">]</span></tt> = &ldquo;123&rarr;129&rdquo; (see <a href="#compoundstring">below</a>).</p>

<p id="circlearrays"><a href="#circlearrays">&loz;</a> And <tt>Circlearrays</tt>, which is an array of arrays, thus:</p>
<div><pre><span class="nametype">/Circlearrays</span> <span class="array">[</span>
	<span class="array">[</span> <span class="stringtype">(1985)</span>  <span class="stringtype">(Fonseca)</span>  <span class="stringtype">(Imperial=6L)</span> <span class="array">]</span>
	<span class="array">[</span> <span class="stringtype">(1985)</span>  <span class="stringtype">(Fonseca)</span>  <span class="array">[</span><span class="stringtype">(Magnum=1)</span> <span class="nametype">/onehalf</span> <span class="stringtype">(L)</span><span class="array">]</span> <span class="array">]</span>
	<span class="array">[</span> <span class="stringtype">(1985)</span>  <span class="stringtype">(Fonseca)</span>  <span class="array">[</span><span class="stringtype">(Single=)</span> <span class="nametype">/threequarters</span> <span class="stringtype">(L)</span><span class="array">]</span> <span class="array">]</span>
	<span class="array">[</span> <span class="stringtype">(1977)</span>  <span class="stringtype">(Fonseca)</span> <span class="array">]</span>
	<span class="array">[</span> <span class="stringtype">(1970)</span>  <span class="stringtype">(Fonseca)</span> <span class="array">]</span>
<span class="array">]</span> <span class="operator">def</span></pre></div>


<p>Each of the sub-arrays of <tt>Circlearrays</tt> contains strings (or a generalisation of the string type here called a <i>compound string</i>, described <a href="#compoundstring">below</a>). 
The program calculates how many copies of these sub-arrays can be spaced around the circle, 
and then does so with equal spacing between the elements of the sub-arrays.</p>

<p id="names"><a href="#names">&loz;</a> Each place settings is named 
(e.g., <a href="../../author.html">the author</a>&rsquo;s &ldquo;JDAW&rdquo; initials are on the page shown above), 
and these names are listed in yet another array, not necessarily of the same length as the previous three:</p>
<div><pre><span class="nametype">/Names</span> <span class="array">[</span>
	<span class="stringtype">(JDAW)</span>
	<span class="array">[</span><span class="stringtype">(G)</span> <span class="nametype">/uacute</span> <span class="nametype">/edieresis</span> <span class="stringtype">(st )</span> <span class="nametype">/Ocircumflex</span> <span class="nametype">/ntilde</span> <span class="nametype">/egrave</span><span class="array">]</span>
	<span class="stringtype">(Guest Two)</span>
	<span class="stringtype">()</span>
<span class="array">]</span> <span class="operator">def</span></pre></div>

<p>Including a blank name, <tt><span class="stringtype">()</span></tt>, is very strongly recommended: last-minute changes to the guest list do happen.</p>

<div class="TextAside" style="text-align: justify;  font-size: smaller; width: 65%; float: right;" id="glyphs">
<p><i>Accents and modifiers</i>: <span class="CharacterName">
&Aacute;&nbsp;<tt><span class="nametype">/Aacute</span></tt> 
&aacute;&nbsp;<tt><span class="nametype">/aacute</span></tt> 
&Acirc;&nbsp;<tt><span class="nametype">/Acircumflex</span></tt> 
&acirc;&nbsp;<tt><span class="nametype">/acircumflex</span></tt> 
&agrave;&nbsp;<tt><span class="nametype">/agrave</span></tt> 
&aring;&nbsp;<tt><span class="nametype">/aring</span></tt> 
&atilde;&nbsp;<tt><span class="nametype">/atilde</span></tt> 
&auml;&nbsp;<tt><span class="nametype">/adieresis</span></tt> 
&Ccedil;&nbsp;<tt><span class="nametype">/Ccedilla</span></tt> 
&#275;&nbsp;<tt><span class="nametype">/emacron</span></tt> 
&oslash;&nbsp;<tt><span class="nametype">/oslash</span></tt></span> etc 
(more in <a href="diacritics_timesbold.html"><tt>/TimesNewRomanPS-BoldMT</tt>: accented characters and their PostScript glyphs</a>).
</p>

<p><i>Punctuation, ligatures</i>: <span class="CharacterName">
&lsquo;&nbsp;<tt><span class="nametype">/quoteleft</span></tt> 
&rsquo;&nbsp;<tt><span class="nametype">/quoteright</span></tt> 
&ldquo;&nbsp;<tt><span class="nametype">/quotedblleft</span></tt> 
&rdquo;&nbsp;<tt><span class="nametype">/quotedblright</span></tt> 
&hellip;&nbsp;<tt><span class="nametype">/ellipsis</span></tt> 
&ndash;&nbsp;<tt><span class="nametype">/endash</span></tt> 
&mdash;&nbsp;<tt><span class="nametype">/emdash</span></tt> 
&lsaquo;&nbsp;<tt><span class="nametype">/guilsinglleft</span></tt> 
&rsaquo;&nbsp;<tt><span class="nametype">/guilsinglright</span></tt> 
&sbquo;&nbsp;<tt><span class="nametype">/quotesinglbase</span></tt> 
&bdquo;&nbsp;<tt><span class="nametype">/quotedblbase</span></tt>
&#64257;&nbsp;<tt><span class="nametype">/fi</span></tt> 
&#64258;&nbsp;<tt><span class="nametype">/fl</span></tt> 
&aelig;&nbsp;<tt><span class="nametype">/ae</span></tt> 
&AElig;&nbsp;<tt><span class="nametype">/AE</span></tt> 
&oelig;&nbsp;<tt><span class="nametype">/oe</span></tt>
&OElig;&nbsp;<tt><span class="nametype">/OE</span></tt> 
&szlig;&nbsp;<tt><span class="nametype">/germandbls</span></tt></span></p>

<p><i>Currencies, fractions, arithmetic</i>: <span class="CharacterName">
&pound;&nbsp;<tt><span class="nametype">/sterling</span></tt> 
&euro;&nbsp;<tt><span class="nametype">/Euro</span></tt> 
&yen;&nbsp;<tt style="margin-right: 0;"><span class="nametype">/yen</span></tt> <span style="margin-right: 1.25em;">(CNY)</span> 
&#8361;&nbsp;<tt><span class="nametype">/won</span></tt> 
&cent;&nbsp;<tt><span class="nametype">/cent</span></tt> 
&frac12;&nbsp;<tt><span class="nametype">/onehalf</span></tt> 
&frac14;&nbsp;<tt><span class="nametype">/onequarter</span></tt> 
&frac34;&nbsp;<tt><span class="nametype">/threequarters</span></tt> 
&#8539;&nbsp;<tt><span class="nametype">/oneeighth</span></tt> 
&#8540;&nbsp;<tt><span class="nametype">/threeeighths</span></tt> 
&#8532;&nbsp;<tt><span class="nametype">/twothirds</span></tt> 
&asymp;&nbsp;<tt><span class="nametype">/approxequal</span></tt> 
&ge;&nbsp;<tt><span class="nametype">/greaterequal</span></tt> 
&le;&nbsp;<tt><span class="nametype">/lessequal</span></tt> 
&times;&nbsp;<tt><span class="nametype">/multiply</span></tt> 
&divide;&nbsp;<tt><span class="nametype">/divide</span></tt></span></p>

<p><i>Greeks</i>: <span class="CharacterName">
&alpha;&nbsp;<tt><span class="nametype">/alpha</span></tt> 
&beta;&nbsp;<tt><span class="nametype">/beta</span></tt> 
&gamma;&nbsp;<tt><span class="nametype">/gamma</span></tt> 
&delta;&nbsp;<tt><span class="nametype">/delta</span></tt> 
&epsilon;&nbsp;<tt><span class="nametype">/epsilon</span></tt> 
&zeta;&nbsp;<tt><span class="nametype">/zeta</span></tt> 
&eta;&nbsp;<tt><span class="nametype">/eta</span></tt> 
&theta;&nbsp;<tt><span class="nametype">/theta</span></tt> 
&iota;&nbsp;<tt><span class="nametype">/iota</span></tt> 
&kappa;&nbsp;<tt><span class="nametype">/kappa</span></tt> 
&lambda;&nbsp;<tt><span class="nametype">/lambda</span></tt> 
&mu;&nbsp;<tt><span class="nametype">/mu</span></tt> 
&nu;&nbsp;<tt><span class="nametype">/nu</span></tt> 
&xi;&nbsp;<tt><span class="nametype">/xi</span></tt> 
&omicron;&nbsp;<tt><span class="nametype">/omicron</span></tt> 
&pi;&nbsp;<tt><span class="nametype">/pi</span></tt> 
&rho;&nbsp;<tt><span class="nametype">/rho</span></tt> 
&sigma;&nbsp;<tt><span class="nametype">/sigma</span></tt> 
&tau;&nbsp;<tt><span class="nametype">/tau</span></tt> 
&upsilon;&nbsp;<tt><span class="nametype">/upsilon</span></tt> 
&phi;&nbsp;<tt><span class="nametype">/phi</span></tt> 
&chi;&nbsp;<tt><span class="nametype">/chi</span></tt> 
&psi;&nbsp;<tt><span class="nametype">/psi</span></tt> 
&omega;&nbsp;<tt><span class="nametype">/omega</span></tt> and 
&Alpha;&nbsp;<tt><span class="nametype">/Alpha</span></tt> etc</span></p>

<p><i>Other</i>: <span class="CharacterName">
&dagger;&nbsp;<tt><span class="nametype">/dagger</span></tt> 
&Dagger;&nbsp;<tt><span class="nametype">/daggerdbl</span></tt> 
&loz;&nbsp;<tt><span class="nametype">/lozenge</span></tt> 
&bull;&nbsp;<tt><span class="nametype">/bullet</span></tt> 
&middot;&nbsp;<tt><span class="nametype">/periodcentered</span></tt> 
&sect;&nbsp;<tt><span class="nametype">/section</span></tt> 
&copy;&nbsp;<tt><span class="nametype">/copyright</span></tt> 
&reg;&nbsp;<tt><span class="nametype">/registered</span></tt> 
&trade;&nbsp;<tt><span class="nametype">/trademark</span></tt> 
&spades;&nbsp;<tt><span class="nametype">/spade</span></tt> 
&hearts;&nbsp;<tt><span class="nametype">/heart</span></tt> 
&diams;&nbsp;<tt><span class="nametype">/diamond</span></tt> 
&clubs;&nbsp;<tt><span class="nametype">/club</span></tt> 
&rarr;&nbsp;<tt><span class="nametype">/arrowright</span></tt> 
&larr;&nbsp;<tt><span class="nametype">/arrowleft</span></tt> 
&uarr;&nbsp;<tt><span class="nametype">/arrowup</span></tt> 
&darr;&nbsp;<tt><span class="nametype">/arrowdown</span></tt> 
&harr;&nbsp;<tt><span class="nametype">/arrowboth</span></tt>
&rArr;&nbsp;<tt><span class="nametype">/arrowdblright</span></tt> 
&lArr;&nbsp;<tt><span class="nametype">/arrowdblleft</span></tt> 
&uArr;&nbsp;<tt><span class="nametype">/arrowdblup</span></tt> 
&dArr;&nbsp;<tt><span class="nametype">/arrowdbldown</span></tt> 
&hArr;&nbsp;<tt><span class="nametype">/arrowdblboth</span></tt></span></p></div>

<p id="compoundstring"><a href="#compoundstring">&loz;</a> Any string parameter may be replaced by an array (to make a &lsquo;compound string&rsquo;) of strings and glyphs, each glyph beginning with a forward slash (&ldquo;<tt>/</tt>&rdquo;). 
As an example, the second item of the default value of <tt><a href="#names">Names</a></tt> makes the silly but instructive &ldquo;G&uacute;&euml;st&nbsp;&Ocirc;&ntilde;&egrave;&rdquo;. 
Examples of glyphs include accented characters such as those in 
<tt><span class="array">[</span><span class="stringtype">(Ro)</span> <span class="nametype">/ecircumflex</span> <span class="stringtype">(da S)</span> <span class="nametype">/emacron</span> <span class="stringtype">(rikos)</span><span class="array">]</span></tt>; 
the likes of <tt><span class="nametype">/daggerdbl</span></tt>; 
as well as ligatures such as that in 
<tt><span class="array">[</span><span class="stringtype">(Quinta&nbsp;do&nbsp;Bom)</span> <span class="nametype">/fi</span> <span class="stringtype">(m)</span><span class="array">]</span></tt>.
Most of the characters one might need are in the <a href="#glyphs">box on the right</a>, or in 
<a href="diacritics_timesbold.html"><tt>/TimesNewRomanPS-BoldMT</tt>: accented characters and their PostScript glyphs</a>. 
Others are listed in appendix E.5 of the <a href="http://www.adobe.com/products/postscript/pdfs/PLRM.pdf">PostScript Language Reference Manual, third edition</a>; 
a still fuller list is at <a href="http://www.jdawiseman.com/papers/trivia/character-entities.html">www.jdawiseman.com/&#8203;papers/&#8203;trivia/&#8203;character-entities.html</a>. 
(But most fonts do not contain all the glyphs listed, so check the output carefully.) 
Any string parameter may be replaced with an array of any of: strings; glyphs; other like arrays; and indeed pieces of PostScript code such as &ldquo;<tt><span class="array">{</span>-0.06&nbsp;Kern<span class="array">}</span></tt>&rdquo;.</p>

<div id="compoundingerror">
<div style="float: left;  clear: left;"><table class="TableParameterSpecification" style="width: 315px;">
<tr><td style="text-align: center;"><div style="position: absolute;  width: 315px;  text-align: center; color: #999999;">Wrong</div><img width="315" height="71" src="circlearrays_wrong.png" alt="Non-compounded string"></td></tr>
<tr><td style="text-align: center;"><div style="position: absolute;  width: 315px;  text-align: center; color: #999999;">Correct</div><img width="315" height="82" src="circlearrays_correct.png" alt="Non-compounded string"></td></tr>
</table></div>
<p style="margin-bottom: 1px;"><a href="#compoundingerror">&loz;</a> Of course, compound strings must be actually compounded. 
In the code below and the pictures on the left the wrong element of <tt>Circlearrays</tt> has four pieces (<span class="quotationbox">1970</span>, <span class="quotationbox">C</span>, <span class="quotationbox">&aacute;</span>, and <span class="quotationbox">lem</span>); whereas the correct element has two pieces (<span class="quotationbox">1970</span> and <span class="quotationbox">C&aacute;lem</span>), the second of which is a compound string. 
This type of error has been seen more than once!</p>
<div style="text-align: center;  margin-top: 1px;  margin-left: auto;  margin-right: auto;"><pre style="text-align: left;"><span class="nametype">/Circlearrays</span> <span class="array">[</span>  <span class="comment">% First item erroneous</span>
	<span class="array">[</span>  <span class="stringtype">(1970)</span>  <span class="preEmphasis"> </span><span class="stringtype">(C)</span> <span class="nametype">/aacute</span> <span class="stringtype">(lem)</span><span class="preEmphasis">  </span> <span class="array">]</span>  <span class="comment">% Wrong: missing [ ]</span>
	<span class="array">[</span>  <span class="stringtype">(1970)</span>  <span class="array preEmphasis">[</span><span class="stringtype">(C)</span> <span class="nametype">/aacute</span> <span class="stringtype">(lem)</span><span class="array preEmphasis">]</span>  <span class="array">]</span>  <span class="comment">% Correct</span>
<span class="array">]</span> <span class="operator">def</span>  <span class="comment">% /Circlearrays</span></pre></div>
</div>

<div style="clear: both;  float: right;"><img width="407" height="409" align="right" src="title_above_below_over_fill_circlearray.png" alt="Titles, Abovetitles, Belowtitles, Overtitles, Circlearrays"></div>
<h3 id="abovetitles_overtitles"><a href="#abovetitles_overtitles">&bull;</a>&nbsp;Abovetitles and Overtitles</h3>
<p>As well as <tt><a href="#belowtitles">Belowtitles</a></tt>, there are similar arrays <tt>Abovetitles</tt> and <tt>Overtitles</tt>. 
The diagram on the right shows the usage of these arrays. 
It is best if items of <tt><a href="#titles">Titles</a></tt> are short, ideally &le;&nbsp;4 characters, so that they can be shown very large. 
Separately, observe that the <tt><a href="#titles">Titles</a></tt> and <tt>Overtitles</tt> have been &lsquo;filled&rsquo; with text: see <tt><a href="#filltexts">FillTexts</a></tt> below.</p>

<p>This profusion of places to put information should be used sparsely, and consistently. 
For example, in a vertical, the <tt><a href="#titles">Titles</a></tt> might contain two-digit years and the <tt>Overtitles</tt> a concise version of the name of the shipper or quinta or winery or ch&acirc;teau or distillery. 
Most <tt>Abovetitles</tt> would be blank, only a few specifying a non-standard bottle size (&ldquo;Double Magnum&rdquo;). 
Most <tt><a href="#belowtitles">Belowtitles</a></tt> would be blank, only a few specifying the likes of &ldquo;Cask Sample&rdquo;.</p>

<div class="TextAside AsideDifferent" style="clear: both;  float: right;  width: 40%;" id="units"><h3 style="text-align: center;  padding: 0;  margin: 1px 0 0 0;"><a href="#units">&bull;</a> Units</h3>
<p>In PostScript sizes, distances, lengths, widths (and, approximately, font sizes) are denominated in points, where 
72&nbsp;pt&nbsp;= 1&Prime;&nbsp;= 1&nbsp;inch&nbsp;= 25.4&nbsp;mm, and hence 
1&nbsp;pt&nbsp;= <span class="num">1</span>&frasl;<span class="den">72</span>&Prime;&nbsp;= 0.0138<span class="recurring">8</span>&Prime;&nbsp;= <span class="num">127</span>&frasl;<span class="den">360</span>&nbsp;mm&nbsp;= 0.3527<span class="recurring">7</span>&nbsp;mm, 
and 1&nbsp;mm&nbsp;= <span class="num">360</span>&frasl;<span class="den">127</span>&nbsp;pt&nbsp;&asymp; 2.83&nbsp;pt. 
Even <span title="Used only in the parameter &lsquo;CrossHatchingCellArea&rsquo;.">areas</span> are in square points, there being 72&times;72=5,184 to the inch&sup2;, and just over <span title="1mm&sup2; = (360&divide;127)&sup2; pt&sup2; &asymp; 8.035pt&sup2;">8</span> to the mm&sup2;.</p>
<p>If using lots of measurements in millimetres, near the start of the file insert the line 
&ldquo;<tt><span class="nametype">/mm</span>&nbsp;<span class="array">{</span>360&nbsp;<span class="operator">mul</span> 127&nbsp;<span class="operator">div</span><span class="array">}</span>&nbsp;<span class="operator">def</span></tt>&rdquo;, 
which automatically converts the likes of &ldquo;<tt>6&nbsp;mm</tt>&rdquo; (with a space) into Adobe points. 
Or &ldquo;<tt><span class="nametype">/inch</span>&nbsp;<span class="array">{</span>72&nbsp;<span class="operator">mul</span><span class="array">}</span>&nbsp;<span class="operator">def</span></tt>&rdquo; if preferring inches.</p>
<p style="margin-bottom: 1px;  padding-bottom: 0;">Angles are always in degrees&nbsp;= &deg; and never in radians, so a quarter turn is <tt>90</tt>&deg;. 
PostScript&rsquo;s arithmetic is only <a href="http://en.wikipedia.org/wiki/Single-precision_floating-point_format">single precision</a>, 
so angles should not have magnitude larger than a few thousand degrees. 
I.e., prefer <tt>40</tt>&deg; to <tt>4000</tt>&deg;.</p></div>

<h2 id="other_parameters"><a href="#other_parameters">&bull;</a>&nbsp;Other parameters</h2>

<h3 id="fonts"><a href="#fonts">&bull;</a>&nbsp;Fonts</h3>
<p>&loz; The fonts in which the various text pieces are rendered are contained in the parameters <tt>NamesFont</tt>, <tt>CircletextFont</tt>, <tt>TitlesFont</tt>, <tt>AbovetitlesFont</tt>, <tt>BelowtitlesFont</tt>, <tt>OvertitlesFont</tt>, <tt>FillTextFont</tt>, <tt>SubtitlesFont</tt> (on non-glasses sheets), <tt>HeaderFont</tt>, <tt>FooterFont</tt>, and even the rarely-used <tt>BackgroundTextsFont</tt>.</p>
<p>But PostScript uses font names that are not always obvious. 
Help is at hand: distilling <a href="http://www.jdawiseman.com/papers/placemat/fonts_illustrated.ps">fonts_illustrated.ps</a> produces a PDF with a list of the available fonts, their PostScript names, and formatted example text. 
If distilling on a different machine or with a different program, a different set of fonts might be available: re-test by re-distilling <a href="http://www.jdawiseman.com/papers/placemat/fonts_illustrated.ps">fonts_illustrated.ps</a>.</p>
<p>The program was designed for left-to-right script, and the alphabets successfully used have been Roman (mostly), Greek (occasionally), and Cyrillic (rarely). 
Users with knowledge of PostScript who are able to assist with testing in other scripts&mdash;including right-to-left&mdash;are invited to contact the <a href="../../author.html">the author</a>, 
perhaps after reading <a href="http://groups.google.com/group/comp.lang.postscript/browse_thread/thread/92da11d4dacbb047/">this request for assistance rendering &ldquo;&#27849;&#21313;&#27573;&rdquo;</a>.</p>

<h3 id="papertype_orientation"><a href="#papertype_orientation">&bull;</a>&nbsp;PaperType and Orientation</h3>
<p style="margin-bottom: 1px;">&loz; The page size is controlled by the parameter <tt>PaperType</tt>:</p>
<div><pre style="margin-top: 1px;  margin-bottom: 1px;"><span class="nametype">/PaperType</span> <span class="nametype">/A4</span> <span class="operator">def</span>  <span class="comment">% /A4 /A3 /USL /USLegal /USL2 [SmallerPts LargerPts]</span></pre></div>
<table class="arrays" style="float: right;  font-size: small;  margin-left: 4px;  text-align: center;">
<col class="first-col" style="border-right-width: 2px;">
<tr class="first-row"><th>Name</th><th>Millimetres</th><th>Inches</th><th>Adobe&nbsp;Points</th></tr>
<tr><th><tt><span class="nametype">/A4</span></tt></th><td class="AsideDifferent">210&nbsp;&times;&nbsp;297</td><td>&asymp;&nbsp;<span title="1050&divide;127">8.27</span>&nbsp;&times;&nbsp;<span title="1485&divide;127">11.69</span></td><td>&asymp;&nbsp;<span title="75600&divide;127">595.3</span>&nbsp;&times;&nbsp;<span title="106920&divide;127">841.9</span></td></tr>
<tr><th><tt><span class="nametype">/A3</span></tt></th><td class="AsideDifferent">297&nbsp;&times;&nbsp;420</td><td>&asymp;&nbsp;<span title="1485&divide;127">11.69</span>&nbsp;&times;&nbsp;<span title="2100&divide;127">16.54</span></td><td>&asymp;&nbsp;<span title="106920&divide;127">841.9</span>&nbsp;&times;&nbsp;<span title="151200&divide;127">1190.6</span></td></tr>
<tr><th><tt><span class="nametype">/USL</span></tt></th><td>215.9&nbsp;&times;&nbsp;279.4</td><td class="AsideDifferent">8&frac12;&nbsp;&times;&nbsp;11</td><td>612&nbsp;&times;&nbsp;792</td></tr>
<tr><th><tt><span class="nametype">/USLegal</span></tt></th><td>215.9&nbsp;&times;&nbsp;355.6</td><td class="AsideDifferent">8&frac12;&nbsp;&times;&nbsp;14</td><td>612&nbsp;&times;&nbsp;1008</td></tr>
<tr><th><tt><span class="nametype">/USL2</span></tt></th><td>279.4&nbsp;&times;&nbsp;431.8</td><td class="AsideDifferent">11&nbsp;&times;&nbsp;17</td><td>792&nbsp;&times;&nbsp;1224</td></tr>
</table>
<p style="margin-top: 1px;">The parameter <tt>PaperType</tt> can be one of the values in the table on the right, or a custom page size expressed in points (see <a href="#units">box above right</a>) as an array of length two: <tt><span class="array">[</span><i>d</i><small><sub>1</sub></small>&nbsp;<i>d</i><small><sub>2</sub></small><span class="array">]</span></tt> with 0&nbsp;&lt;&nbsp;<i>d</i><small><sub>1</sub></small>&nbsp;&le;&nbsp;<i>d</i><small><sub>2</sub></small>. 
For convenience of copy-pasting, some of the allowed values appear in the comment at the end of the line&mdash;after the &ldquo;<tt><span class="comment">%</span></tt>&rdquo;. 
Also allowed are sizes from <tt><span class="nametype">/A10</span></tt> (don&rsquo;t ask why but do shrink the <a href="#margins">margins</a>) to <tt><span class="nametype">/A0</span></tt>, and from <tt><span class="nametype">/B10</span></tt> to <tt><span class="nametype">/B0</span></tt>. 
For help on page sizes, and how many glasses can fit on which, see the separate manual page <a href="page_size_advice.html">Glasses placemat: choosing a paper size</a>.</p>

<p>The parameter <tt>Orientation</tt> can take the values <tt><span class="nametype">/Portrait</span></tt> or <tt><span class="nametype">/Landscape</span></tt>. 
Its complicated default chooses the former if the <tt>PaperType</tt> is either <tt><span class="nametype">/A4</span></tt> or <tt><span class="nametype">/USL</span></tt>, otherwise the latter.</p>

<p id="margins"><a href="#margins">&loz;</a> Around the edge of the page is an invisible margin, the circles lying inside the area at least the margin away from the edge of the page. 
Usually, the margin equals the parameters <tt>MarginL</tt> (left), <tt>MarginR</tt> (right), <tt>MarginT</tt> (top), and <tt>MarginB</tt> (bottom), 
each defaulting to <tt>24</tt>&nbsp;points&nbsp;= &#8531;&Prime;&nbsp;&asymp; 8.5&nbsp;mm 
(or, top|bottom, if there are headers|footers, <tt>30</tt>&nbsp;points&nbsp;= <span class="num">5</span>&frasl;<span class="den">12</span>&Prime;&nbsp;&asymp; 10.6&nbsp;mm). 
Outside this there can be an extra margin, on the glasses pages <tt>OuterGlassesMarginL</tt>, <tt>&hellip;R</tt>, <tt>&hellip;B</tt>, and <tt>&hellip;T</tt>. 
This adds to the ordinary margin, except that, if <tt>OuterGlassesCropMarks</tt>, then on any corner in which both the <tt>OuterGlassesMargin&hellip;</tt>s are positive, crop marks are painted. 
This can be useful for large numbers of glasses on cropped <tt><span class="nametype">/A2</span></tt>.</p>

<h3 id="PDF_params"><a href="#PDF_params">&bull;</a>&nbsp;The PDF&rsquo;s title</h3>
<p>PDFs are sometimes viewed within a browser. 
Each tab has a name, and the tab name is in <tt>PDF_title</tt>. 
It can be a mite more elegant to set this to something specific and concise.</p>

<h2 id="other_parameters_decoration"><a href="#other_parameters_decoration">&bull;</a>&nbsp;Decorating the Titles</h2>

<h3 id="colourscheme"><a href="#colourscheme">&bull;</a>&nbsp;Colour Schemes</h3>
<p>Items of <tt>Titles</tt>, <tt>Abovetitles</tt>, <tt>Belowtitles</tt>, and <tt>Overtitles</tt> can be black or two-tone grey. 
These colour schemes are controlled by the parameters <tt>ColourSchemeTitles</tt>, <tt>ColourSchemeAbovetitles</tt>, <tt>ColourSchemeBelowtitles</tt>, and <tt>ColourSchemeOvertitles</tt>, each of which can be set to (code evaluating to) <tt><span class="nametype">/Black</span></tt> or <tt><span class="nametype">/MidGrey</span></tt>. 
There is also the analogous parameter <tt>ColourSchemePlaceNames</tt>, used to control the colour of <a href="#placenames">Place Names</a>. 
By default all are <tt><span class="nametype">/Black</span></tt>.</p>

<div style="clear: both;  float: right;"><img width="364" height="200" align="right" src="CrossHatching.png" alt="Example of CrossHatchingTitles and CrossHatchingOvertitles"></div>
<h3 id="crosshatching"><a href="#crosshatching">&bull;</a>&nbsp;CrossHatching</h3>
<p>&loz; The example on the right is filled with a check pattern. 
This check is activated by the boolean <tt>CrossHatchingTitles</tt>. 
The polar gridlines originate from a point with <i>x</i> coordinate 
<tt>CrossHatchingCentreX</tt>, which can take values of <tt><span class="nametype">/Name</span></tt>, <tt><span class="nametype">/Left</span></tt>, <tt><span class="nametype">/Center</span></tt>, <tt><span class="nametype">/Right</span></tt>, or a number being points from the left edge of the page.
Or <tt>CrossHatchingCentreX</tt> can be <tt><span class="nametype">/CenterSheetsSamePageOrdering</span></tt>: if each person&rsquo;s glasses sheets for this session are in a single row, all the circles and lines originate from the common <i>x</i>-centre. 
The <i>y</i> coordinate <tt>CrossHatchingCentreY</tt> has possible values <tt><span class="nametype">/Name</span></tt>, <tt><span class="nametype">/Bottom</span></tt>, <tt><span class="nametype">/Middle</span></tt>, <tt><span class="nametype">/Top</span></tt>, or points from the bottom of the page. 
Lines are formatted and <tt><span class="operator">stroke</span></tt>d by the code in <tt>CrossHatchingTitlesStrokeCode</tt> 
(the code must include the <tt><span class="operator">stroke</span></tt>, this requirement permitting the likes of
&ldquo;<tt><span class="operator">gsave</span></tt> &hellip; <tt><span class="operator">stroke</span> <span class="operator">grestore</span></tt> &hellip; <tt><span class="operator">stroke</span></tt>&rdquo;).
The number of straight lines is <tt>CrossHatchingNumRadialLines</tt>, defaulting to 180 so 2&deg; apart. 
The radii are chosen such that each cell has area <tt>CrossHatchingCellArea</tt>, defaulting to &asymp;<tt title="On A4 with the CrossHatching centre in a corner, or on A3 with it in the centre of a long edge, near the centre of the circle furthest from that centre the near-rectangles are in golden ratio.">491.45</tt>&nbsp;pt&sup2; &asymp; (7.82mm)&sup2;.</p>

<p>There are analogous booleans <tt>CrossHatchingAbovetitles</tt>, <tt>CrossHatchingBelowtitles</tt>, <tt>CrossHatchingOvertitles</tt>, and <tt>CrossHatchingPlaceNames</tt>; 
and <tt>stroke</tt>ing code <tt>CrossHatchingAbovetitlesStrokeCode</tt>, <tt>CrossHatchingBelowtitlesStrokeCode</tt>, and <tt>CrossHatchingOvertitlesStrokeCode</tt> (<tt>CrossHatchingPlaceNames</tt> uses the sub-parameters of <tt>CrossHatchingTitles</tt>).</p>
<p><tt>CrossHatchingInside</tt> (with <tt>CrossHatchingInsideStrokeCode</tt>) controls whether (and how) the cross hatching is in the background of the inside of the circle, behind the various titles. 
<tt><small>DecanterLabelsShowCrossHatchingInside</small></tt> controls whether this is shown on decanter labels. 
Similarly, the boolean <tt>CrossHatchingOutside</tt> (with <tt>CrossHatchingOutsideStrokeCode</tt> and <tt>CrossHatchingOutsideToPaperEdge</tt>) controls whether and how it appears outside and so between the circles.</p>

<p id="CirclearraysFillBehind"><a href="#CirclearraysFillBehind">&loz;</a>&nbsp;Sometimes used with <tt>CrossHatchingInside</tt> and <tt>CrossHatchingOutside</tt> is <tt>CirclearraysFillBehind</tt>, which fills behind the annulus containing the <tt>Circlearrays</tt> by executing <tt>CirclearraysFillBehindCode</tt>.</p>

<div style="clear: both;  float: right;"><img width="393" height="384" align="left" src="outlinetitles.png" alt="Example of outlined titles"></div>
<h3 id="stars_flowers"><a href="#stars_flowers">&bull;</a>&nbsp;Stars and flowers and hearts</h3>
<p>&loz; In the very cluttered diagram on the left, showing <a href="../port_and_wine/quevedo_2008.html">QvA08</a>, the <tt>Titles</tt> and <tt>Belowtitles</tt> contain small random stars and flowers. 
This feature is activated by setting to <tt><span class="operator">true</span></tt> the boolean parameter <tt>ShapesInTitles</tt>, which has obvious variations <tt>ShapesInAbovetitles</tt>, <tt>ShapesInBelowtitles</tt>, <tt>ShapesInOvertitles</tt>, and <tt>ShapesInPlaceNames</tt>. 
The array <tt>ShapesToUse</tt>, defaulting to <tt><span class="array">[</span><span class="nametype">/Flower</span> <span class="nametype">/Star</span> <span class="nametype">/Heart</span><span class="array">]</span></tt>, controls which shapes are used.</p>
<p>The shape is <tt><span class="operator">fill</span></tt>ed with the code <tt>ShapesTitlesFill</tt> (or <tt>ShapesAbovetitlesFill</tt>,  +<tt>ShapesBelowtitlesFill</tt>, <tt>ShapesOvertitlesFill</tt>), 
which, if the shapes are <tt><span class="operator">fill</span></tt>ed, should end with a <tt><span class="operator">fill</span></tt>. 
The shape is then <tt><span class="operator">stroke</span></tt>d with <tt>ShapesTitlesStroke</tt> (or <tt>ShapesAbovetitlesStroke</tt>, <tt>ShapesBelowtitlesStroke</tt>, <tt>ShapesOvertitlesStroke</tt>) which should end with a <tt><span class="operator">stroke</span></tt>.</p>
<p>For the stars, the numbers of points and the step between points are chosen randomly from within <tt>ShapesStarsPointsAndStepsArray</tt>, 
the default <tt><span class="array">[</span><span class="array">[</span>5 2<span class="array">]</span> <span class="array">[</span>6 2<span class="array">]</span> <span class="array">[</span>7 2<span class="array">]</span> <span class="array">[</span>7 3<span class="array">]</span> <span class="array">[</span>8 3<span class="array">]</span><span class="array">]</span></tt> being 
<img width="14" height="13" src="starsclippedtopath_5_2.gif" alt="small 5/2 star"> 
<img width="15" height="14" src="starsclippedtopath_6_2.gif" alt="small 6/2 star"> 
<img width="16" height="14" src="starsclippedtopath_7_2.gif" alt="small 7/2 star"> 
<img width="14" height="14" src="starsclippedtopath_7_3.gif" alt="small 7/3 star"> 
<img width="14" height="14" src="starsclippedtopath_8_3.gif" alt="small 8/3 star">. 
A possible alternative value for <tt>ShapesStarsPointsAndStepsArray</tt> is <tt><span class="array">[</span><span class="array">[</span>3 1.318<span class="array">]</span> <span class="array">[</span>4 1.792<span class="array">]</span> <span class="array">[</span>5 2.278<span class="array">]</span> <span class="array">[</span>6 2.77<span class="array">]</span><span class="array">]</span></tt>, being pointier and less polygonal: 
<img width="13" height="12" src="starsclippedtopath_3_1318.gif" alt="small sharp 3-pointed star"> 
<img width="12" height="12" src="starsclippedtopath_4_1792.gif" alt="small sharp 4-pointed star"> 
<img width="14" height="14" src="starsclippedtopath_5_2278.gif" alt="small sharp 5-pointed star"> 
<img width="15" height="13" src="starsclippedtopath_6_2770.gif" alt="small sharp 6-pointed star">. 
(Mathematicians might be interested in an <a href="http://www.jdawiseman.com/papers/easymath/open_questions.html#stars">open question about such stars</a>.) 
For the flowers the number of petals is chosen randomly from <tt>ShapesFlowersNumPetalsMin</tt> to <tt>ShapesFlowersNumPetalsMax</tt>, 
and, as a proportion of 360&deg; divided by the number of petals, the angular width of each is chosen randomly from the range 
<tt>ShapesFlowersAngularWidthMin</tt> to <tt>ShapesFlowersAngularWidthMax</tt>.</p>
<p>The radius of each shapes&rsquo;s enclosing circle is random in the range <tt>ShapesEnclosingCircleRadiusMin</tt> to <tt>ShapesEnclosingCircleRadiusMax</tt>. 
An approximation to the typical separation between the shapes is <tt>ShapesAverageSeparation</tt>; 
a parameter controlling how far stars are moved from a regular grid is <tt>ShapesAverageMaxTweakPlusMinus</tt>. 
The pattern generates some shapes that are not shown, that are <tt><span class="operator">clip</span></tt>ped away. 
If <tt>ShapesPrintQuickerDistillSlower</tt> is <tt><span class="operator">true</span></tt> these are removed&mdash;which can reduce file size at the price of slowing distillation.</p>

<p>Sometimes, albeit rarely, this <tt><span class="operator">clip</span></tt>ping is not wanted. For instance, if the stars are filled white with no border, the <tt><span class="operator">clip</span></tt>ping achieves no good. 
Not only no good, but there can be a tiny bleed between the underlying letter&rsquo;s fill and the clipped shape, such that a very thin black border remains. 
For non-background-filled shapes, it can be not done just for visual effect. 
Whatever the reason, controlled with the Boolean parameters <tt>ShapesTitlesClip</tt>, <tt>ShapesAbovetitlesClip</tt>, <tt>ShapesBelowtitlesClip</tt>, <tt>ShapesOvertitlesClip</tt>, <tt>ShapesPlaceNamesClip</tt>, for which <tt><span class="operator">true</span></tt> means do <tt><span class="operator">clip</span></tt>.</p>

<h3 id="Spirals"><a href="#Spirals">&bull;</a>&nbsp;Spirals</h3>
<p>Spirals can be shown inside the glass circles (<a href="placemats_list.html#a20190213">e.g.</a>). 
This is activated with <tt><span class="nametype">/Spirals</span> <span class="operator">true</span> <span class="operator">def</span></tt>. 
Each spiral set has a number of arms equalling <tt>SpiralNumArms</tt>, and the &lsquo;distance&rsquo; between them (in the sense of towards the spiral centre, rather than perpendicular) is <tt>SpiralRadiusBetweenArms</tt>; and the spiral set can be turned with <tt>SpiralAngleOffset</tt>. 
The centre of the spirals can be at the centre of the circle, or some distance and angle away from it: <tt>SpiralCentreFromCentreProportionRadiiInside</tt> (expressed as a proportion of the inner radius) and <tt>SpiralCentreFromCentreAngle</tt> (in which <tt>0</tt>&deg; is vertical). 
There are also the self-explanatory <tt>SpiralClockwise</tt> and <tt>SpiralStrokeCode</tt>. 
(Geeks: <a href="https://groups.google.com/forum/#!topic/comp.lang.postscript/3RIq0Jnwrbo">how these Archimedean spirals are closely approximated by B&eacute;zier cubics</a>.)</p>

<h3 id="outlinetitles"><a href="#outlinetitles">&bull;</a>&nbsp;OutlineTitles</h3>
<p>&loz; The <tt>Titles</tt> can be outlined by setting <tt><span class="nametype">/OutlineTitles</span>&nbsp;<span class="operator">true</span>&nbsp;<span class="operator">def</span></tt>,
as in the (still very cluttered) <a href="#stars_flowers">example with flowers and stars</a>. 
The innermost white and black outlines have width <tt>OutlineTitlesInnerWidthWhite</tt> and <tt>OutlineTitlesInnerWidthBlack</tt>,
and these widths grow in successive outlines by factors of 
<tt>OutlineTitlesMultiplierWhite</tt> (defaulting to &frac12;(1+&radic;5)&nbsp;= the golden ratio&nbsp;&asymp; 1.618) and <tt>OutlineTitlesMultiplierBlack</tt> (defaulting to unity). 
The number of black ripples is capped at <tt>OutlineTitlesMaxNum</tt>.</p>
<p>If <tt>OutlineTitlesAlsoAbovetitles</tt> is true then <tt>Abovetitles</tt> are also outlined; 
if false then <tt>Abovetitles</tt> sit plainly atop the lines 
(and likewise <tt>OutlineTitlesAlsoBelowtitles</tt> and <tt>OutlineTitlesAlsoOvertitles</tt>). 
Generally it helps if the decanter labels fit onto a rectangular business card, so the default value of <tt>DecanterLabelsShowOutlineTitles</tt> does not show the outlines on the decanter labels. 
<tt>OutlineTitles</tt> does not impose as high a burden on a printer as does <tt>FillTexts</tt>,
but can still be difficult for some. Again, test your printer.</p>

<div style="clear: both;  float: right;"><img width="396" height="404" align="right" src="inlinetitles.png" alt="Example of inlined titles"></div>
<h3 id="inlinetitles"><a href="#inlinetitles">&bull;</a>&nbsp;InlineTitles</h3>
<p>&loz; A more architectural form of decoration is activated by the booleans <tt>InlineTitles</tt>, <tt>InlineAbovetitles</tt>, <tt>InlineBelowtitles</tt>, <tt>InlineOvertitles</tt> and <tt>InlinePlaceNames</tt>. 
These are in some sense a reversal of <tt>OutlineTitles</tt>&mdash;the lines being on the inside. 
In the <tt>Titles</tt> the lines have widths of <tt>InlineTitlesBlackWidth</tt> and <tt>InlineTitlesWhiteWidth</tt>; with obvious variations 
<tt>InlineAbovetitlesBlackWidth</tt>, <tt>InlineTitlesBlackWidth</tt>, <tt>InlineAbovetitlesWhiteWidth</tt>, <tt>InlineBelowtitlesBlackWidth</tt>, <tt>InlineBelowtitlesWhiteWidth</tt>, <tt>InlineOvertitlesBlackWidth</tt> and <tt>InlineOvertitlesWhiteWidth</tt>. 
All default to 1. 
If the colour scheme is <tt><span class="nametype">/MidGrey</span></tt> then &ldquo;black&rdquo; means the darker of the two shades, and &ldquo;white&rdquo; the lighter.</p>
<p>The code can make an estimate of how many contours are needed, and does so if <tt>InlineTitlesAttemptMinimiseNumContours</tt> 
(or <tt>InlineAboveBelowOverAttemptMinimiseNumContours</tt> or <tt>InlinePlaceNamesAttemptMinimiseNumContours</tt>) is <tt><span class="operator">true</span></tt> 
(<a href="http://www.theportforum.com/viewtopic.php?t=175&amp;start=913">discussion</a>). 
This estimate is then capped at <tt>InlineTitlesMaxNumberContours</tt> or <tt>InlineAbovetitlesMaxNumberContours</tt> or <tt>InlineBelowtitlesMaxNumberContours</tt> or <tt>InlineOvertitlesMaxNumberContours</tt>. 
(<tt>InlinePlaceNames</tt> uses the sub-parameters of <tt>InlineTitles</tt>.) 
If the code&rsquo;s estimate is too low, as might happen if the lines are very thin, then the booleans should be <tt><span class="operator">false</span></tt> and the upper bounds set carefully. 
The attempted estimate is computed using a horrible algorithm, &lsquo;discussed&rsquo; at <a href="https://groups.google.com/forum/#!topic/comp.lang.postscript/86b7Sg8v7B0">comp.lang.postscript</a>.
By default the upper bounds are <tt>1</tt>, which is elegantly sparse.</p>
<p>If <tt>InlinePrefillWhite</tt>, all of the <tt>Titles</tt>/<tt>Abovetitles</tt>/<tt>Belowtitles</tt>/<tt>Overtitles</tt> are filled white before painting the &lsquo;Inlines&rsquo;, so are opaque. 
This is good if there is <tt><a href="#crosshatching">CrossHatchingInside</a></tt>, but bad with <tt><a href="#BackgroundTextsGlasses">BackgroundTextsGlasses</a></tt>.</p>

<h3 id="rotation"><a href="#rotation">&bull;</a>&nbsp;Rotation</h3>
<p>The example on the right is also at a jaunty angle (well, an angle that <a href="../../author.html">the author</a> imagines might be jaunty). 
This is controlled by <tt>RotationTitlesAboveBelowOverCirclearray</tt>, which rotates the whole glass circle by that number of &deg;, and is here set to 15.</p>

<div style="clear: both;  float: right;"><img width="403" height="403" align="right" src="filltexts.png" alt="Example of titles filled with text"></div>
<h3 id="filltexts"><a href="#filltexts">&bull;</a>&nbsp;FillTexts</h3>
<p>&loz; The booleans <tt>FillTitles</tt>, <tt>FillAbovetitles</tt>, <tt>FillBelowtitles</tt>, <tt>FillOvertitles</tt>, and <tt>FillPlaceNames</tt> control whether their respective elements are filled with multiple copies of some text, outlined. 
The filling texts are in the array <tt>FillTexts</tt>, which is of the same length as <tt>Titles</tt>, and each is outlined <tt>FillTextNumOutlines</tt> times. 
Depending on the values of <tt><a href="#colourscheme">ColourSchemeTitles</a></tt> etc, the colours are either black and white, or 40% grey and white. 
Each rendering of an item of <tt>FillTexts</tt> is suffixed with <tt>FillTextNumSpaces</tt> spaces.</p>
<p>The additional parameter <tt>FillTextAngle</tt> may be <tt><span class="operator">def</span></tt>fed to a number 
(30 being a good choice), this being the &deg;&nbsp;from horizontal at which the <tt>FillTexts</tt> 
are shown. Alternatively, <tt>FillTextAngle</tt> may be one of 
<tt><span class="nametype">/LowerLeft</span></tt>, <tt><span class="nametype">/LowerCenter</span></tt>, <tt><span class="nametype">/LowerRight</span></tt>, 
<tt><span class="nametype">/MiddleLeft</span></tt>, <tt><span class="nametype">/MiddleCenter</span></tt>, <tt><span class="nametype">/MiddleRight</span></tt>, 
<tt><span class="nametype">/UpperLeft</span></tt>, <tt><span class="nametype">/UpperCenter</span></tt> or <tt><span class="nametype">/UpperRight</span></tt> 
such that the text will be 90&deg; to a line drawn from the centre of 
the circle to that corner or edge or centre of the page. 
Or <tt>FillTextAngle</tt> may be <tt><span class="nametype">/Name</span></tt>, making the angle perpendicular to a line drawn to the positioning of the <tt>Names</tt>.</p>

<p id="filltexts-font"><a href="#filltexts-font">&loz;</a> The <tt>FillTexts</tt> are set in the font <tt>FillTextFont</tt>, at a size of at least <tt>FillTextMinFontSizeAbsolute</tt>, and of a size 
of at least <tt><small>FillTextMinFontSizeProportionLargestTitleAboveBelowOver</small></tt> &times; the largest their font sizes.</p>

<p>In the example on the right the relevant item 
of <tt>Titles</tt> is <tt><span class="stringtype">(S)</span></tt>;
of <tt>Overtitles</tt> is <tt><span class="stringtype">(Sandeman)</span></tt>;
of <tt>Circlearrays</tt> is <tt><span class="array">[</span><span class="stringtype">(Sandeman)</span>&nbsp;<span class="stringtype">(1985)</span><span class="array">]</span></tt>; 
of <tt>FillTexts</tt> is <tt><span class="stringtype">(1985)</span></tt>, 
with <tt>FillTextNumSpaces</tt> being 2 and
<tt>FillTextAngle</tt> being 30, 
and all the typefaces being <tt><span class="nametype">/HelveticaNeue-CondensedBold</span></tt>.
The default value of <tt>FillTextAngle</tt> is complicated, but natural. 
If <tt><a href="#glassesonsheets_glassesontastingnotepages">GlassesOnSheets</a></tt> specifes a two-page layout, 
then to <tt><span class="nametype">/LowerRight</span></tt> on the first sheet, and <tt><span class="nametype">/LowerLeft</span></tt> on the second. 
If not a two-page layout, then if <tt>NamesAtTop</tt> is true to <tt><span class="nametype">/LowerCenter</span></tt>, otherwise to <tt><span class="nametype">/Name</span></tt>.</p>

<p id="filltexts-placenames"><a href="#filltexts-placenames">&loz;</a> The formatting of the <tt><a href="#placenames">PlaceNames</a></tt>&hellip; generally matches that of the <tt>Titles</tt>, 
except that the filling text is <tt>FillTextPlaceNames</tt>, and the angle is <tt>FillTextAnglePlaceNames</tt>.</p>

<p id="filltexts-quicker-slower"><a href="#filltexts-quicker-slower">&loz;</a> Use of <tt>FillTexts</tt> makes distillation slow, and produces files that can be too complicated for some printers. 
The balance between these two can be influenced by the boolean <tt>FillTextPrintQuickerDistillSlower</tt>. 
For example, in a draft placemat with <tt>FillTitles</tt> and <tt><a href="#placenames">PlaceNames</a></tt>, 
changing <tt>FillTextPrintQuickerDistillSlower</tt> from <tt><span class="operator">false</span></tt> to <tt><span class="operator">true</span></tt> decreased the file size from 1013k to 871k, but increased the distill time from 64 seconds to 40 minutes. 
If distilling the PostScript via the web the latter would definitely have timed out the browser. 
And it might be that, on some printers, the print-slowly option (<tt><span class="operator">false</span></tt>) won&rsquo;t print at all, whereas the print-quickly option (<tt><span class="operator">true</span></tt>) will. 
But some printers can&rsquo;t cope with either: <a href="../../author.html">the author</a>&rsquo;s Canon Pixma MP240 fails to print the <tt>FillTexts</tt> at all, the interior of the <tt>Titles</tt> rendering as plain white. 
(Printing this <a href="filltexts_printing_test.pdf">FillText test page</a> to an MP240 results in output of which <a href="filltexts_printing_test.png">this scan</a> is an extract.) 
But the author&rsquo;s next printer, a <a href="http://www.samsung.com/uk/consumer/print-solutions/print-solutions/mono-printers/ML-2955DW/SEE/">Samsung ML-2955DW</a>, did print successfully, but with insufficient resolution for the small grey text to look entirely satisfactory. 
So test your printer; do not assume that anything will work first time; and do not assume that all larger more expensive printers cope better.</p>

<p id="filltexts-error"><a href="#filltexts-error">&loz;</a> It also appears that Adobe does not always distill or render perfectly these <tt>FillTexts</tt>.
This problem can be fixed by opening the PostScript file with Preview on the Mac OS X, 
and then printing from Preview or saving the PDF file Preview makes and subsequently printing from Acrobat
(<a href="http://groups.google.com/group/comp.lang.postscript/browse_frm/thread/d939df0dde60335c">technical demonstration of error</a>).</p>

<p>But there is also a problem with Preview on the Mac OS X, which crashes if the paths are too complicated. 
The relevant constraint is on the complexity of the path of the item of <tt>FillTexts</tt>, plus the complexity of the path of the text that is filled (the item of <tt>Titles</tt> or of <tt>Names</tt>, as appropriate). 
As <tt>Names</tt> are typically longer than <tt>Titles</tt>, the problem can typically be remedied by setting <tt>PlaceNames</tt> to <tt><span class="operator">false</span></tt>.</p>

<h2 id="page-level_settings"><a href="#page-level_settings">&bull;</a>&nbsp;Page-level settings</h2>

<p id="names-show"><a href="#names-show">&loz;</a> The <tt>Names</tt> of people can appear at the top or bottom of each glasses sheet, or both or neither. 
Presence or absence is determined by two arrays of booleans, <tt>NamesShowTop</tt> and <tt>NamesShowBottom</tt>, each of the same length as <tt><a href="#glassesonsheets_glassesontastingnotepages">GlassesOnSheets</a></tt>. 
The names are rendered in the font <tt>NamesFont</tt>, at a size equal to the size of the largest of the <tt>Circlearrays</tt>, subject to a minimum of <tt>NamesFontSizeMin</tt> and a maximum of <tt>NamesFontSizeMax</tt>.</p>

<p id="rotate180"><a href="#rotate180">&loz;</a> If <tt>Rotate180AlternateNames</tt> is <tt><span class="operator">true</span></tt> then, for every other person, the glass and tasting-note pages are rotated 180&deg;. 
At set-up time this slightly simplifies separation of pages by owner.</p>


<div class="BorderGraphic" style="float: right; margin: 2px;"><a href="placemats_list.html#a20191121"><img width="602" height="368" align="left" src="Droplets.png" alt="Rebello Valente tasting"></a></div>
<h3 id="Droplets"><a href="#Droplets">&bull;</a>&nbsp;Droplets</h3>
<p>Droplets flow around the page, attracted by positive charges, repelled by negative charges. 
Activate with <tt><span class="nametype">/Droplets</span> <span class="operator">true</span> <span class="operator">def</span></tt>.</p>
<p>The array <tt>DropletsCharges</tt> is of a length that is a multiple of four, as follows. 
<span class="quotationbox">0</span>&nbsp;An&nbsp;integer SheetNum for this charge, or <tt><span class="nametype">/All</span></tt> meaning all sheets. 
<span class="quotationbox">1</span>&nbsp;A&nbsp;location: this can be an integer, the centre of the <tt>WithinPage</tt> circle on that sheet; or a length array of length two, <tt><span class="array">[</span><i>x</i>&nbsp;<i>y</i><span class="array">]</span></tt> in which <tt><span class="array">[</span>0&nbsp;0<span class="array">]</span></tt> is bottom-left of the page. 
<span class="quotationbox">2</span>&nbsp;A&nbsp;numeric charge, droplets flowing away from &minus;ve charges and to +ve charges. 
<span class="quotationbox">3</span>&nbsp;A&nbsp;numeric spin; with +ve charge and +ve spin the droplets approach clockwise.</p>
<p>Starting locations of the drops have a distance apart of <tt>DropletsAverageSeparation</tt> adjusted by a random fraction of <tt>DropletsAverageMaxTweakPlusMinus</tt>, and path length is <tt>DropletsPathLength</tt>.</p> 
<p>There is a little humour in having a small proportion of the droplets going backwards; a small proportion will be noticed only slowly by the uninitiated, increasing the humour (there are three in the example image: seek!). 
That proportion is controlled by <tt>DropletsProportionBackwards</tt>, which obviously should be &ge;0 and &le;1. 
The default value is <tt>0.0204</tt>&nbsp;&asymp;&nbsp;1/49.</p>
<p>The gray and width of each path is controlled by 
<tt>DropletsOuterGrayEnd</tt>, <tt>DropletsOuterGrayStart</tt>, <tt>DropletsOuterWidthEnd</tt>, <tt>DropletsOuterWidthStart</tt>, <tt>DropletsInnerGrayEnd</tt>, <tt>DropletsInnerGrayStart</tt>, <tt>DropletsInnerWidthEnd</tt>, and <tt>DropletsInnerWidthStart</tt>. 
(But if <tt>DropletsOuterGrayEnd</tt> &ne; <tt>DropletsOuterGrayStart</tt>, or likewise <tt>&hellip;Inner&hellip;</tt>, the PDF can be multiple megabytes larger.) 
There are also parameters <tt>PrePourShowDroplets</tt>, <tt>NeckTagsShowDroplets</tt>, and <tt>StickyLabelsShowDroplets</tt>. 
(Original <a href="http://www.theportforum.com/viewtopic.php?t=175&amp;start=1136">discussion</a> of this feature.)</p>

<div class="BorderGraphic" style="float: left; margin: 2px; clear: left;"><img width="185" height="132" align="left" src="waterboxes.png" alt="Example of waterboxes"></div>
<h3 id="waterboxes"><a href="#waterboxes">&bull;</a>&nbsp;H<small><sub>2</sub></small>O</h3>
<p>&loz; Particularly at a tasting of a sweet fortified wine, drinking water is important. 
It is possible to add a set of little glass icons (see lower-right of figure on left) with which to record water consumption: check one for each glass of water downed. 
Even better, use a diagonal slash (<img width="11" height="11" src="water_drank_half.gif" alt="I drank half a glass of water">) for a half glass of water, 
and a cross (<img width="11" height="11" src="water_drank_full.gif" alt="I drank a whole glass of water">) for a whole.</p>
<p>This is activated by the parameter <tt>WaterBoxes</tt>, which takes one of the values: 
<tt><span class="nametype">/Glasses</span></tt> (so the water boxes appear on the glasses pages); 
<tt><span class="nametype">/TastingNotes</span></tt> (on the tasting-note pages, see <a href="http://www.theportforum.com/viewtopic.php?t=175&amp;start=929">discussion</a>); 
<tt><span class="nametype">/Both</span></tt> (on both); 
<tt><span class="nametype">/None</span></tt> (none). 
The number of boxes is <tt>WaterBoxesNum</tt>, each of which is no bigger than <tt>WaterBoxesSizeMax</tt> on each side, the gap&divide;box ratio being <tt>WaterBoxesGapProportionSize</tt>.</p>

<p>On glasses pages boxes should appear on the lower-right of the page for right-handed drinkers, and lower-left for left-handers. 
Tasters&rsquo; handedness is set by <tt>LeftHanders</tt>, an array of the text of the name of known left-handers, whether or not at this tasting. 
If a name within <tt>Names</tt> is duplicated, and both are to be left-handed, that name must appear twice within <tt>LeftHanders</tt>.</p>

<p>If there are multiple pages of glasses (see <tt><a href="#glassesonsheets_glassesontastingnotepages">GlassesOnSheets</a></tt> below), 
then on which of these pages should they appear? 
For simplicity, <tt>WaterBoxesOverrideShowEverySheet</tt> being <tt><span class="operator">true</span></tt> overrides the complexity in the next few sentences, putting water boxes on every sheet (of glasses or of tasting notes, per <tt>WaterBoxes</tt>). 
But if <tt>WaterBoxesOverrideShowEverySheet</tt> is <tt><span class="operator">false</span></tt>, the presence or absence is controlled, for the right handers, by the array of booleans <tt>WaterBoxesShowRight</tt>; 
and for the lefties by <tt>WaterBoxesShowLeft</tt>. 
<i>Nota Bene</i>: <tt>WaterBoxesShowRight</tt> and <tt>WaterBoxesShowLeft</tt> must be the same length as <tt>GlassesOnSheets</tt>. 
The default values of <tt>WaterBoxesShowRight</tt> and <tt>WaterBoxesShowLeft</tt> refer to <tt><a href="#page_order">PageOrderingGlasses</a></tt>, 
which is implicitly assumed to specify sessions.
Naturally enough, <tt>WaterBoxesShowRight</tt> defaults to <tt><span class="operator">true</span></tt> for the last page in each &lsquo;session&rsquo;, 
and <tt>WaterBoxesShowLeft</tt> for the first. 
There is an analgous parameter <tt>WaterBoxesShowTN</tt>, used for water boxes on the tasting-note sheets.</p>

<div id="theportforum_logo" style="clear: right;  float: right;  margin-left: 3px;"><a href="http://www.theportforum.com/viewtopic.php?t=2021"><img width="145" height="155" src="cufflink.png" alt="www.ThePortForum.com logo on a cufflink" style="border-style: none;"></a></div>
<p><a href="#theportforum_logo">&loz;</a> The majority of the placemats created by the <a href="../../author.html">author</a> 
are for tastings arranged via <a href="http://www.theportforum.com/viewforum.php?f=3">www.ThePortForum.com</a>. 
To control the placement of a ThePortForum icon (examples on <a href="#example">page at top</a>, cufflink bearing logo on right), the parameter 
<tt>ThePortForumIconPlacement</tt> is set to one of <tt><span class="nametype">/None</span></tt>, <tt><span class="nametype">/LowerLeft</span></tt>, <tt><span class="nametype">/LowerRight</span></tt>, <tt><span class="nametype">/UpperLeft</span></tt>, <tt><span class="nametype">/UpperRight</span></tt>, 
<tt><span class="nametype">/LowerNonWaterBox</span></tt>, <tt><span class="nametype">/UpperNonWaterBox</span></tt> or <tt><span class="nametype">/UpperNonWaterBox</span></tt>, 
the last three evaluating to left or right according to the side on which the <tt>WaterBoxes</tt> are placed. 
Alternatively, for multiple icons on the page, <tt>ThePortForumIconPlacement</tt> can be an array of any of the non-<tt><span class="nametype">/None</span></tt> of these possibilities. 
Icons on the tasting-note pages are controlled by <tt>ThePortForumIconTastingNotePlacement</tt>, with permitted values <tt><span class="nametype">/None</span></tt>, <tt><span class="nametype">/LowerLeft</span></tt>, <tt><span class="nametype">/LowerRight</span></tt>, <tt><span class="nametype">/UpperLeft</span></tt>, <tt><span class="nametype">/UpperRight</span></tt>, 
<tt><span class="nametype">/LowerNonName</span></tt>, <tt><span class="nametype">/UpperNonName</span></tt> and <tt><span class="nametype">/UpperName</span></tt>. 
Whether or not the icons are shown in colour, 
<img width="16" height="16" src="tpf_clr_16.gif" alt="small colour ThePortForum logo" style="vertical-align: text-top;"> or 
<img width="16" height="16" src="tpf_bw_16.gif" alt="small black-and-white ThePortForum logo" style="vertical-align: text-top;">, 
is set by the boolean <tt>ThePortForumIconColour</tt>.</p>

<div>
<h3 id="headers_footers_externallinks"><a href="#headers_footers_externallinks">&bull;</a>&nbsp;Headers and footers, and external links</h3>
<p id="headers_footers"><a href="#headers_footers">&loz;</a> Headers and footers can be added to the page. 
Typically these will hold a date, a location, a title, and perhaps some branding&mdash;the <a href="../../author.html">author</a> includes URLs. 
There is a little intricacy, to allow tastings split into multiple sessions to have different headers and footers in each session. 
The parameters doing most of the work are <tt>HeadersLeft</tt>, <tt>HeadersCenter</tt>, <tt>HeadersRight</tt>, and their <tt>Footer</tt>&hellip; equivalents, though using all of six of these text positions would be very cluttered. 
Each is an array of even length. 
First, the default simple case: make the first item <tt>0</tt>, and the second item the required compound string. 
Usually elegance is enhanced by having left and right headers of approximately equal length.</p>
<pre style="clear: right;  float: right;  margin-top: 0px;  margin-right: 0px;  margin-left: 4px;"><span class="nametype">/HeadersLeft</span> <span class="array">[</span>
	0  <span class="stringtype">(The Pub, Saturday Afternoon)</span>  <span class="comment">% If PageOrdering &gt;=0 and &lt;10</span>
	10  <span class="stringtype">(The Hotel, Saturday Evening)</span>  <span class="comment">% If PageOrdering &gt;=10</span>
<span class="array">]</span> <span class="operator">def</span></pre>
<p>To have different headers on different pages, each array consists of alternate items as in the simple example on the right: <i>number</i>; <i>compound string</i>; <i>number</i>; <i>compound string</i>;&nbsp;&hellip;. 
The number is a <a href="#page_order">page ordering</a>, with the immediately following compound string to be used only if the page ordering is at least this (unless over-ruled by a larger number that is still not bigger than the page ordering).</p>
<p>Headers are shown in font <tt>HeaderFont</tt>, at size <tt>HeaderFontSize</tt>, 
with the baseline of the characters a distance <tt>HeaderBaselineFromPageTop</tt> from the top of the page (which should be inside the top margin). 
Likewise <tt>FooterLeftText</tt>, <tt>FooterCenterText</tt>, and <tt>FooterRightText</tt>
are shown in <tt>FooterFont</tt> at size <tt>FooterFontSize</tt>, 
with the top of the footer a distance <tt>FooterTopFromPageBottom</tt> from page bottom (which should be inside the bottom margin).
Very rarely one might want the centre heading non-centred (<a href="http://www.jdawiseman.com/2012/20121113_graham.pdf">e.g.</a>). 
This can be controlled with <tt>HeaderFooterCenterX</tt>, which is <i>x</i> position of the centre of the relevant item of <tt>HeadersCenter</tt> and of <tt>FootersCenter</tt>.</p>
</div>

<div class="BorderGraphic" style="clear: right;  float: right; margin-left: 4px;"><img width="223" height="165" align="right" src="ExternalLinks_triangles.png" alt="Parent and child links"></div>
<p id="externallinks"><a href="#externallinks">&loz;</a> It might be that in the future somebody finds, somewhere on the web, a copy of the placemat PDF. 
There should be a route home. 
A PDF document can have an &lsquo;outline&rsquo;, usually shown in a sidebar, that summarises the document structure and provides internal navigation. 
The placemat software creates this automatically. 
At the end of the outline are relevant external links. 
The user can create these with the array <tt>ExternalLinks</tt>, which is an array of length a multiple of three: a boolean0, Descriptor0, URL0, boolean1, Descriptor1, URL1, etc&nbsp;&hellip;. 
The first boolean must be <tt><span class="operator">false</span></tt>; 
subsequent booleans are <tt><span class="operator">true</span></tt> if the link is a &lsquo;child&rsquo; of the previous &lsquo;<tt><span class="operator">false</span></tt>&rsquo; link, and are <tt><span class="operator">false</span></tt> if a &lsquo;parent&rsquo; link. 
(If the PDF viewer is showing the table of contents there is a small triangle beside the &lsquo;parent&rsquo; link: pointing right (&ldquo;<span style="color: #909090;">&#9656;</span>&rdquo;) if the children are hidden; pointing down (&ldquo;<span style="color: #909090;">&#9662;</span>&rdquo;) if the children are visible; rotated between the two by being clicked on&mdash;see image on right.) 
The descriptions can be compound strings, <tt><span class="array">[</span>&hellip;<span class="array">]</span></tt>. 
The URLs must be plain simple strings, <tt><span class="stringtype">(&hellip;)</span></tt>, not arrays nor compound strings, and must start with the protocol, typically &ldquo;<tt>http://</tt>&rdquo;. 
For some venues, some useful parts of <tt>ExternalLinks</tt> are in 
<a href="http://www.theportforum.com/viewtopic.php?t=175&amp;start=871"> a post in a thread entitled <i>Software that makes placemats</i></a>.</p>

<p id="ParametersDate"><a href="#ParametersDate">&loz;</a> <tt>ParametersVersionDateTimeAdobeFormat</tt> holds the date and time on which the parameters were last updated, as a string in the Adobe date format <tt><span class="stringtype">(D:<i>YYYYMMDDhhmm</i>)</span></tt>. 
This isn&rsquo;t necessarily important, but appears in the log file and embedded in multiple places in the PDF. 
Users mindful of versioning might wish to update it. 
(Programmers creating a wizard to change the parameters, who want the wizard name and version date to be output to the log file, should define strings <tt>WizardLongName</tt> and <tt>WizardVersionDateTimeAdobeFormat</tt> = the version of the Wizard software; <tt style="font-size: small;">ParametersVersionDateTimeAdobeFormat</tt> equalling the time-stamp of the parameters = the run-time of the Wizard.)</p>

<div class="technical_note"><p>Technical note: the radius is a root of a polynomial for all packing styles other than <tt><span class="nametype">/Arch</span></tt>. 
The polynomials were devised over some years, mostly by hand, and the PostScript solves them by calling <tt>PolynomialRoots</tt> which in turn calls <tt>PolynomialRoot</tt>. 
For mathematical readers the polynomials have been regenerated in Mathematica, and published as a <a href="PackingStyles_formulae.nb">Mathematica notebook</a> and in <a href="PackingStyles_formulae.pdf">PDF</a>. 
Please report errors and improvements to <a href="../../author.html">the author</a>.</p>
<p>For most packing styles the radius and positions are computed analytically using built-in mathematical operators. 
There are three exceptions. 
For <tt><a href="#PermittedPackingStyles_DiamondsPlus"><span class="nametype">/DiamondsPlus</span></a></tt>, two quartic equations are solved numerically. 
For <tt><a href="#PermittedPackingStyles_Temple"><span class="nametype">/Temple</span></a></tt>, two <span title="Yes, I know. I really know. Computing the coefficients of an octic polynomial (blah&#8328;&times;r&#8312;&nbsp;+ blah&#8327;&times;r&#8311;&nbsp;+ &hellip; +&nbsp;blah&#8321;&times;r +&nbsp;blah&#8320;), in single-precision PostScript, is ludicrous. And finding the roots of that octic polynomial, again in single-precision PostScript, is, well, at least as ludicrous. I really know.">octic equations</span> are solved numerically. 
For <tt><a href="#PermittedPackingStyles_Arch_PostsAndLintel"><span class="nametype">/Arch</span></a></tt>, the computation is an interval-bisection loop containing an intricate glass-positioning iteration, believed to be correct to within 0.1&nbsp;pt&nbsp;&asymp; 0.035&nbsp;mm.</p>
<p>Hereby acknowledged is the unwisdom of doing these in a language the only floating precision of which is <a href="http://en.wikipedia.org/wiki/Single-precision_floating-point_format">single</a>.</p></div>

<h3 id="layout"><a href="#layout">&bull;</a>&nbsp;Layout</h3>

<p id="PermittedPackingStyles"><a href="#PermittedPackingStyles">&loz;</a> 
The layout of the glasses is very flexible. 
The user specifies an array, <tt>PackingStyles</tt>, which is a list of packing styles, each style optionally having constraints (e.g., only if <tt>Orientation</tt> is <tt><span class="nametype">/Landscape</span></tt>) and flags (e.g., <tt><span class="nametype">/Mirror</span></tt>). 
One at a time each style from the list is taken, and each allowed variation is tested. 
Broadly, if a later-tested style is better than the current best, in the sense of having a larger radius, then the old best is replaced by this better style. 
There follow descriptions and pictures of the various allowable styles.</p>

<div id="PermittedPackingStyles_Diamonds"><p><a href="#PermittedPackingStyles_Diamonds">&loz;</a> <b><tt><span class="nametype">/Diamonds</span></tt></b>: circles in each row and column lie midway between those in neighbouring rows and columns.</p>
<div class="PermittedPackingStyles" style="width: 124px;"><tt><span class="nametype">/A4</span></tt> (210mm&times;297mm)<br><img height="175" width="124" alt="4 glasses, /Diamonds on /A4 /Portrait" title="4 glasses, /Diamonds on /A4 /Portrait" src="PermittedPackingStyles_04_A4P_Diamonds.png"><br><tt><span class="nametype">/Diamonds</span></tt></div>
<div class="PermittedPackingStyles" style="width: 124px;"><tt><span class="nametype">/A4</span></tt><br><img height="175" width="124" alt="5 glasses, /Diamonds on /A4 /Portrait" title="5 glasses, /Diamonds on /A4 /Portrait" src="PermittedPackingStyles_05_A4P_Diamonds.png"><br><tt><span class="nametype">/Diamonds</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt> (420mm&times;297mm)<br><img height="175" width="248" alt="13 glasses, /Diamonds on /A3 /Landscape" title="13 glasses, /Diamonds on /A3 /Landscape" src="PermittedPackingStyles_13_A3L_Diamonds.png"><br><tt><span class="nametype">/Diamonds</span></tt></div>
<div class="PermittedPackingStyles" style="width: 210px;"><tt><span class="nametype">/USLegal</span></tt> (14&Prime;&times;8&frac12;&Prime;)<br><img height="127" width="210" alt="9 glasses, /Diamonds on /USLegal /Landscape" title="9 glasses, /Diamonds on /USLegal /Landscape" src="PermittedPackingStyles_09_USLegalL_Diamonds.png"><br><tt><span class="nametype">/Diamonds</span></tt></div>
<div class="PermittedPackingStyles" style="width: 210px;"><tt><span class="nametype">/USLegal</span></tt> (14&Prime;&times;8&frac12;&Prime;)<img height="127" width="210" alt="9 glasses, /Diamonds /Mirror on /USLegal /Landscape" title="9 glasses, /Diamonds /Mirror on /USLegal /Landscape" src="PermittedPackingStyles_09_USLegalL_Diamonds_Mirror.png"><br><tt><span class="array">[</span> <span class="nametype">/Diamonds</span> <span class="nametype">/Mirror</span> <span class="array">]</span></tt></div>
<p>The first four of these specify the pattern with a simple a name, <tt><span class="nametype">/Diamonds</span></tt>. 
Alternatively, one can specify a variant of the base style with an array, containing flag and constraints, such as <tt><span class="array">[</span>&nbsp;<span class="nametype">/Diamonds</span>&nbsp;<span class="nametype">/Mirror</span>&nbsp;<span class="array">]</span></tt>. 
In an array version of a style specification, the first item of the array must be the base style.</p>
</div>

<div id="PermittedPackingStyles_RectangularDislocation"><p><a href="#PermittedPackingStyles_RectangularDislocation">&loz;</a> <b><tt><span class="nametype">/RectangularDislocation</span></tt></b>: 
The next four examples are rectangular, optionally with a horizontal &lsquo;dislocation&rsquo; in the middle, that being, <tt><span class="nametype">/Diamonds</span></tt>-style, circles lying between the circles in the adjacent row.</p>
<div class="PermittedPackingStyles" style="width: 124px;"><tt><span class="nametype">/A4</span></tt><br><img height="175" width="124" alt="5 glasses, /RectangularDislocation on /A4 /Portrait" title="5 glasses, /RectangularDislocation on /A4 /Portrait" src="PermittedPackingStyles_05_A4P_RectangularDislocation.png"><br><tt><span class="nametype">/RectangularDislocation</span></tt></div>
<div class="PermittedPackingStyles" style="width: 124px;"><tt><span class="nametype">/A4</span></tt><br><img height="175" width="124" alt="6 glasses, /RectangularDislocation on /A4 /Portrait" title="6 glasses, /RectangularDislocation on /A4 /Portrait" src="PermittedPackingStyles_06_A4P_RectangularDislocation.png"><br><tt><span class="nametype">/RectangularDislocation</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="10 glasses, /RectangularDislocation on /A3 /Landscape" title="10 glasses, /RectangularDislocation on /A3 /Landscape" src="PermittedPackingStyles_11_A3L_RectangularDislocation.png"><br><tt><span class="nametype">/RectangularDislocation</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="10 glasses, /RectangularDislocation /Mirror on /A3 /Landscape" title="10 glasses, /RectangularDislocation /Mirror on /A3 /Landscape" src="PermittedPackingStyles_11_A3L_RectangularDislocation_Mirror.png"><br><tt><span class="array">[</span> <span class="nametype">/RectangularDislocation</span> <span class="nametype">/Mirror</span> <span class="array">]</span></tt></div>
<p>Again observe the <tt><span class="nametype">/Mirror</span></tt> variant.</p>
</div>

<div id="PermittedPackingStyles_SquareGrid">
<div class="PermittedPackingStyles" style="clear: right;  float: right;  margin: 4px;  width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="12 glasses, /SquareGrid on /A3 /Landscape" title="12 glasses, /SquareGrid on /A3 /Landscape" src="PermittedPackingStyles_12_A3L_SquareGrid.png"><br><tt><span class="nametype">/SquareGrid</span></tt></div>
<p><a href="#PermittedPackingStyles_SquareGrid">&loz;</a> <b><tt><span class="nametype">/SquareGrid</span></tt></b>: 
<tt><span class="nametype">/SquareGrid</span></tt> can be similar to <tt><span class="nametype">/RectangularDislocation</span></tt>. 
In the latter the glasses fill the page: observe the six-glass example above, in which the circles touch their vertical neighbours, but have a slight gap from the horizontal neighbour. 
In <tt><span class="nametype">/SquareGrid</span></tt> there is no dislocation, and by default the vertical and horizontal distances are the same and equal to the diameter (example on right). 
<tt><span class="nametype">/SquareGrid</span></tt> has two optional one-parameter flags: 
<tt><span class="nametype">/HorizontalAlignment</span></tt> (which must have a value of one of <tt><span class="nametype">/Left</span></tt>, <tt><span class="nametype">/Right</span></tt>, <tt><span class="nametype">/Centre</span></tt>, or <tt><span class="nametype">/Justify</span></tt>); and 
<tt><span class="nametype">/VerticalAlignment</span></tt> (one of <tt><span class="nametype">/Top</span></tt>, <tt><span class="nametype">/Bottom</span></tt>, <tt><span class="nametype">/Middle</span></tt>, or <tt><span class="nametype">/Justify</span></tt>). 
Obviously either <tt><span class="nametype">/Justify</span></tt> can allow the horizontal and vertical distances to differ.</p>
</div>

<div id="PermittedPackingStyles_DiamondsAndRectangular"><p><a href="#PermittedPackingStyles_DiamondsAndRectangular">&loz;</a> <b><tt><span class="nametype">/DiamondsAndRectangular</span></tt></b>: 
For some numbers of glasses and aspect ratios, the best fit can come from a pattern that is a combination of <a href="#PermittedPackingStyles_Diamonds"><tt><span class="nametype">/Diamonds</span></tt></a> and a rectangular pattern. 
The diamonds can be offset from the diamonds either vertically or horizontally.</p>
<p>Sometimes there are multiple ways to arrange the columns or rows: see the three examples of 14 glasses on A3. 
A sub-parameter can be set, <tt><span class="nametype">/RectColsToLeftOrRowsBelow</span></tt>, which specifies the number of rectangular columns to the left of the diamonds, or the number of rectangular rows below the diamonds. 
The number is automatically pruned, so far-right can be specified with the likes of <tt><span class="array">[</span>&nbsp;<span class="nametype">/DiamondsAndRectangular</span> <span class="nametype">/RectColsToLeftOrRowsBelow</span>&nbsp;999&nbsp;<span class="array">]</span></tt>. 
By default the diamonds are put in the middle, if that is possible, otherwise at <tt>0</tt> &rArr; far left or bottom.</p>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="14 glasses, /DiamondsAndRectangular on /A3 /Landscape" title="14 glasses, /DiamondsAndRectangular on /A3 /Landscape" src="PermittedPackingStyles_14_A3L_DiamondsAndRectangular.png"><br><tt><span class="nametype">/DiamondsAndRectangular</span><br>&nbsp;</tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="14 glasses, /DiamondsAndRectangular on /A3 /Landscape" title="14 glasses, /DiamondsAndRectangular on /A3 /Landscape" src="PermittedPackingStyles_14_A3L_DiamondsAndRectangular_0.png"><br><tt><span class="array">[</span> <span class="nametype">/DiamondsAndRectangular</span> <span class="nametype">/RectColsToLeftOrRowsBelow</span> 0 <span class="array">]</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="14 glasses, /DiamondsAndRectangular on /A3 /Landscape" title="14 glasses, /DiamondsAndRectangular on /A3 /Landscape" src="PermittedPackingStyles_14_A3L_DiamondsAndRectangular_2.png"><br><tt><span class="array">[</span> <span class="nametype">/DiamondsAndRectangular</span> <span class="nametype">/RectColsToLeftOrRowsBelow</span> 2 <span class="array">]</span></tt></div>
<div class="PermittedPackingStyles" style="width: 255px;"><tt><span class="nametype">/USL2</span></tt> (17&Prime;&times;11&Prime;)<br><img height="165" width="255" alt="14 glasses, /DiamondsAndRectangular on /USL2 /Landscape" title="14 glasses, /DiamondsAndRectangular on /USL2 /Landscape" src="PermittedPackingStyles_14_USL2L_DiamondsAndRectangular.png"><br><tt><span class="nametype">/DiamondsAndRectangular</span></tt></div>
<div class="PermittedPackingStyles" style="width: 210px;"><tt><span class="nametype">/USLegal</span></tt> (14&Prime;&times;8&frac12;&Prime;)<br><img height="127" width="210" alt="9 glasses, /DiamondsAndRectangular on /USLegal /Landscape" title="9 glasses, /DiamondsAndRectangular on /USLegal /Landscape" src="PermittedPackingStyles_09_USLegalL_DiamondsAndRectangular.png"><br><tt><span class="nametype">/DiamondsAndRectangular</span></tt></div>
</div>

<div id="PermittedPackingStyles_RectangularAlternateNudge"><p><a href="#PermittedPackingStyles_RectangularAlternateNudge">&loz;</a> <b><tt><span class="nametype">/RectangularAlternateNudge</span></tt></b>: 
In this third rectangular variant, alternate rows (or columns) are slightly nudged, better to fill the space.</p>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="12 glasses, /RectangularAlternateNudge on /A3 /Landscape" title="12 glasses, /RectangularAlternateNudge on /A3 /Landscape" src="PermittedPackingStyles_12_A3L_RectangularAlternateNudge.png"><br><tt><span class="nametype">/RectangularAlternateNudge</span></tt></div>
<p>Thus <tt><span class="nametype">/RectangularAlternateNudge</span></tt> is a small deviation away from greater symmetry, about which the <a href="../../author.html">the author</a> is unenthusiastic. 
Because of this non-enthusiasm, by default, <tt><span class="nametype">/RectangularAlternateNudge</span></tt> comes with a sub-parameter: <tt><span class="array">[</span>&nbsp;<span class="nametype">/RectangularAlternateNudge</span> <span class="nametype">/ImprovementPointsMin</span>&nbsp;2&nbsp;<span class="array">]</span></tt>. 
This imposes an additional requirement: choose this packing style only if it is an improvement on the previous best radius of &ge;&nbsp;2 points&nbsp;&asymp;&nbsp;<span title="2 &times; 127/360 = 0.70555&hellip;">0.7</span>&nbsp;mm. 
The next four examples show six glasses on <tt><span class="nametype">/USL</span></tt>&nbsp;= 8&frac12;&Prime;&times;11&Prime;, with margins of 24pt =&nbsp;&#8531;&Prime;, using the packing styles <tt><span class="nametype">/Diamonds</span></tt> (<i>radius</i>&nbsp;&asymp;&nbsp;117.9); <tt><span class="nametype">/SquareGrid</span></tt> and <tt><span class="nametype">/RectangularDislocation</span></tt> (<i>radius</i>&nbsp;=&nbsp;124); and <tt><span class="nametype">/RectangularAlternateNudge</span></tt> (<i>radius</i>&nbsp;&asymp;&nbsp;126.3). 
So the radius improves by &asymp;&nbsp;2.3&nbsp;pt, and hence the diameter by &asymp;&nbsp;1.6&nbsp;mm. 
But on <tt><span class="nametype">/A4</span></tt> the improvement in the radius is much less: only &asymp;&nbsp;0.19&nbsp;pt&nbsp;&asymp; 0.066&nbsp;mm, which seems insufficient to justify the asymmetry&rsquo;s aesthetic damage.</p>
<div class="PermittedPackingStyles" style="width: 127px;"><tt><span class="nametype">/USL</span></tt> (8&frac12;&Prime;&times;11&Prime;)<br><img height="165" width="127" alt="6 glasses, /Diamonds on /USL /Portrait" title="6 glasses, /Diamonds on /USL /Portrait" src="PermittedPackingStyles_06_USLP_Diamonds.png"><br><small><tt><span class="nametype">/Diamonds</span></tt></small><br><i>radius</i>&nbsp;&asymp;&nbsp;117.9pt &asymp;&nbsp;1.64&Prime;</div>
<div class="PermittedPackingStyles" style="width: 127px;"><tt><span class="nametype">/USL</span></tt> (8&frac12;&Prime;&times;11&Prime;)<br><img height="165" width="127" alt="6 glasses, /SquareGrid on /USL /Portrait" title="6 glasses, /SquareGrid on /USL /Portrait" src="PermittedPackingStyles_06_USLP_SquareGrid.png"><br><small><tt><span class="nametype">/SquareGrid</span></tt></small><br><i>radius</i>&nbsp;=&nbsp;124pt &asymp;&nbsp;1.72&Prime;</div>
<div class="PermittedPackingStyles" style="width: 127px;"><tt><span class="nametype">/USL</span></tt> (8&frac12;&Prime;&times;11&Prime;)<br><img height="165" width="127" alt="6 glasses, /RectangularDislocation on /USL /Portrait" title="6 glasses, /RectangularDislocation on /USL /Portrait" src="PermittedPackingStyles_06_USLP_RectangularDislocation.png"><br><small><tt><span class="nametype">/RectangularDislocation</span></tt></small><br><i>radius</i>&nbsp;=&nbsp;124pt &asymp;&nbsp;1.72&Prime;</div>
<div class="PermittedPackingStyles" style="width: 127px;"><tt><span class="nametype">/USL</span></tt> (8&frac12;&Prime;&times;11&Prime;)<br><img height="165" width="127" alt="6 glasses, /RectangularAlternateNudge on /USL /Portrait" title="6 glasses, /RectangularAlternateNudge on /USL /Portrait" src="PermittedPackingStyles_06_USLP_RectangularAlternateNudge.png"><br><small><tt><span class="nametype">/RectangularAlternateNudge</span></tt></small><br><i>radius</i>&nbsp;&asymp;&nbsp;126.3pt &asymp;&nbsp;1.75&Prime;</div>
</div>

<div id="PermittedPackingStyles_RectangularAlternateSplitNudge"><p><a href="#PermittedPackingStyles_RectangularAlternateSplitNudge">&loz;</a> <b><tt><span class="nametype">/RectangularAlternateSplitNudge</span></tt></b>: 
This is a second &lsquo;nudged&rsquo; rectangular variant, with the non-nudged rows (or columns) centred (or middled), and the nudged rows (etc) split, part nudged left (&hellip;) and part nudged right (). 
This works particularly well for twelve glasses on <tt><span class="nametype">/USL2</span></tt>&nbsp;=&nbsp;17&Prime;&times;11&Prime;. 
In the two 12-glass examples below the rows are nudged; in the two 10-glass examples the columns are nudged. 
Note that <tt><span class="nametype">/RectangularAlternateSplitNudge</span></tt> does not maximise the radius (obviously non-split nudging gives a larger radius) so for it to be used most other styles have to be removed from <tt>PackingStyles</tt>, or otherwise suppressed.</p>
<div class="PermittedPackingStyles" style="width: 255px;"><tt><span class="nametype">/USL2</span></tt> (17&Prime;&times;11&Prime;)<br><img height="165" width="255" alt="12 glasses, /RectangularAlternateSplitNudge on /USL2 /Landscape" title="12 glasses, /RectangularAlternateSplitNudge on /USL2 /Landscape" src="PermittedPackingStyles_12_USL2L_RectangularAlternateSplitNudge.png"><br><tt><span class="nametype">/RectangularAlternateSplitNudge</span></tt></div>
<div class="PermittedPackingStyles" style="width: 255px;"><tt><span class="nametype">/USL2</span></tt> (17&Prime;&times;11&Prime;)<br><img height="165" width="255" alt="12 glasses, [ /RectangularAlternateSplitNudge /Mirror ] on /USL2 /Landscape" title="12 glasses, [ /RectangularAlternateSplitNudge /Mirror ] on /USL2 /Landscape" src="PermittedPackingStyles_12_USL2L_RectangularAlternateSplitNudge_Mirror.png"><br><tt><span class="array">[</span> <span class="nametype">/RectangularAlternateSplitNudge</span> <span class="nametype">/Mirror</span> <span class="array">]</span></tt></div>
<div class="PermittedPackingStyles" style="width: 255px;"><tt><span class="nametype">/USL2</span></tt> (17&Prime;&times;11&Prime;)<br><img height="165" width="255" alt="10 glasses, /RectangularAlternateSplitNudge on /USL2 /Landscape" title="10 glasses, /RectangularAlternateSplitNudge on /USL2 /Landscape" src="PermittedPackingStyles_10_USL2L_RectangularAlternateSplitNudge.png"><br><tt><span class="nametype">/RectangularAlternateSplitNudge</span></tt></div>
<div class="PermittedPackingStyles" style="width: 255px;"><tt><span class="nametype">/USL2</span></tt> (17&Prime;&times;11&Prime;)<br><img height="165" width="255" alt="10 glasses, [ /RectangularAlternateSplitNudge /Mirror ] on /USL2 /Landscape" title="10 glasses, [ /RectangularAlternateSplitNudge /Mirror ] on /USL2 /Landscape" src="PermittedPackingStyles_10_USL2L_RectangularAlternateSplitNudge_Mirror.png"><br><tt><span class="array">[</span> <span class="nametype">/RectangularAlternateSplitNudge</span> <span class="nametype">/Mirror</span> <span class="array">]</span></tt></div>
<p>Both <tt><span class="nametype">/RectangularAlternateSplitNudge</span></tt> and <tt><span class="nametype">/RectangularAlternateNudge</span></tt> admit use of flags <tt><span class="nametype">/ProhibitVerticalNudging</span></tt> or <tt><span class="nametype">/ProhibitHorizontalNudging</span></tt>. Obviously using both would be strange.</p>
</div>

<div id="PermittedPackingStyles_DiamondsPlus">
<div class="PermittedPackingStyles" style="clear: right;  float: right;  margin: 4px;  width: 124px;"><tt><span class="nametype">/A4</span></tt><br><img height="175" width="124" alt="7 glasses, /DiamondsPlus on /A4 /Portrait" title="7 glasses, /DiamondsPlus on /A4 /Portrait" src="PermittedPackingStyles_07_A4P_DiamondsPlus.png"><br><tt><span class="nametype">/DiamondsPlus</span></tt></div>
<p><a href="#PermittedPackingStyles_DiamondsPlus">&loz;</a> <b><tt><span class="nametype">/DiamondsPlus</span></tt></b> 
is mostly three-row diamonds (or, if <tt><span class="nametype">/Portrait</span></tt>, three-column), with two extras set between the three rows (columns). 
It is the best packing of seven or ten glasses on several paper sizes.</p><p>There is a generalisation of <tt><span class="nametype">/DiamondsPlus</span></tt> over any odd number of rows (columns), not yet coded.</p>
</div>

<div id="PermittedPackingStyles_Arch_PostsAndLintel"><p><a href="#PermittedPackingStyles_Arch_PostsAndLintel">&loz;</a> <b><tt><span class="nametype">/Arch</span></tt></b> and <b><tt><span class="nametype">/PostsAndLintel</span></tt></b>: 
<tt><span class="nametype">/PostsAndLintel</span></tt> arranges the circles around the left, top and right edges of the page, optionally with some circles at the bottom centre. 
This design might be particularly appropriate if the central circles held the candidate blends of a vintage, with some of the components around the edge.
<tt><span class="nametype">/Arch</span></tt> is similar, with the circles on a half ellipse.</p>
<p>The next four examples are specified as follows:</p>
<ul>
<li><tt><span class="array">[</span> <span class="nametype">/PostsAndLintel</span> <span class="nametype">/CentralGlasses</span> 1 <span class="array">]</span></tt></li>
<li><tt><span class="array">[</span> <span class="nametype">/PostsAndLintel</span> <span class="nametype">/CentralGlasses</span> 1 <span class="nametype">/Mirror</span> <span class="array">]</span></tt></li>
<li><tt><span class="array">[</span> <span class="nametype">/Arch</span> <span class="nametype">/CentralGlasses</span> 1 <span class="array">]</span></tt></li>
<li><tt><span class="array">[</span> <span class="nametype">/Arch</span> <span class="nametype">/CentralGlasses</span> 3 <span class="nametype">/Mirror</span> <span class="array">]</span></tt></li>
</ul>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="8 glasses, /PostsAndLintel on /A3 /Landscape" title="8 glasses, /PostsAndLintel on /A3 /Landscape" src="PermittedPackingStyles_08_A3L_PostsAndLintel.png"><br><tt><span class="array">[</span> <span class="nametype">/PostsAndLintel</span> <span class="nametype">/CentralGlasses</span> 1 <span class="array">]</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="7 glasses, /PostsAndLintel /Mirror on /A3 /Landscape" title="7 glasses, /PostsAndLintel /Mirror on /A3 /Landscape" src="PermittedPackingStyles_07_A3L_PostsAndLintel_Mirror.png"><br><tt><span class="array">[</span> <span class="nametype">/PostsAndLintel</span> <span class="nametype">/CentralGlasses</span> 1 <span class="nametype">/Mirror</span> <span class="array">]</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="8 glasses, /Arch on /A3 /Landscape" title="8 glasses, /Arch on /A3 /Landscape" src="PermittedPackingStyles_08_A3L_Arch.png"><br><tt><span class="array">[</span> <span class="nametype">/Arch</span> <span class="nametype">/CentralGlasses</span> 1 <span class="array"> ]</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="10 glasses, /Arch on /A3 /Landscape" title="10 glasses, /Arch on /A3 /Landscape" src="PermittedPackingStyles_10_A3L_Arch_Mirror.png"><br><tt><span class="array">[</span> <span class="nametype">/Arch</span> <span class="nametype">/CentralGlasses</span> 3 <span class="nametype">/Mirror</span> <span class="array"> ]</span></tt></div>
<p>The maximum number of <span class="nametype">/CentralGlasses</span> is 3.</p>
</div>

<div id="PermittedPackingStyles_Bespoke"><p><a href="#PermittedPackingStyles_Bespoke">&loz;</a> <b><tt><span class="nametype">/Bespoke5</span></tt></b> and <b><tt><span class="nametype">/Bespoke7</span></tt></b>: 
Ignored for more than five and seven glasses, respectively.</p>
<div class="PermittedPackingStyles" style="width: 175px;"><tt><span class="nametype">/A4</span></tt><br><img height="124" width="175" alt="5 glasses, /Bespoke5 on /A3 /Landscape" title="5 glasses, /Bespoke5 on /A3 /Landscape" src="PermittedPackingStyles_05_A4L_Bespoke5.png"><br><tt><span class="nametype">/Bespoke5</span></tt></div>
<div class="PermittedPackingStyles" style="width: 175px;"><tt><span class="nametype">/A4</span></tt><br><img height="124" width="175" alt="5 glasses, /Bespoke5 on /A3 /Landscape" title="5 glasses, /Bespoke5 on /A3 /Landscape" src="PermittedPackingStyles_05_A4L_Bespoke5_Mirror.png"><br><tt><span class="array">[</span> <span class="nametype">/Bespoke5</span> <span class="nametype">/Mirror</span> <span class="array">]</span></tt></div>
<div class="PermittedPackingStyles" style="width: 210px;"><tt><span class="nametype">/USLegal</span></tt> (14&Prime;&times;8&frac12;&Prime;)<br><img height="127" width="210" alt="7 glasses, /Bespoke7 on /USLegal /Landscape" title="7 glasses, /Bespoke7 on /USLegal /Landscape" src="PermittedPackingStyles_07_USLegal_Bespoke7.png"><br><tt><span class="nametype">/Bespoke7</span></tt></div>
<div class="PermittedPackingStyles" style="width: 210px;"><tt><span class="nametype">/USLegal</span></tt> (14&Prime;&times;8&frac12;&Prime;)<br><img height="127" width="210" alt="7 glasses, /Bespoke7 on /USLegal /Landscape" title="7 glasses, /Bespoke7 on /USLegal /Landscape" src="PermittedPackingStyles_07_USLegal_Bespoke7_Mirror.png"><br><tt><span class="array">[</span> <span class="nametype">/Bespoke7</span> <span class="nametype">/Mirror</span> <span class="array">]</span></tt></div>
<p>This looks less good in <span class="nametype">/Portrait</span>, so the default specifications are of the form <tt><span class="array">[</span> <span class="nametype">/Bespoke5</span> <span class="nametype">/OnlyIfOrientation</span> <span class="nametype">/Landscape</span> <span class="array">]</span></tt>. Self-evidently, the <tt><span class="nametype">/OnlyIfOrientation</span></tt> causes the pattern to be ignored if the orientation is wrong.</p>
</div>

<div id="PermittedPackingStyles_Temple"><p><a href="#PermittedPackingStyles_Temple">&loz;</a> <b><tt><span class="nametype">/Temple</span></tt></b>: 
An intricate pattern, that has the largest radius for 10 glasses on <tt><span class="nametype">/USL</span></tt>, and for 13 glasses on either <tt><span class="nametype">/USLegal</span></tt> or <tt><span class="nametype">/USL2</span></tt>. 
The sub-parameter <tt><span class="nametype">/TempleExtraColsToLeftOrRowsBelow</span></tt> is to <tt><span class="nametype">/Temple</span></tt> as <tt><a href="#PermittedPackingStyles_DiamondsAndRectangular"><span class="nametype">/RectColsToLeftOrRowsBelow</span></a></tt> is to <tt><span class="nametype">/DiamondsAndRectangular</span></tt> (so is followed by one integer).</p>
<div class="PermittedPackingStyles" style="width: 165px;"><tt><span class="nametype">/USL</span></tt> (11&Prime;&times;8&frac12;&Prime;)<br><img height="127" width="165" alt="10 glasses, /Temple on /USL /Landscape" title="10 glasses, /Temple on /USL /Landscape" src="PermittedPackingStyles_10_USLL_Temple.png"><br><tt><span class="nametype">/Temple</span></tt></div>
<div class="PermittedPackingStyles" style="width: 210px;"><tt><span class="nametype">/USLegal</span></tt> (14&Prime;&times;8&frac12;&Prime;)<br><img height="127" width="210" alt="13 glasses, /Temple on /USLegal /Landscape" title="13 glasses, /Temple on /USLegal /Landscape" src="PermittedPackingStyles_13_USLegalL_Temple.png"><br><tt><span class="nametype">/Temple</span></tt></div>
<div class="PermittedPackingStyles" style="width: 255px;"><tt><span class="nametype">/USL2</span></tt> (17&Prime;&times;11&Prime;)<br><img height="165" width="255" alt="13 glasses, /Temple on /USL2 /Landscape" title="13 glasses, /Temple on /USL2 /Landscape" src="PermittedPackingStyles_13_USL2L_Temple.png"><br><tt><span class="nametype">/Temple</span></tt></div>
</div>

<div id="PermittedPackingStyles_1Row"><p><a href="#PermittedPackingStyles_1Row">&loz;</a> There are also three simple designs, <b><tt><span class="nametype">/TopRow</span></tt></b>, <b><tt><span class="nametype">/MiddleRow</span></tt></b>, <b><tt><span class="nametype">/BottomRow</span></tt></b>, each having everything in one row, with obvious vertical position. 
There are also <b><tt><span class="nametype">/Sides</span></tt></b>, <b><tt><span class="nametype">/LeftSide</span></tt></b>, and <b><tt><span class="nametype">/RightSide</span></tt></b>, with the obvious meanings. 
For more than a few glasses these &lsquo;one-dimensional&rsquo; designs are too cramped.</p>

<p id="SuppressNonRightOrnaments">Indeed, <tt><span class="nametype">/RightSide</span></tt> (and, <i>mutatis mutandis</i>, <tt><span class="nametype">/LeftSide</span></tt>) have a particular use. 
Consider a tasting with 17 glasses. This could be set as 6 + 6 + 5 on 3&times;<tt><span class="nametype">A4</span></tt>. 
But if table space were tight, 14 on 1&times;<tt><span class="nametype">A3</span></tt> and 3 on 1&times;<tt><span class="nametype">/RightSide</span></tt> <tt><span class="nametype">/A4</span></tt> would use only 2&frac12;&times;<tt><span class="nametype">/A4</span></tt> widths, if the unused half of the <tt><span class="nametype">/A4</span></tt> were tucked under the <tt><span class="nametype">/A3</span></tt> (e.g., <a href="http://www.jdawiseman.com/2018/20181211_Offley.pdf">Offley on 11 December 2018</a>). 
Suppressing the ornaments tucked under the <tt><span class="nametype">/A3</span></tt>, such as <tt>HeadersCenter</tt>, would look neater. 
This can be done by adding to the array an extra flag, <tt><span class="nametype">/SuppressNonRightOrnaments</span></tt> (or <tt><span class="nametype">/SuppressNonLeftOrnaments</span></tt>), which for the pages using that packing style suppresses the unwanted <a href="#headers_footers_externallinks">headers</a>, footers, <a href="#theportforum_logo">icons</a>, and <a href="#waterboxes">water boxes</a>. 
Example item of <tt>PackingStyles</tt>: <tt><span class="array">[</span>&nbsp;<span class="nametype">/RightSide</span>  <span class="nametype">/GlassesNumMax</span>&nbsp;3  <span class="nametype">/SuppressNonRightOrnaments</span>&nbsp;<span class="array">]</span></tt>.</p>

<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="4 glasses, /TopRow on /A3 /Landscape" title="4 glasses, /TopRow on /A3 /Landscape" src="PermittedPackingStyles_04_A3L_TopRow.png"><br><tt><span class="nametype">/TopRow</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="4 glasses, /MiddleRow on /A3 /Landscape" title="4 glasses, /MiddleRow on /A3 /Landscape" src="PermittedPackingStyles_04_A3L_MiddleRow.png"><br><tt><span class="nametype">/MiddleRow</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="4 glasses, /BottomRow on /A3 /Landscape" title="4 glasses, /BottomRow on /A3 /Landscape" src="PermittedPackingStyles_04_A3L_BottomRow.png"><br><tt><span class="nametype">/BottomRow</span></tt></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="6 glasses, /Sides on /A3 /Landscape" title="6 glasses, /Sides on /A3 /Landscape" src="PermittedPackingStyles_06_A3L_Sides.png"><br><tt><span class="nametype">/Sides</span></tt></div>
<div class="PermittedPackingStyles" style="width: 124px;"><tt><span class="nametype">/A4</span></tt><br><img height="175" width="124" alt="3 glasses, /LeftSide on /A4 /Portrait" title="3 glasses, /LeftSide on /A4 /Portrait" src="PermittedPackingStyles_03_A4P_LeftSide.png"><br><tt><span class="nametype">/LeftSide</span></tt></div>
<div class="PermittedPackingStyles" style="width: 124px;"><tt><span class="nametype">/A4</span></tt><br><img height="175" width="124" alt="3 glasses, /RightSide on /A4 /Portrait" title="3 glasses, /RightSide on /A4 /Portrait" src="PermittedPackingStyles_03_A4P_RightSide.png"><br><tt><span class="nametype">/RightSide</span></tt></div>
</div>

<div id="PermittedPackingStyles_array">
<div class="PermittedPackingStyles" style="clear: right;  float: right;  margin: 4px;  width: 248px;"><tt><span class="nametype">/A3</span></tt><br><img height="175" width="248" alt="[ /Array /Positions [0 2] [2 2 3 2] [4 2 3 2] [6 2] [0 1] [3 1] [6 1] [0 0] [3 0] [6 0] ] on /A3 /Landscape" title="[ /Array /Positions [0 2] [2 2 3 2] [4 2 3 2] [6 2] [0 1] [3 1] [6 1] [0 0] [3 0] [6 0] ] on /A3 /Landscape" src="PermittedPackingStyles_10_A3L_Array.gif"><br><tt><span class="array">[</span>&nbsp;<span class="nametype">/Array</span> <span class="nametype">/Positions</span> <span class="array">[</span>0 2<span class="array">]</span> <span class="array">[</span>2 2 <span class="comparison-item">3 2</span><span class="array">]</span> <span class="array">[</span>4 2 <span class="comparison-item">3 2</span><span class="array">]</span> <span class="array">[</span>6 2<span class="array">]</span> <span class="array">[</span>0 1<span class="array">]</span> <span class="array">[</span>3 1<span class="array">]</span> <span class="array">[</span>6 1<span class="array">]</span> <span class="array">[</span>0 0<span class="array">]</span> <span class="array">[</span>3 0<span class="array">]</span> <span class="array">[</span>6 0<span class="array">]</span>&nbsp;<span class="array">]</span></tt></div>

<p><a href="#PermittedPackingStyles_array">&loz;</a> Alternatively, <tt>PackingStyles</tt> may specify a layout with an array of coordinates. 
Such a specification is always an array, <tt><span class="array">[</span>&nbsp;<span class="nametype">/Array</span> &hellip; <span class="nametype">/Positions</span> &hellip;&nbsp;<span class="array">]</span></tt>.</p>
<p>After the <tt><span class="nametype">/Positions</span></tt> marker is a list of points, typically of the form <tt><span class="array">[</span><i>x</i> <i>y</i><span class="array">]</span></tt>, with <i>y</i> increasing up the page. 
The code then chooses the radius and separately scales the <i>x</i> and <i>y</i> directions such that things fit as snugly as possible, obviously subject to the other upper bounds on the radius. 
The glass ordering is that given in the array: there is no subsequent sorting or ordering.</p>
<p>There is a more complicated variant (inspired by a <a href="placemats_list.html#a20111117">GC + SW + QH triple vertical</a>, and used in a different way for a <a href="placemats_list.html#a20191023">Messias vertical</a>), in which some of the sub-arrays are of the form 
<tt><span class="array">[</span><i>x</i> <i>y</i> <i>x</i>&prime; <i>y</i>&prime;<span class="array">]</span></tt>. 
The first two elements are used, as before, and fix the radius and the canvas. 
The circle at (<i>x</i>,<i>y</i>) is then moved in a straight line towards (<i>x</i>&prime;,<i>y</i>&prime;). 
A circle stops moving if it collides with another circle (a tangential touch not being a collision); if it collides with the edge of the page; or it arrives at (<i>x</i>&prime;,<i>y</i>&prime;).</p>
<p>As an example of unmoved and moved circles, the diagram on the right has two frames, the difference being the small italic numbers in 
<tt><span class="array">[</span>&nbsp;<span class="nametype">/Array</span> <span class="nametype">/Positions</span> <span class="array">[</span>0 2<span class="array">]</span> <span class="array">[</span>2 2 <span class="comparison-item">3 2</span><span class="array">]</span> <span class="array">[</span>4 2 <span class="comparison-item">3 2</span><span class="array">]</span> <span class="array">[</span>6 2<span class="array">]</span> <span class="array">[</span>0 1<span class="array">]</span> <span class="array">[</span>3 1<span class="array">]</span> <span class="array">[</span>6 1<span class="array">]</span> <span class="array">[</span>0 0<span class="array">]</span> <span class="array">[</span>3 0<span class="array">]</span> <span class="array">[</span>6 0<span class="array">]</span>&nbsp;<span class="array">]</span></tt>. 
For the author&rsquo;s taste, the closer relationship of the two B0 circles means they should be touching, rather than equally spaced between A0 and C0.</p>
</div>

<div id="PermittedPackingStyles_flags">
<p><a href="#PermittedPackingStyles_flags">&loz;</a> There are other flags and constraints and sub-parameters, as follows.</p>
<ul>
<li><tt><span class="nametype">/Mirror</span></tt>: the alternate chirality. 
If there isn&rsquo;t a sensible meaning to this, ignored.</li>
<li><tt><span class="nametype">/ShoveLeft</span></tt> and <tt><span class="nametype">/ShoveRight</span></tt>: if there is spare space between the circles, probably because the radius has been shrunk to that on another sheet, the circles are shoved leftwards (or rightwards) against that margin. 
But not heeded in every base style.</li>
<li><tt><span class="nametype">/PackingDirectionTopToBottom</span> <i>bool</i></tt> and <tt><span class="nametype">/PackingDirectionLeftToRight</span> <i>bool</i></tt>  and <tt><span class="nametype">/PackingNestingColumnMajor</span> <i>bool</i></tt>: by default most layouts start at the top-left, work across to the top-right, then start the second row slightly further down on the left. 
This can be changed: glasses can run right-to-left, bottom-to-top, and the nesting order of columns and rows can be exchanged.
For large <a href="#prepour">pre-pour</a>ed tastings on <span class="nametype">/A3</span> or <span class="nametype">/USL2</span>, generally one pre-pours the youngest first. 
If these are in the front row, it is more fiddly to lower subsequent older vintages into place. 
Adding &ldquo;<tt><span class="nametype">/PackingNestingColumnMajor</span>&nbsp;<span class="operator">true</span></tt>&rdquo; fixes this. 
(The global value of <tt>PackingNestingColumnMajor</tt> is the default value within <tt>PackingStyles</tt>, and also affects the ordering in <a href="#corkdisplay">Cork-Display pages</a>.)</li>
<li><tt><span class="nametype">/ProhibitVerticalNudging</span></tt> or <tt><span class="nametype">/ProhibitHorizontalNudging</span></tt>: have the obvious effect in base styles <tt><span class="nametype">/RectangularAlternateNudge</span></tt> and <tt><span class="nametype">/RectangularAlternateSplitNudge</span></tt>.</li>
<li><tt><span class="nametype">/RectColsToLeftOrRowsBelow</span> <i>int</i></tt> chooses the position of the diamonds-style block in <tt><span class="nametype">/DiamondsAndRectangular</span></tt>.</li>
<li><tt><span class="nametype">/TempleExtraColsToLeftOrRowsBelow</span> <i>int</i></tt> chooses the position of the &lsquo;hole&rsquo; in <tt><span class="nametype">/Temple</span></tt>.</li>
<li><tt><span class="nametype">/CentralGlasses</span> <i>int</i></tt>: both <tt><span class="nametype">/PostsAndLintel</span></tt> and <tt><span class="nametype">/Arch</span></tt> packings can have 0, 1, 2, or 3 glasses in the centre, the remainder running round the edge or semi-ellipse.</li>
<li><tt><span class="nametype">/RowsNumMin</span> <i>int</i></tt> and <tt><span class="nametype">/RowsNumMax</span> <i>int</i></tt>: minimum and maximum number of rows permitted. 
Relevant in the <tt><span class="nametype">/Diamonds</span></tt>, <tt><span class="nametype">/RectangularDislocation</span></tt>, <tt><span class="nametype">/SquareGrid</span></tt>, <tt><span class="nametype">/RectangularAlternateNudge</span></tt>, and <tt><span class="nametype">/PostsAndLintel</span></tt> packing styles.</li>
<li><tt><span class="nametype">/OnlyIfSheetNumMin</span> <i>int</i></tt> and <tt><span class="nametype">/OnlyIfSheetNumMax</span> <i>int</i></tt>: specifying permitted values for the internal variable <tt>SheetNum</tt>, which is 0 on the first sheet, 1 on the second, etc.</li>
<li><tt><span class="nametype">/GlassesNumMin</span> <i>int</i></tt> and <tt><span class="nametype">/GlassesNumMax</span> <i>int</i></tt>: permitted number of glasses. If outside range, this packing specification not used.</li>
<li><tt><span class="nametype">/OnlyIfOrientation</span> <i>name</i></tt>, the sub-parameter being one of <tt><span class="nametype">/Landscape</span></tt>, <tt><span class="nametype">/Portrait</span></tt>, or <tt><span class="nametype">/Either</span></tt>, the last being the default if this sub-parameter absent. 
If <tt>Orientation</tt> not matching, this packing specification not used.</li>
<li><tt><span class="nametype">/ImprovementPointsMin</span> <i>num</i></tt> and <tt><span class="nametype">/ImprovementProportionMin</span> <i>num</i></tt>: this specification used only if beating previous best by the required amount, either absolute (e.g., <tt>2</tt> points) or as a proportion (e.g., <tt>0.01</tt> = 1%).</li>
</ul>
</div>

<p>If <tt>PackingStyles</tt> is empty, or contains only invalid/impossible layouts, then instead several of the regular layouts are tried.</p>

<p>The following five diagrams show, for the five main page sizes with margins of 24pt = &#8531;&Prime; &asymp; 8.5mm, the pattern that allows the largest circle. 
In faint grey on each image is, for easy comparison to glass sizes, the diameter in inches and millimetres.</p>
<div class="PermittedPackingStyles" style="width: 124px;"><tt><span class="nametype">/A4</span></tt> (210mm&times;297mm)<br><img height="175" width="124" alt="/A4 /Portrait, best arrangements" title="/A4 /Portrait, best arrangements" src="PermittedPackingStyles_A4P_best.gif"></div>
<div class="PermittedPackingStyles" style="width: 248px;"><tt><span class="nametype">/A3</span></tt> (420mm&times;297mm)<br><img height="175" width="248" alt="/A3 /Landscape, best arrangements" title="/A3 /Landscape, best arrangement" src="PermittedPackingStyles_A3L_best.gif"></div>
<div class="PermittedPackingStyles" style="width: 128px;"><tt><span class="nametype">/USL</span></tt> (8&frac12;&Prime;&times;11&Prime;)<br><img height="165" width="128" alt="/USL /Portrait, best arrangements" title="/USL /Portrait, best arrangements" src="PermittedPackingStyles_USLP_best.gif"></div>
<div class="PermittedPackingStyles" style="width: 255px;"><tt><span class="nametype">/USL2</span></tt> (17&Prime;&times;11&Prime;)<br><img height="165" width="255" alt="/USL2 /Landscape, best arrangements" title="/USL2 /Landscape, best arrangement" src="PermittedPackingStyles_USL2L_best.gif"></div>
<div class="PermittedPackingStyles" style="width: 210px;"><tt><span class="nametype">/USLegal</span></tt> (14&Prime;&times;8&frac12;&Prime;)<br><img height="128" width="210" alt="/USLegal /Portrait, best arrangements" title="/USLegal /Landscape, best arrangements" src="PermittedPackingStyles_USLegalL_best.gif"></div>

<p>(Not all of these &lsquo;best&rsquo; arrangements are quite the mathematical optimum&mdash;for some of which see <a href="http://www.packomania.com/">packomania.com</a>.)</p>

<h3 id="radius_bounds"><a href="#radius_bounds">&bull;</a>&nbsp;Radius bounds</h3>

<p id="maxradius"><a href="#maxradius">&loz;</a> When there are few glasses on a page, the radius of the circles could become very large. 
Hence the radius of the circles is bounded above by <tt>MaxRadius</tt>. 
Further, if there are multiple pages of glass sheets, it can look neater if all the pages, or all the pages in the same session, have the same radius. 
This is controlled by <tt>ShrinkRadii</tt>, which can be 
<tt><span class="nametype">/NotAtAll</span></tt>, so each page&rsquo;s radius is determined independently;
<tt><span class="nametype">/ToSmallest</span></tt>, so all pages have the same radius;
or <tt><span class="nametype">/ToSmallestSamePageOrdering</span></tt>, so the radius of each page in the same session, presumed to be equivalent to having the same value of 
<tt><a href="#page_order">PageOrderingGlasses</a></tt>, is 
shrunk to the smallest of that session&rsquo;s radii. 
Alternatively, <tt>ShrinkRadii</tt> may be an array of the same length as <tt>GlassesOnSheets</tt>, 
pages being grouped if their array values are <tt><span class="operator">eq</span></tt>ual 
(so the default value of <tt>ShrinkRadii</tt>, &ldquo;<tt><span class="nametype">/ToSmallestSamePageOrdering</span></tt>&rdquo;, is equivalent to &ldquo;<tt><span class="array">{</span>PageOrderingGlasses<span class="array">}</span></tt>&rdquo;).</p>

<h3 id="other_page_types"><a href="#other_page_types">&bull;</a>&nbsp;Other Page Types</h3>

<p>Tastings also need other types of pages, including 
<a href="#tasting_note_pages">Tasting-note pages</a> and <a href="#voterecorder">Vote Recorders</a>. 
But some page types lack the space to hold all the data that can fit in a glass-sized circle, having room for only two sets of text analogous to the four title-type arrays, as well as one analogous to the <tt>Circlearrays</tt>. 
The tables shows the variables in which these are stored, and the variations of the <tt>Names</tt>-type arrays.</p>

<table class="arrays">
<col class="first-col">
<tr class="first-row"><th><p class="arrayborderbelow" style="margin: 0px; padding: 0;">On <a href="#control">Glasses</a> pages&nbsp;&rarr;</p><p style="margin: 0px; padding: 0;">Page type&nbsp;&darr;</p></th><td><tt>Names</tt></td><td><tt>Circlearrays</tt></td><td><tt>Titles</tt></td><td><tt>Abovetitles<br>Belowtitles<br>Overtitles</tt></td></tr>
<tr><th><a href="#tasting_note_pages">Tasting Notes</a></th><td><tt>NamesTastingNotes</tt></td><td><tt>CirclearraysTastingNotes</tt></td><td><tt>TitlesTastingNotes</tt></td><td><tt>SubtitlesTastingNotes</tt></td></tr>
<tr><th><a href="#voterecorder">Vote Recorder</a></th><td><tt>NamesVoteRecorder</tt></td><td><tt>CirclearraysVoteRecorder</tt></td><td><tt>TitlesVoteRecorder</tt></td><td><tt>SubtitlesVoteRecorder</tt></td></tr>
<tr><th><a href="#decantingnotes">Decanting Notes</a></th><td style="text-align: center;">&mdash;</td><td><tt>CirclearraysDecantingNotes</tt></td><td><tt>TitlesDecantingNotes</tt></td><td><tt>SubtitlesDecantingNotes</tt></td></tr>
<tr><th><a href="#corkdisplay">Cork Display</a></th><td style="text-align: center;">&mdash;</td><td><tt>CirclearraysCorkDisplay</tt></td><td><tt>TitlesCorkDisplay</tt></td><td><tt>SubtitlesCorkDisplay</tt></td></tr>
<tr><th><a href="#accounts">Accounts</a></th><td><tt>NamesAccounts</tt></td><td style="text-align: center;">&mdash;</td><td style="text-align: center;">&mdash;</td><td style="text-align: center;">&mdash;</td></tr>
<tr><th><a href="#placenames">Place Names</a></th><td>&lsquo;<tt>NamesPlaceNames</tt>&rsquo;</td><td style="text-align: center;">&mdash;</td><td style="text-align: center;">&mdash;</td><td style="text-align: center;">&mdash;</td></tr>
<tr>
		<th><a href="#prepour">Pre Pour</a></th><td style="text-align: center;">&mdash;</td>
		<td><tt>CirclearraysPrePour</tt> (box)<br><tt>Circlearrays</tt> (circle)</td>
		<td rowspan="4" colspan="2"><div style="width: 20em;  margin-left: auto;  margin-right: auto;"><div style="font-size: smaller;"><p>As on Glasses pages.</p>
			<p>Indeed, what is re-painted is a copy of whatever is on the Glasses sheets. 
			Hence these four page types require that the relevant Glasses sheets exist. 
			But they can exist and not appear, by <tt><a href="#numcopies"><span class="nametype">/GlassesNumCopies</span></a>&nbsp;0&nbsp;<span class="operator">def</span></tt>.</p></div></div></td></tr>
<tr><th><a href="#NeckTags">Neck Tags</a></th><td style="text-align: center;">&mdash;</td><td><tt>CirclearraysNeckTags</tt></td></tr>
<tr><th><a href="#stickylabels">Sticky Labels</a></th><td><span style="font-size: 50%"><tt>StickyLabelsByNameWhichReplaceCirclearrays</tt></span><br>&rArr; <tt>NamesStickyLabels</tt>,<br>else none.</td><td><tt>CirclearraysStickyLabels</tt>,<br><span title="If StickyLabelsByNameWhichReplaceCirclearrays">sometimes <tt>NamesStickyLabels</tt></span></td></tr>
<tr><th><a href="#decanterlabels">Decanter Labels</a></th><td style="text-align: center;">&mdash;</td><td style="text-align: center;">&mdash;</td></tr>
<tr class="ThickTop" style="font-size: x-small;  font-style: italic;  text-align: center;">
	<th></th>
	<td><p><tt>Names&hellip;</tt> arrays may<br>be of unequal length.</p></td>
	<td colspan="3"><p style="width: 34em;  margin-left: auto;  margin-right: auto;">All the <tt>Circlesarrays&hellip;</tt> / <tt>Titles&hellip;</tt> / <tt>Abovetitles</tt> / <tt>Belowtitles</tt> / <tt>Overtitles</tt> / <tt>Subtitles&hellip;</tt> arrays must be the same length.</p></td>
</tr>
</table>

<p><tt>NamesPlaceNames</tt> is actually an array of <tt>Names</tt>-like arrays, so nested one deeper, so there can be two place-name pages, one saying &ldquo;Julian&nbsp;W.&rdquo; and the other saying &ldquo;Roast&nbsp;beef&rdquo;&mdash;discussed <a href="#placenames">below</a>.</p>

<div style="clear: both;  float: right;"><pre><span class="nametype">/Circlearrays</span> <span class="array">[</span>
	<span class="array">[</span> <span class="stringtype">(1927)</span> <span class="stringtype">(Niepoort)</span> <span class="array">]</span>
	<span class="array">[</span> <span class="stringtype">(1931)</span> <span class="stringtype">(Niepoort)</span> <span class="array">]</span>
	<span class="array">[</span> <span class="stringtype">(1945)</span> <span class="stringtype">(Niepoort)</span> <span class="array">]</span>
	<span class="array">[</span> <span class="stringtype">(1955)</span> <span class="stringtype">(Niepoort)</span> <span class="array">]</span>
	<span class="array">[</span> <span class="stringtype">(1963)</span> <span class="stringtype">(Niepoort)</span> <span class="array">]</span>
<span class="array">]</span> <span class="operator">def</span>
<span class="nametype">/TitlesTastingNotes</span> <span class="array">[</span> Circlearrays <span class="array">{</span>0 <span class="operator">get</span><span class="array">}</span> <span class="operator">forall</span> <span class="array">]</span> <span class="operator">def</span>
<span class="nametype">/Titles</span> <span class="array">[</span> TitlesTastingNotes <span class="array">{</span>2 2 <span class="operator">getinterval</span><span class="array">}</span> <span class="operator">forall</span> <span class="array">]</span> <span class="operator">def</span></pre></div>
<p>These arrays may be set to already defined arrays, such as the default &ldquo;<tt><span class="nametype">/SubtitlesTastingNotes</span> Belowtitles <span class="operator">def</span></tt>&rdquo;. 
Or they may be set to custom values, differing from one page type to the next.</p>

<p>Indeed, it is quite usual to generate variations automatically. 
For a vertical tasting, elegance is enhanced by having in the <tt>Titles</tt> two-digit years (&ldquo;63&rdquo;), but on the tasting-note sheets four-digit years (&ldquo;1963&rdquo;). 
The example on the right generates much of this automatically, and so repays study. 
(And, of course, if you are opening a bottle of Niepoort 1927 or Niepoort 1945, invite <a href="../../author.html">me</a>.)</p>

<div class="BorderGraphic" style="clear: right;  float: right;  margin: 4px;"><img width="268" height="396" src="tn_circlesbehind.gif" alt="TastingNotesCirclesBehind" title="Two examples of TastingNotesCirclesBehind, the difference being the value of the boolean TastingNotesCirclesBehindFitAndCentreInRow"></div>
<h3 id="tasting_note_pages"><a href="#tasting_note_pages">&bull;</a>&nbsp;Tasting-note pages</h3>
<p>&loz; By default there are also tasting-note pages 
(controlled by <tt><a href="#glassesonsheets_glassesontastingnotepages">GlassesOnTastingNotePages</a></tt>), these pages being of size <tt>TastingNotesPaperType</tt> and orientation <tt>TastingNotesOrientation</tt>. 
The tasting-note pages are lightly divided into columns, the number of columns and the column headings being determined by the array 
<tt>TastingNotesColumnHeadings</tt>, by default this being <tt><span class="array">[</span>&nbsp;<span class="stringtype">(Times)</span>&nbsp;<span class="stringtype">(Eye)</span>&nbsp;<span class="stringtype">(Nose)</span>&nbsp;<span class="stringtype">(Mouth)</span>&nbsp;<span class="stringtype">(Score)</span>&nbsp;<span class="array">]</span></tt> 
(the &ldquo;Times&rdquo; column being intended to hold the times of decanting and sampling). 
These column headings are rendered in the font <tt>HeaderFont</tt> at size <tt>TastingNotesColumnHeadingsFontSize</tt>. 
The columns have widths proportionate to <tt>TastingNotesColumnRelativeWidths</tt>, an array of the same length as <tt>TastingNotesColumnHeadings</tt>.
<tt>TastingNotesColumnStrokeCode</tt> formats and <tt><span class="operator">stroke</span></tt>s the lines that separate the columns.</p>
<p>The elements of <tt>TitlesTastingNotes</tt> are shown at a size not exceeding <tt>TastingNotesTitlesFontSizeMax</tt>, and the elements of <tt>SubtitlesTastingNotes</tt> are shown at <tt><small>TastingNotesSubtitleFontSizeProportionTitles</small></tt> times the size of the <tt>TitlesTastingNotes</tt>. 
The vertical separation between the <tt>CirclearraysTastingNotes</tt> and <tt>TitlesTastingNotes</tt>, 
and between the <tt>TitlesTastingNotes</tt> and <tt>SubtitlesTastingNotes</tt>, is <tt>TastingNotesLineGap</tt>.</p>
<pre style="clear: left;  float: left;  font-size: small;  margin-right: 3px;"><span class="nametype">/TastingNotesStarsNameColsRowsArrangement</span>
<span class="array">[</span>
	<span class="stringtype">(JDAW)</span> 5 1 <span class="nametype">/Alternating</span>
	<span class="stringtype">(DRT)</span> 5 1 <span class="nametype">/Upright</span>
<span class="array">]</span> <span class="operator">def</span></pre>
<div style="clear: left;  float: left; margin: 0 6px 4px 0; border-collapse: collapse;  padding-left: 3px; margin-left: 3px; border-left: 1px solid #009900;">
<div style="width: 114px;"><tt><span class="nametype">/Alternating</span></tt><br><img height="24" width="114" alt="TastingNotesStarsNameColsRowsArrangement, /Alternating" src="TastingNotesStarsNameColsRowsArrangement_Alternating.gif"></div>
<div style="width: 114px;  margin-top: 6px;"><tt><span class="nametype">/Sideways</span></tt><br><img height="24" width="114" alt="TastingNotesStarsNameColsRowsArrangement, /Sideways" src="TastingNotesStarsNameColsRowsArrangement_Sideways.gif"></div>
<div style="width: 114px;  margin-top: 6px;"><tt><span class="nametype">/Upright</span></tt><br><img height="24" width="114" alt="TastingNotesStarsNameColsRowsArrangement, /Upright" src="TastingNotesStarsNameColsRowsArrangement_Upright.gif"></div>
</div>
<p id="tasting_note_pages_stars"><a href="#tasting_note_pages_stars">&loz;</a>&nbsp;Optionally, there can be a row of stars: circle to score. 
This can nudge those not prone to scoring into doing so. 
But different people use different scoring systems, so the parameter <tt style="font-size: small;">TastingNotesStarsNameColsRowsArrangement</tt> determines things by name.</p>
<p>This is an array of length a multiple of 4. 
The first of each set of four is the text of the name of the person to whom this applies (before comparing the code removes non-text). 
The second is a number of columns; the third a number of rows. 
The fourth of each set of four is <tt><span class="nametype">/Alternating</span></tt> or <tt><span class="nametype">/Sideways</span></tt> or <tt><span class="nametype">/Upright</span></tt>.</p>

<p>There is also the decorative boolean <tt>TastingNotesCirclesBehind</tt>, which repeats the elements from the glasses pages, faded by a factor of either <tt><small>TastingNotesCirclesBehindFadingFactorIfAnyGrey</small></tt> or <tt><small>TastingNotesCirclesBehindFadingFactorIfAllBlack</small></tt>, according to whether <tt>ColourSchemeTitles</tt> is ever <tt><span class="nametype">/MidGrey</span></tt>. 
By default <tt>TastingNotesCirclesBehind</tt> is <tt><span class="operator">true</span></tt> if distilling with Distiller, <tt><span class="operator">false</span></tt> otherwise (because of an <a href="https://groups.google.com/forum/#!topic/comp.lang.postscript/NJLAfvN_jwU">awkward technical interaction between Mac Preview and GhostScript</a>). 
The circles are in a straight line, the <i>x</i> position at the top being <tt>TastingNotesCirclesBehindTopX</tt> (<tt>0</tt>&nbsp;&rArr;&nbsp;left, <tt>1</tt>&nbsp;&rArr;&nbsp;right), and at the bottom is <tt>TastingNotesCirclesBehindBottomX</tt>. 
The complication of the default values causes, over multiple TN pages, some variation to the visual effect. 
The boolean <tt>TastingNotesCirclesBehindFitAndCentreInRow</tt> controls whether the circles fit between the horizontal lines made by the <tt>Circlearrays</tt> (<tt><span class="operator">true</span></tt>), or whether they are as large as possible (<tt><span class="operator">false</span></tt>).</p>
<p>There has been <a href="http://www.theportforum.com/viewtopic.php?t=175&amp;start=356">discussion</a> of printing A6 booklets to hold the tasting-note pages, one wine per page. 
To aid this it is possible to replace the names with page numbers via <tt>TastingNotesReplaceNameWithPageNum</tt>, the page-number string being defined in <tt>TastingNotesPageNumCompoundString</tt>, and being shown in a font size reduced by a factor of <tt>TastingNotesPageNumFontSizeFactor</tt>.</p>

<div style="clear: right;  float: right; margin: 2px; border-collapse: collapse;">
<div class="BorderGraphic"><img width="392" height="273" src="sidebysideglassestastingnotes_right.png" alt="Side-by-side, right-Handed"></div>
<div class="BorderGraphic"><img width="392" height="273" src="sidebysideglassestastingnotes_left.png" alt="Side-by-side, left-Handed"></div>
</div>
<h3 id="sidebysideglassestastingnotes"><a href="#sidebysideglassestastingnotes">&bull;</a>&nbsp;Side-by-side Glasses and TastingNotes</h3>
<p>&loz; If having a mini tasting of only three wines, one might wish to print everything on one sheet. 
For right handers the three glasses would be on the left of the tasting-notes; for lefties, glasses to the right&mdash;as in the images on the right. 
This small-tasting layout is enabled by setting the boolean constant <tt>SideBySideGlassesTastingNotes</tt> to <tt><span class="operator">true</span></tt>. 
Between the two sides of the paper is a gutter, an internal margin, of size <tt><small>SideBySideGlassesTastingNotesWidthGutter</small></tt>; 
the proportion of the page occupied by the glasses (from the edge of the paper to the middle of the gutter) being <tt><small>SideBySideGlassesTastingNotesProportionPageGlasses</small></tt>. 
The people are right-handed unless present in the array <tt>LeftHanders</tt>.</p>

<p>When <tt>SideBySideGlassesTastingNotes</tt> is <tt><span class="operator">true</span></tt> several of the tasting-note parameters are ignored, action being determined by the glasses equivalent. 
Ignored parameters include 
<tt><a href="#tasting_note_pages">TastingNotesPaperType</a></tt> and <tt><a href="#tasting_note_pages">TastingNotesOrientation</a></tt>;
<tt><a href="#page_order">PageOrderingTastingNotePages</a></tt>; and 
<tt><a href="#page_mirroring">MirrorPagesTastingNotePages</a></tt>.</p>
 
<div class="BorderGraphic" style="clear: both;  float: left;  clear: left;  margin: 0 6px 4px 0;"><a href="placenames.pdf"><img width="351" height="248" src="placenames.png" alt="Example of a place-name sheet"></a></div>
<h3 id="placenames"><a href="#placenames">&bull;</a>&nbsp;Place Names</h3>
<p>&loz; At a large formal tasting it is appropriate to label each person&rsquo;s place-setting, so everybody knows who everybody else is, even late in the tasting. 
Pages to facilitate this are produced using the boolean <tt>PlaceNames</tt> parameter.</p>
<p>The pages are formatted to match the <tt>Titles</tt>: example on the left.</p>
<p>There can be multiple copies of the place names, with different names, so <tt>NamesPlaceNames</tt> is an array of arrays of names, by default containing just one sub-array, <tt>Names</tt>. 
Why the multiple sets of names. 
Have one set with the names of the people, over&mdash;so hiding&mdash;the set with names of foods. 
When the food is about to arrive, switch them, so that waiters and waitresses see which plates go where. 
That done, switch back. 
This might be achieved with parameters resembling those on the left:</p>
<pre style="clear: left;  float: left;  font-size: small;  margin: 0 6px 4px 0;"><span class="nametype">/Names</span> <span class="array">[</span> <span class="stringtype">(Alex)</span> <span class="stringtype">(Ben)</span> <span class="stringtype">(Chris)</span> <span class="stringtype">(Derek)</span> <span class="array">]</span> <span class="operator">def</span>
<span class="nametype">/NamesPlaceNames</span> <span class="array">[</span>
	Names  <span class="comment">% People</span>
	<span class="array">[</span>
		<span class="stringtype">(Steak &amp; kidney pie)</span>  <span class="comment">% Alex</span>
		<span class="stringtype">(Filet, medium-rare)</span>  <span class="comment">% Ben</span>
		<span class="stringtype">(Roast beef, lots)</span>  <span class="comment">% Chris</span>
		<span class="stringtype">(Low-salt diet salad)</span>  <span class="comment">% Derek</span>
	<span class="array">]</span>  <span class="comment">% Foods, and food-free foods</span>
<span class="array">]</span> <span class="operator">def</span></pre>
<p>There is also the parameter <tt>PlaceNamesShowNameAsFooter</tt>, an array of booleans the same length as <tt>NamesPlaceNames</tt>, controlling whether the relevant element of <tt>Names</tt> is to be shown as a footer. 
If the big writing says &ldquo;Low-salt diet salad&rdquo;, it can simplify set-up to have a very small &ldquo;Derek&rdquo; written on the page.</p>
<p>Pages require three folds. 
First, fold in half; then fold and press hard along the faint dashed lines, thereby preventing the corners curling. 
The side with the small-writing header and footer should face the named person; the side without should face away. 
Whilst these are being rendered <tt>TypeOfPagesBeingRendered</tt> is <tt><span class="nametype">/PlaceName</span></tt>, and the variable <tt>PlaceNameSetNum</tt> is the number of the item of <tt>NamesPlaceNames</tt>.</p>
<p>These place-name pages are set on pages of size <tt>PlaceNamesPaperType</tt> (defaulting to <tt>TastingNotesPaperType</tt>), and orientation <tt>PlaceNamesOrientation</tt> (default <tt><span class="nametype">/Landscape</span></tt>). 
The lines marking the anti-curling folds are a distance <tt>PlaceNamesFirstAndThirdFoldsFromEdge</tt> away from the top and bottom edges, defaulting to <tt>36</tt>&nbsp;= &frac12;&Prime;&nbsp;= 12.7mm, which should be changed to <tt>0</tt> if printing to stiff card. 
The <tt>Names</tt> are set in font <tt>PlaceNamesFont</tt> (defaulting to <tt>NamesFont</tt>, though sometimes <tt>TitlesFont</tt> would be more appropriate), at the largest size that fits subject to an upper bound of <tt>PlaceNamesMaxFontSizeAbsolute</tt> (defaulting to <tt>192</tt>). 
The colour scheme used is <tt>ColourSchemePlaceNames</tt>, this functioning in the same manner as <tt><a href="#colourscheme">ColourSchemeTitles</a></tt>. 
Because these names are usually larger than the <tt>Titles</tt>, various details such as line-widths are set larger by a factor of <tt>PlaceNamesDetailsScalingFactor</tt>; 
but, messily, this parameter is used partly in the code, and partly in the default values of other parameters.</p>
<p>Caution: if used with <tt><a href="#filltexts">FillTitles</a></tt> distillation is excruciatingly slow. 
Distillation over the web will almost certainly time out: use local conversion.</p>

<div class="BorderGraphic" style="width: 351px;  clear: left;  float: left;  margin-right: 12px;"><a href="http://www.jdawiseman.com/2014/20141021_ramos_pinto.pdf#PrePour_13"><img width="351" height="248" src="prepour.png" alt="A pre-pour sheet" title="From a Ramos Pinto vertical on 21 October 2014"></a>
<p style="margin: 1px 12px 3px 0px;  font-size: x-small;">A pre-pour page from a <a href="http://www.theportforum.com/viewtopic.php?t=8971&amp;view=unread#unread">Ramos Pinto vertical on 21 October 2014</a>. 
The grey lines are the top-left of the &ldquo;RP&rdquo; <tt><a href="#BackgroundTextsGlasses">BackgroundTextsGlassesTexts</a></tt>.</p></div>
<h3 id="prepour"><a href="#prepour">&bull;</a>&nbsp;Pre-Pour Sheets</h3>
<p>&loz; Tastings arranged on <a href="http://www.theportforum.com/">ThePortForum</a> are for a maximum of fourteen people, in order to give a 5cl portion to each person 
(75cl bottle, less the angels&rsquo; share and less a little loss during decanting leaves only an edge more than 14&times;5cl = 70cl). 
At a tasting attended by eight people, decanters can circulate and people help themselves. 
But when there are fourteen people and so only 5cl each, portions need to be pre-poured. 
This could be a source of confusion: &ldquo;What did you pour into these fourteen glasses?&rdquo;, &ldquo;Err, I think&hellip;&rdquo;. 
Instead glasses are arranged on or close to a page that labels them. 
Then the pourer knows what to pour; and those moving the glasses to the table know what has been poured.</p>
<p>The number of copies of these pre-pour sheets is <tt>PrePourNumCopies</tt>, the default being <tt>1</tt> if the length of <tt>Names</tt> is &ge;13, otherwise <tt>0</tt>. 
In an awkward working space <tt><span class="nametype">/PrePourNumCopies</span>&nbsp;2&nbsp;<span class="operator">def</span></tt> might be useful.</p>
<p>The ordering of the loops is controlled by <tt>PrePourCollate</tt>: if <tt><span class="operator">true</span></tt> then <tt>PrePourNumCopies</tt> is outside <tt>SheetNum</tt> and <tt>WithinPage</tt>/<tt>WithinTitles</tt>; if <tt>false</tt> then <tt>PrePourNumCopies</tt> is inside. 
In a typical vertical tastings, the oldest wines come first in the list, so as to be top-left of the sheet. 
But decanting is in the reverse order, youngest to oldest, so it is convenient to reverse the order of the pre-pour sheets. 
This is controlled by <tt>PrePourReverseOrder</tt>, which defaults to <tt><span class="operator">true</span></tt>.
There are also obvious parameters <tt>PrePourPaperType</tt> and <tt>PrePourOrientation</tt>.</p>
<p>If <tt><a href="#rotation">RotationTitlesAboveBelowOverCirclearray</a></tt>&nbsp;&ne;&nbsp;<tt>0</tt>, then small arrows appear on the pre-pour sheets indicating the correct orientation.</p>

<div class="BorderGraphic" style="width: 451px;  clear: right;  float: right;  margin: 4px;"><a href="http://www.jdawiseman.com/2012/20121113_graham.pdf" title="Placemats of the &lsquo;Smattering of Graham and Malvedos&rsquo; tasting, 13 November 2012."><img width="451" height="210" src="prepour_bywithintitles.png" alt="Example of a tasting in which over-lapping pages caused problems with the pre-pour sheets"></a><p style="margin: 1px 0px 3px 12px;  font-size: x-small;">This was constructed from two sheets of A3 card, both of which included the &rsquo;63 and &rsquo;83. 
The right sheet was guillotined (shown green), overlapped on the left, and fixed with double-sided sticky tape. 
The double-presence of the &rsquo;63 and &rsquo;83 caused them to have two pre-pour sheets, a problem later fixed by <tt><a href="#prepour">PrePourRemoveDuplicatesByWithinTitles</a></tt>.  
Also observe use of <tt><a href="#headers_footers">HeaderFooterCenterX</a></tt>.</p></div>

<p>For some layouts, it may be desirable for a specific bottle to appear on more than one glasses sheet (e.g. when using overlapping sheets). 
The consequent duplication of pre-pour sheets is removed by <tt>PrePourRemoveDuplicatesByWithinTitles</tt> being <tt><span class="operator">true</span></tt>, its default value. 
The guillotine-and-overlap trick also messes with the order of the pre-pour sheets, sometimes fixable with <tt>PrePourSortByWithinTitles</tt>.</p>

<p>To make pre-pour sheets for wines not appearing on a glasses sheet, see <tt><a href="#numcopies">GlassesNumCopies</a></tt>.</p>

<h3 id="voterecorder"><a href="#voterecorder">&bull;</a>&nbsp;Points: The Vote Recorder</h3>
<p>&loz; At the end of a tasting there is typically a vote for the <b>W</b>ine <b>O</b>f <b>T</b>he <b>N</b>ight (WOTN), and for large tastings there might also be a vote after each flight or page. 
The vote is not usually secret, people being asked to declare 1<small><sup>st</sup></small>, 2<small><sup>nd</sup></small>, and 3<small><sup>rd</sup></small> places (scoring 3, 2, 1). 
To assist the &lsquo;returning officer&rsquo; there is paper on which votes can be recorded. 
For WOTN it is <b>the points</b> that should be recorded, <b>rather than the ranks</b>, as doing so simplifies the addition of the totals. 
(There is also benefit in there being agreement as to what is recorded: if you record, but I retain the vote-recorder sheet and enter it into a description of the tasting, it is useful that &ldquo;3&rdquo; be unambiguously <i>first place three points</i>.)</p>
<p style="font-size: smaller;">Indeed, at <a href="http://www.theportforum.com/">ThePortForum.com</a> tastings, the rules are slightly more liberal. 
Each voter has 6 points to assign, which may be assigned in multiples of a half, subject to no one Port receiving more than three. 
So the 61 permitted scoring patterns are <span style="font-size: smaller;"><span title="#Ports=2">3:3</span>, <span title="#Ports&asymp;2.323">3:2&frac12;:&frac12;</span>, <span title="#Ports&asymp;2.571">3:2:1</span>, <span title="#Ports&asymp;2.667">3:2:&frac12;:&frac12;</span>, <span title="#Ports&asymp;2.667">3:1&frac12;:1&frac12;</span>, <span title="#Ports&asymp;2.667">2&frac12;:2&frac12;:1</span>, <span title="#Ports&asymp;2.769">2&frac12;:2&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=2.88">3:1&frac12;:1:&frac12;</span>, <span title="#Ports=2.88">2&frac12;:2:1&frac12;</span>, <span title="#Ports=3">3:1&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=3">3:1:1:1</span>, <span title="#Ports=3">2:2:2</span>, <span title="#Ports&asymp;3.13">3:1:1:&frac12;:&frac12;</span>, <span title="#Ports&asymp;3.13">2&frac12;:2:1:&frac12;</span>, <span title="#Ports&asymp;3.273">3:1:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;3.273">2&frac12;:2:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;3.273">2&frac12;:1&frac12;:1&frac12;:&frac12;</span>, <span title="#Ports&asymp;3.429">3:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;3.429">2&frac12;:1&frac12;:1:1</span>, <span title="#Ports&asymp;3.429">2:2:1&frac12;:&frac12;</span>, <span title="#Ports=3.6">2&frac12;:1&frac12;:1:&frac12;:&frac12;</span>, <span title="#Ports=3.6">2:2:1:1</span>, <span title="#Ports&asymp;3.789">2&frac12;:1&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;3.789">2&frac12;:1:1:1:&frac12;</span>, <span title="#Ports&asymp;3.789">2:2:1:&frac12;:&frac12;</span>, <span title="#Ports&asymp;3.789">2:1&frac12;:1&frac12;:1</span>, <span title="#Ports=4">2&frac12;:1:1:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=4">2:2:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=4">2:1&frac12;:1&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=4">1&frac12;:1&frac12;:1&frac12;:1&frac12;</span>, <span title="#Ports=4">1&frac12;:1&frac12;:1&frac12;:1&frac12;</span>, <span title="#Ports&asymp;4.235">2&frac12;:1:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;4.235">2:1&frac12;:1:1:&frac12;</span>, <span title="#Ports=4.5">2&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=4.5">2:1&frac12;:1:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=4.5">2:1:1:1:1</span>, <span title="#Ports=4.5">1&frac12;:1&frac12;:1&frac12;:1:&frac12;</span>, <span title="#Ports=4.5">1&frac12;:1&frac12;:1&frac12;:1:&frac12;</span>, <span title="#Ports=4.8">2:1&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=4.8">2:1:1:1:&frac12;:&frac12;</span>, <span title="#Ports=4.8">1&frac12;:1&frac12;:1&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=4.8">1&frac12;:1&frac12;:1&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=4.8">1&frac12;:1&frac12;:1:1:1</span>, <span title="#Ports&asymp;5.143">2:1:1:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;5.143">1&frac12;:1&frac12;:1:1:&frac12;:&frac12;</span>, <span title="#Ports&asymp;5.538">2:1:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;5.538">1&frac12;:1&frac12;:1:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;5.538">1&frac12;:1:1:1:1:&frac12;</span>, <span title="#Ports=6">2:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=6">1&frac12;:1&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=6">1&frac12;:1:1:1:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=6">1:1:1:1:1:1</span>, <span title="#Ports&asymp;6.545">1&frac12;:1:1:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;6.545">1:1:1:1:1:&frac12;:&frac12;</span>, <span title="#Ports=7.2">1&frac12;:1:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=7.2">1:1:1:1:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=8">1&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=8">1:1:1:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=9">1:1:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports&asymp;10.286">1:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>, <span title="#Ports=12">&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;:&frac12;</span>.</span></p>
<p>Vote recorder sheets can also be used to hold, in a blind tasting, guesstimates of which is what.</p>
<p>These sheets are enabled by setting <tt>VoteRecorders</tt> to <tt><span class="operator">true</span></tt>. 
There are then conceptually two levels of loops. Pages are specified, except the question in the top text. Then each of these pages can be re-used with multiple top texts.</p>
<p>The vote-recorder sheet contains the wines within 
<tt>GlassesClusteredOnVoteRecorders</tt>, which is a triple-depth array, 
so one deeper than <tt><a href="#glassesonsheets_glassesontastingnotepages">GlassesOnTastingNotePages</a></tt>. 
The outermost array is one per vote-recorder page: voting on separate days, with different people or wines, or different total-column-row flags, should be recorded on separate sheets. 
Within this are &lsquo;clusters&rsquo;, intended to align with tasting-note pages. 
Within this are integers pointing to wines. 
The default value is empty if <tt><a href="#glassesonsheets_glassesontastingnotepages">GlassesOnTastingNotePages</a></tt> 
is empty, otherwise <tt><span class="array">[</span><a href="#glassesonsheets_glassesontastingnotepages">GlassesOnTastingNotePages</a><span class="array">]</span></tt>, 
so the cluster divisions (some 25% grey backgrounding) on the vote recorder are page divisions between the tasting-note pages.</p>

<div style="clear: both;  float: right; margin: 2px; border-collapse: collapse;">
<span class="BorderGraphic"><img width="240" height="156" src="voterecordercrossedbox.png" alt="Example of VoteRecorderCrossedBox."></span>
</div>
<p>Of the same length as <tt>GlassesClusteredOnVoteRecorders</tt> is <tt>VoteRecorderTopTexts</tt>, a double-depth array. 
The inner arrays hold the one/multiple top-texts to be used with each item of <tt>GlassesClusteredOnVoteRecorders</tt>. 
There are also arrays of booleans <tt>VoteRecorderShowTotalRow</tt> and <tt>VoteRecorderShowTotalCol</tt>, which specify whether there is to be a total column or row. 
Generally a total column is always wanted; typically a total row is wanted only for blind-tasting &ldquo;What is it?&rdquo; top-texts. 
The <tt><span class="stringtype">(Total)</span></tt> strings are in <tt>VoteRecorderTotalColTitle</tt> and <tt>VoteRecorderTotalRowTitle</tt>: there might be changes for <tt>Kern</tt>ning or different languages. 
Our tastings sometimes have a fictional &lsquo;monkey&rsquo;, who has a pre-determined fixed guess for all the Ports (often as not, Dow 1970): that extra column is controlled by the boolean <tt>VoteRecorderMonkeyWhenShowTotalRow</tt> and the compound string <tt>VoteRecorderMonkeyName</tt>. 
For such blind tastings, typically the person who brought a bottle should not guess  &ldquo;What is it?&rdquo;. 
Rectangles can be crossed out by setting <tt>VoteRecorderCrossedBox</tt> to code evaluating to a boolean, that code typically referring to <tt>WithinTitles</tt> and <tt>NameNum</tt>.</p>
<p><tt>VoteRecorderNamesOrientation</tt> controls the orientation of the <tt>NamesVoteRecorder</tt>, with allowed values <tt><span class="nametype">/Horizontal</span></tt>, <tt><span class="nametype">/Vertical</span></tt>, or the default value of <tt><span class="nametype">/Either</span></tt>.</p>
<p>Also &exist; obvious parameters <tt>VoteRecorderPaperType</tt> and <tt>VoteRecorderOrientation</tt>; and <tt>VoteRecorderTitlesFontSizeMax</tt> and <tt><small>VoteRecorderSubtitleFontSizeProportionTitles</small></tt> (a positive number or <tt><span class="nametype">/Automatic</span></tt>).</p>

<h3 id="decantingnotes"><a href="#decantingnotes">&bull;</a>&nbsp;Decanting Notes</h3>
<p>&loz; Those decanting should record the time each bottle is decanted, as well as the condition of the cork and perhaps the qualities of the sediment. 
Pages to do same are controlled by <tt>GlassesClusteredOnDecantingNotes</tt>, which has the same structure as <tt><a href="#voterecorder">GlassesClusteredOnVoteRecorders</a></tt>. 
There are <tt>DecantingNotesNumCopies</tt> copies of each page specified by <tt>GlassesClusteredOnDecantingNotes</tt>. 
Each page is headed <tt>DecantingNotesTopText</tt>, the columns being headed <tt>DecantingNotesColumnHeadingTimes</tt> and <tt>DecantingNotesColumnHeadingNotes</tt>. 
Other parameters specify page size and orientation, name the page, the columns, and <tt><small>DecantingNotesSubtitleFontSizeProportionTitles</small></tt> (a positive number or <tt><span class="nametype">/Automatic</span></tt>).</p>
<p>Also &exist; obvious parameters <tt>DecantingNotesPaperType</tt> and <tt>DecantingNotesOrientation</tt>, and <tt>DecantingNotesTitlesFontSizeMax</tt>.</p>

<h3 id="accounts"><a href="#accounts">&bull;</a>&nbsp;The Accounts</h3>
<p style="text-align: center;"><img width="825" height="135" src="accounts.png" alt="Example of top of Accounts page."></p>
<p>&loz; Ideally, tawdry financial matters will have been handled in advance, in a spreadsheet, with payments having been prompt and efficient. Ideally. 
But sometimes matters need to be settled after the food bill has arrived, late in the evening after much drinking. 
To help organise this there can be an accounts page, activated by setting <tt>AccountsNumCopies</tt> to more than zero, which happens by default if <tt>Names</tt> is of length &ge;&nbsp;8.
Columns are organised into groups, with titles for the groups and for the individual columns. 
<tt>AccountsColumnGroupHeadings</tt> contains the groups&rsquo; headings. 
<tt>AccountsSubColumnHeadings</tt> is of the same length as <tt>AccountsColumnGroupHeadings</tt>, but <tt>AccountsSubColumnHeadings</tt> contains arrays of the sub-columns&rsquo; headings. 
The relative widths of the sub-columns are in <tt>AccountsColumnRelativeWidths</tt>, the length of which is the sum of the lengths of <tt>AccountsSubColumnHeadings</tt>&rsquo; elements. 
There is one row per <tt>NamesAccounts</tt> (by default equalling <tt>Names</tt>), and a few extra rows as in <tt>AccountsExtraRows</tt>. 
There are also the obvious parameters <tt>AccountsTopText</tt>, <tt>AccountsColumnHeadingsFontSize</tt>, <tt>AccountsPaperType</tt>, and <tt>AccountsOrientation</tt>. 
(Also see the discussion about the <a href="http://www.theportforum.com/viewtopic.php?t=175&amp;start=1051">request for an accounts page</a>.)</p>

<div style="clear: right;  float: right; margin: 2px; border-collapse: collapse;">
<span class="BorderGraphic"><a href="http://www.jdawiseman.com/2017/20170322_blind.pdf#NeckTags_1"><img width="251" height="391" src="NeckTag.png" title="Neck tag for the author&rsquo;s contribution to a blind tasting on Wednesday 22nd March 2017." alt="Neck tag example"></a></span>
</div>
<h3 id="NeckTags"><a href="#NeckTags">&bull;</a>&nbsp;Neck Tags</h3>
<p>There are several way to label bottles. 
<a href="#decanterlabels">Decanter labels</a> could be made&mdash;but that entails some advance faffing with glue and string. 
<a href="#stickylabels">Sticky labels</a> could be printed&mdash;if whoever is doing the printing has the required labels. 
Neck tags are the easiest to prepare, though too small for decanters.</p>
<p>Neck tags are enabled by <tt><span class="nametype">/NeckTagsNumCopies</span> 1 <span class="operator">def</span></tt>. 
There are then lots of fiddly parameters, which should generally be left at their default values. 
<tt>NeckTagsMinWidth</tt>, <tt>NeckTagsMaxWidth</tt>, <tt>NeckTagsMinHeight</tt>, and <tt>NeckTagsMaxHeight</tt> constrain the size of each tag. 
The circle to be cut is of radius <tt>NeckTagsHoleRadius</tt>, defaulting to 15mm radius&nbsp;&rArr;&nbsp;30mm diameter; and the width of the dashed line is <tt>NeckTagsHoleLineWidth</tt> which defaults to 0.12pt = 1 pixel on a 600 d.p.i. printer. 
From the top of that hole to the top of the whole tag is <tt>NeckTagsSpaceAboveHole</tt>&nbsp;pt; 
between hole and top of the Title/Abovetitle/etc is at least <tt>NeckTagsSpaceAboveTitlesEtc</tt>&nbsp;pt; and 
between bottom of the Title/Belowtitle/etc and the inside of the bordering text (an element of <tt>CirclearraysNeckTags</tt>) is at least <tt>NeckTagsSpaceBelowTitlesEtc</tt>&nbsp;pt.</p>
<p>If there are <a href="#BackgroundTextsGlasses">BackgroundTextsGlasses</a> then whether those background texts appear in the neck tags is controlled by <tt>NeckTagsShowBackgroundTexts</tt>. 
Likewise for <a href="#outlinetitles">OutlineTitles</a>, by <tt>NeckTagsShowOutlineTitles</tt>;  
and for <a href="#crosshatching">CrossHatchingInside</a>, by <tt>NeckTagsShowCrossHatchingInside</tt>. 
The tags are on paper <tt>NeckTagsPaperType</tt>.</p>

<div style="clear: left;  float: left; margin: 2px; border-collapse: collapse;">
<span class="BorderGraphic"><a href="http://www.jdawiseman.com/2015/20151125_1985s.pdf"><img width="366" height="532" src="corkdisplay.png" alt="Example of a cork-display page."></a></span>
</div>
<h3 id="corkdisplay"><a href="#corkdisplay">&bull;</a>&nbsp;Cork Display</h3>
<p>Bottles having been decanted, corks should be put on display, for which pages are activated by <tt><span class="nametype">/CorkDisplayNumCopies</span> 1 <span class="operator">def</span></tt>. 
There are <tt>CorkDisplayNumCopies</tt> of each. 
Each rectangle is at least <tt>CorkDisplayMinWidth</tt> wide, and at least <tt>CorkDisplayMinHeight</tt> high; and the corks shown are in <tt>GlassesClusteredOnCorkDisplay</tt>, a triple-depth array resembling <tt><a href="#voterecorder">GlassesClusteredOnVoteRecorders</a></tt>. 
Pages are titled with <tt>CorkDisplayTopText</tt>, defaulting to &ldquo;The Corks&rdquo;. 
The paper type is <tt>CorkDisplayPaperType</tt>; the orientation being chosen automatically; and within each page the nesting order is determined by <tt><a href="#PermittedPackingStyles_flags">PackingNestingColumnMajor</a></tt>.</p>

<div style="clear: right;  float: right; margin: 2px; border-collapse: collapse;">
<span class="BorderGraphic"><a href="http://www.theportforum.com/viewtopic.php?t=168&amp;view=unread#unread" title="Decanters, labelled, at a tasting on 16 March 2007 (since when the standard abbreviation for Cockburn has changed from &lsquo;C&rsquo; to &lsquo;Ck&rsquo;). The font is &lsquo;/Cochin-Bold&rsquo;."><img width="202" height="276" src="DecanterLabels.png" alt="Decanters, labelled, at a tasting on 16 March 2007"></a></span>
</div>
<h3 id="decanterlabels"><a href="#decanterlabels">&bull;</a>&nbsp;Decanter labels</h3>
<p>The making of decanter labels is controlled by the integer <tt>DecanterLabelsNumCopies</tt>. 
Decanter labels are to fit within a rectangle of size 
<tt>DecanterLabelsMaxSmallerDimension</tt> &times;&nbsp;<tt>DecanterLabelsMaxLargerDimension</tt> 
(which should be the size of business cards less a small margin). 
Orientation, of labels not page, is controlled by <tt>DecanterLabelsOrientation</tt>, with allowed values <tt><span class="nametype">/Landscape</span></tt>, <tt><span class="nametype">/Portrait</span></tt>, and <tt><span class="nametype">/Automatic</span></tt>. 
The Boolean parameter <tt>DecanterLabelsGuillotineMarks</tt> controls whether small cut marks are shown: useful if guillotining. 
The decanter label pages include instructions along the lines of 
&ldquo;Decanter labels: cut; paste to business cards; allow to dry; punch holes; hang on decanters; fill decanters; wait; drink.&rdquo; (this text being in the parameter <tt>DecanterLabelsTopText</tt>).</p>
<p>Having two sets of decanter labels, pasted to both sides of the business cards, sometimes allows those sitting &lsquo;behind&rsquo; the labels a clue as to contents.</p>

<h3 id="stickylabels"><a href="#stickylabels">&bull;</a>&nbsp;Sticky labels</h3>
<p>What is the purpose of the sticky labels that isn&rsquo;t handled by the decanter labels?</p>
<p>At the start of decanting, some bottles will be clearly labelled. 
Others might have little more than a capsule, so after opening, could be entirely unlabelled. 
To prevent confusion there should be, printed onto sheets of sticky labels, bottle labels. 
Alternatively, in an informal tasting, with many more wines than glasses, it can be useful to stick to the foot of the glass (please, never the bowl, always the foot) a very small sticky label identifying the current contents and the glass&rsquo;s owner. 
Specifying these requires describing the sheet of labels</p>
<p>Sticky labels appear if <tt>StickyLabelsNumCopies</tt> exceeds zero, and multiple copies are permitted. 
If the labels are for bottles, there is one per wine. 
If for glasses, there is one per wine per element of <tt>Names</tt>. 
<tt><small>StickyLabelsByNameWhichReplaceCirclearrays</small></tt> controls which; 
if there is one label per wine per person, then the element of <tt>Circlearrays</tt> is replaced with the element of <tt>NamesStickyLabels</tt> (and if this is <tt><span class="operator">def</span></tt>, then <tt>StickyLabelsNamesChangeFaster</tt> controls the ordering of the loops). 
When there are labels by name, it is convenient for cutting if each name&rsquo;s labels are in a convenient rectangular block, enforced by <tt>StickyLabelsAvoidAcrossColumnsOrRows</tt>, and not spilling over page boundaries, enforced by <tt>StickyLabelsAvoidAcrossPages</tt>.</p>
<p>To allow both bottle and glass labels, the sticky labels can be of multiple types, as contained in the array <tt>StickyLabelsTypes</tt>. 
This does very little: the sticky label code is run with <tt>StickyLabelsTypeThis</tt> set to each element of this in turn. 
The other parameters might choose to access the current value of <tt>StickyLabelsTypeThis</tt>. 
With <tt>StickyLabelsTypeThis</tt> equalling <tt>0</tt> the default parameters fit 
<a href="http://www.ryman.co.uk/ryman-address-labels-p8-universal-99x68mm-8-per-a4-sheet-25-sheets">Ryman product 0220013460</a> (containing 25 sheets, or equivalently to the 100-sheet pack 
<a href="http://www.ryman.co.uk/ryman-address-labels-p8-universal-68x99mm-8-per-a4-sheet-100-sheets">0220023460</a>), having on each A4 sheet eight labels, each 99mm&times;68mm. 
With <tt>StickyLabelsTypeThis</tt> equalling <tt>1</tt> the default parameters fit 
<a href="http://www.amazon.co.uk/exec/obidos/ASIN/B000SHP9OC/jdaw">Avery J8651</a>, each sheet of which has 65 labels, each 38.1mm&times;21.2mm. 
Regular users of this software should inform <a href="../../author.html">the author</a> if other sheets of labels should be included in the defaults.</p>

<p>If not using a default, the user must change the specification of the label layout. 
For all the following it is assumed that the page is portrait.</p>
<ul><li><tt>StickyLabelsWithPagePortraitNumRows</tt> is the number of rows whilst holding the page portrait.</li>
<li><tt>StickyLabelsWithPagePortraitNumCols</tt> is the number of columns.</li>
<li><tt>StickyLabelsColumnsChangeFaster</tt> controls the ordering of the row and column loops. If columns change faster then <tt><span class="operator">true</span></tt>; if the rows change faster, <tt><span class="operator">false</span></tt>.</li>
<li><tt><small>StickyLabelsWithPagePortraitGapBetweenRows</small></tt> is the gap between the rows of labels. 
Likewise, <tt><small>StickyLabelsWithPagePortraitGapBetweenCols</small></tt> is the gap between the columns of labels. 
Either of these could be zero; neither may be negative.</li>
<li><tt>StickyLabelsWithPagePortraitGapL</tt> is the margin on the left of the page, that is, the gap between the edge of the page and the left edge of the leftmost column of labels. 
<i>Mutatis mutandis</i>, <tt>StickyLabelsWithPagePortraitGapR</tt>, <tt>StickyLabelsWithPagePortraitGapT</tt>, and <tt>StickyLabelsWithPagePortraitGapB</tt>.</li>
<li><tt>StickyLabelsPaperType</tt> is the paper type of the sticky labels, accepting values such as <tt><span class="nametype">/A4</span></tt> or <tt><span class="nametype">/USL</span></tt>, and defaulting to <tt><span class="nametype">/A4</span></tt>.</li>
<li>Printing is not to the edge of the labels: a little spare space should left on the inside of the edges of the label, 
this being specified by <tt>StickyLabelsPaddingWithPagePortraitTB</tt> (top and bottom) and <tt>StickyLabelsPaddingWithPagePortraitRL</tt> (right and left).</li></ul>

<p>Then <tt>StickyLabelsOrientation</tt> is the desired orientation of the labels. 
That is not necessarily the same as the orientation of the page: if, with the page held portrait, labels are wider than they are high, it will be the opposite. 
Allowed values are <tt><span class="nametype">/Landscape</span></tt>, <tt><span class="nametype">/Portrait</span></tt>, and <tt><span class="nametype">/Automatic</span></tt>. 
If <tt><span class="nametype">/Automatic</span></tt> then the orientation being chosen automatically, the code choosing <tt><span class="nametype">/Landscape</span></tt> unless switching to <tt><span class="nametype">/Portrait</span></tt> would increase the linear size of the text by &ge;&radic;&radic;2.</p>

<p>If one has a part-used sheet of labels, it can help to specify the where on the first page of sticky labels to start, as if <tt>StickyLabelsFirstPageStartPosition</tt> had already been done.</p>

<p>To make sticky labels for wines not appearing on a glasses sheet, see <tt><a href="#numcopies">GlassesNumCopies</a></tt>.</p>
<p>There are also settings <tt>StickyLabelsReverseOrder</tt>, <tt>StickyLabelsRemoveDuplicatesByWithinTitles</tt>, <tt>StickyLabelsSortByWithinTitles</tt>, <tt>StickyLabelsShowBackgroundTexts</tt>, and <tt>StickyLabelsShowCirclearraysInCircle</tt> (as well as in the straight lines top and bottom). 
These are analogous to the similarly-named <tt><a href="#prepour">PrePour</a></tt>&hellip; settings.</p>

<h2 id="complicated_parameters"><a href="#complicated_parameters">&bull;</a>&nbsp;Non-easy parameters</h2>

<div style="clear: both;  float: right; margin: 2px; border-collapse: collapse;">
<span class="BorderGraphic"><img width="149" height="210" src="abcde.png" alt="Stylised glasses sheet, 1 of 2"></span>
<span class="BorderGraphic"><img width="149" height="210" src="fghij.png" alt="Stylised glasses sheet, 2 of 2"></span>
</div>
<h3 id="glassesonsheets_glassesontastingnotepages"><a href="#glassesonsheets_glassesontastingnotepages">&bull;</a>&nbsp;GlassesOnSheets and GlassesOnTastingNotePages</h3>
<p>&loz; Imagine that ten wines are to be tasted&mdash;too many for one sheet of <tt><span class="nametype">/A4</span></tt>
or <tt><span class="nametype">/USL</span></tt>. 
So instead the glasses could be split over two sheets, as shown on the right.</p>
<p>This is done using the parameter <tt>GlassesOnSheets</tt>, which is an array of arrays, 
each of the inner arrays listing the elements of <tt>Titles</tt> etc to be on that page. 
This two-sheet example happens with <tt>GlassesOnSheets</tt> set to <tt><span class="array">[</span>&nbsp; &nbsp;<span class="array">[</span>&nbsp;0&nbsp;1&nbsp;2&nbsp;3&nbsp;4&nbsp;<span class="array">]</span>&nbsp; &nbsp;<span class="array">[</span>&nbsp;5&nbsp;6&nbsp;7&nbsp;8&nbsp;9&nbsp;<span class="array">]</span>&nbsp; &nbsp;<span class="array">]</span></tt>, which is the default with <tt>Titles</tt> of length ten. 
Observe that numbering starts at 0: the first wine (described by the first element of each of <tt>Titles</tt>, <tt>Subitles</tt>, <tt>Circlearrays</tt>, and <tt>FillTexts</tt>) is number <b>0</b>; the tenth glass is therefore number 9.</p>
<p>In the picture the <tt><a href="#waterboxes">WaterBoxes</a></tt> are on the right side of the second page&mdash;as the author is right-handed. 
Participants are right-handed unless in <tt>LeftHanders</tt>, an array of the names of known left-handers. 
Which pages have water counts is controlled by <tt>WaterBoxesShowRight</tt> and <tt>WaterBoxesShowLeft</tt>. 
These parameters are described in the section on <tt><a href="#waterboxes">WaterBoxes</a></tt>.</p>

<p><tt>GlassesOnSheets</tt> has a more general purpose. 
As a putative tasting is being arranged, there are candidate bottles, some of which will appear in the final version. 
Create entries in <tt>Titles</tt>, <tt>Subitles</tt>, <tt>Circlearrays</tt>, and <tt>FillTexts</tt> for all these wines. 
Then, when decisions have been taken, use <tt>GlassesOnSheets</tt> to select from them, and to determine which wines appear in which order on which sheets.</p>
<p>The default value of <tt><span class="nametype">/GlassesOnSheets</span></tt> is complicated. 
Let <i>n</i> = the length of <tt>Titles</tt>. 
Then if <i>n</i>&nbsp;&le;&nbsp;6, <tt>GlassesOnSheets</tt> is 
<tt><span class="array">[</span> <span class="array">[</span>0 1 2 &hellip; <i>n</i>&ndash;1<span class="array">]</span> <span class="array">]</span></tt>, so putting all the glasses on a single page. 
Otherwise there are &lceil;<i>n</i>&nbsp;&divide;&nbsp;6&rceil; pages, 
the glasses being distributed as evenly as possible, so each page holding &le;&nbsp;6. 
By default, <tt>GlassesOnSheets</tt> is the minimum number of pages subject to there being at most <tt>GlassesOnSheetsMaxPerSheet</tt> per page. 
The default value of <tt>GlassesOnSheetsMaxPerSheet</tt> can be 
6 (if <tt>PaperType</tt> is <tt title="Radius &asymp; 130.5pt, so diameter &asymp; 92.1mm &asymp; 3.62&Prime;"><span class="nametype">/A4</span></tt> or 
<tt title="Radius &asymp; 122.6pt, so diameter &asymp; 86.5mm &asymp; 3.41&Prime;"><span class="nametype">/USL</span></tt>) 
or 9 (<tt title="Radius &asymp; 110.3pt, so diameter &asymp; 77.8mm &asymp; 3.06&Prime;"><span class="nametype">/USLegal</span></tt>) or 
14 (<tt title="Radius &asymp; 121.4pt, so diameter &asymp; 85.6mm &asymp; 3.37&Prime;"><span class="nametype">/A3</span></tt> 
or <tt title="Radius = 122pt, so diameter &asymp; 86.1mm &asymp; 3.39&Prime;"><span class="nametype">/USL2</span></tt>).</p>

<p>The parameter <tt>GlassesOnTastingNotePages</tt> works the same way, controlling the tasting-note pages. 
By default it is built analgously to <tt>GlassesOnSheets</tt>, except from <tt>GlassesOnSheetsMaxPerTNSheet</tt>.</p>

<h3 id="type_sizes"><a href="#type_sizes">&bull;</a>&nbsp;Type sizes</h3>
<p id="maxcircletextfontsize"><a href="#maxcircletextfontsize">&loz;</a> How big is the circle text? In points, not bigger than <tt>CircletextMaxFontSizeAbsolute</tt>;
and as a proportion of the circles&rsquo; radius not bigger than <tt>CircletextMaxFontSizeProportionRadius</tt>.
If, in a font size equal to the lesser of these two, a particular item in <tt>Circlearrays</tt> 
is too long to fit at least <tt>CircletextsMinCopies</tt> times, 
then the font size is reduced such that it does. 
If <tt>CircletextsSameFontSizeIfRadiiShrunkToBeSame</tt>, then across all pages compelled to have the same radius (see <tt><a href="#maxradius">ShrinkRadii</a></tt>), the <tt>Circlearrays</tt> are compelled to have the same size. 
If not, the font size of <tt>Circlearrays</tt> can vary within and between pages. 
(Technical note: <tt>CircletextsSameFontSizeIfRadiiShrunkToBeSame</tt> should have the same boolean value over any such set of pages. 
Typically this is most easily achieved by having it depend on <tt>PageOrderingGlasses SheetNum <span class="operator">get</span></tt> or on <tt>ShrinkRadii SheetNum <span class="operator">get</span></tt>, rather than directly on <tt>SheetNum</tt>.)</p>
<p>Imagine that, at the font size chosen in the previous paragraph, some particular item of <tt>Circlearrays</tt> fits 3.999 times, and so would be shown 3&nbsp;times, with white space occupying the &lsquo;0.999&rsquo; remainder. 
Aesthetically it would be better if the font size were tweaked a mite smaller, this item then fitting 4+&epsilon; times and being shown 4&nbsp;times. 
The boolean parameter <tt>CircletextsTweakSize</tt> activates this tweaking. 
And if the boolean <tt>CircletextMaxFontSizeMayBeSlightlyExceeded</tt> is <tt><span class="operator">true</span></tt>, then there can be an initial tweak upwards in size (not exceeding a factor of &radic;&radic;2&nbsp;&asymp;&nbsp;1.189). 
But if the user needs precise control over the font size (but why?), then both should be changed to <tt><span class="operator">false</span></tt>.</p>
<p>The number of copies of the <tt>Circletexts</tt> is bounded above by <tt>CircletextsMaxCopies</tt>; 
when this is invoked the the number of copies that would otherwise appear is on the top of the stack, so <tt>CircletextsMaxCopies</tt> could be code referring to it, 
such code advisedly starting with a &ldquo;<tt><span class="operator">dup</span></tt>&rdquo;.
Relatedly, the minimum separation between the items of the sub-arrays of 
<tt>Circlearrays</tt>, measured in space-widths, is <tt>CircletextsMinNumSpacesBetween</tt>.</p>

<p>The type sizes of <tt>Titles</tt> and <tt>Abovetitles</tt>, <tt>Belowtitles</tt> and <tt>Overtitles</tt> are controlled by a multi-stage process.</p>
<p id="type_sizes_1"><a href="#type_sizes_1">&loz;</a> First, the <tt>Titles</tt> are fitted, and various one-at-a-time constraints applied. These include:</p>
<p>&#9675; <tt>TitleMaxHeightProportionInnerRadius</tt> is the maximum height, measured bottom to top, of the <tt>Titles</tt>, expressed as a proportion of the &lsquo;inner radius&rsquo;, that is, of the radius to the inside of the <tt>Circlearrays</tt>, adjusted by <tt><small>ExclusionAnnulusProportionInnerRadiusTitlesAboveBelow</small></tt>.</p>
<p>&#9675; <tt><small>TitleMinHeightForAbovetitleProportionInnerRadius</small></tt>: constrains the upper bound of the title if the relevant element of <tt>Abovetitles</tt> is non-empty.</p>
<p>&#9675; <tt><small>TitleMinHeightForBelowtitleProportionInnerRadius</small></tt>: constrains the lower bound of the title if the relevant element of <tt>Belowtitles</tt> is non-empty.</p>

<p id="ExclusionAnnulus">For these purposes, &ldquo;the circle&rdquo; is the inside of the <tt>Circlearrays</tt>, adjusted by <tt><small>ExclusionAnnulusProportionInnerRadiusTitlesAboveBelow</small></tt> (for the <tt>Titles</tt>, <tt>Abovetitles</tt> and <tt>Belowtitles</tt>) or by <tt><small>ExclusionAnnulusProportionInnerRadiusOvertitles</small></tt> (for just the <tt>Overtitles</tt>). 
These might behave weirdly if negative or &ge;1, and default to zero which uses all available space.</p>

<p id="type_sizes_2"><a href="#type_sizes_2">&loz;</a> Second, the font sizes of the <tt>Titles</tt> are considered together. 
It would look messy if there were many type sizes, only slightly different. 
If <tt><small>FontSizesTitlesNotSmallerIfTitlesNotLonger</small></tt> <tt><span class="operator">true</span></tt>, then sizes are so constrained. I.e., the font size of &ldquo;Df&rdquo; must be &le; the font size of &ldquo;W&rdquo; which must = that of &ldquo;I&rdquo;. 
Then a constraint is applied to their ratio: for two titles, either they have the same font size, or the <i>larger</i>&divide;<i>smaller</i> ratio of their font sizes &ge;&nbsp;<tt>FontSizesRatioTitlesMin</tt>, which defaults to 2.</p>
<p>Except that one might not wish to apply this constraint over pages in different sessions: it would hardly matter whether yesterday&rsquo;s sheets did or did not precisely match today&rsquo;s. 
So there is an array <tt>FontSizesSetsGlassesPages</tt> of the same length as <tt>GlassesOnSheets</tt>, and pages with matching values in this array are considered together.</p>

<p id="type_sizes_3"><a href="#type_sizes_3">&loz;</a> Third, <tt>Abovetitles</tt>, <tt>Belowtitles</tt> and <tt>Overtitles</tt> are fitted around the <tt>Titles</tt>. 
Then, if needed, these are lowered to the size of the matching element of <tt>Titles</tt>, times <tt>AbovetitleMaxFontSizeProportionTitles</tt>, <tt>BelowtitleMaxFontSizeProportionTitles</tt> or <tt>OvertitleMaxFontSizeProportionTitles</tt>.</p>

<p id="type_sizes_4"><a href="#type_sizes_4">&loz;</a> Fourth, as with the <tt>Titles</tt>, fewer matching font sizes would look better.</p>
<p>&#9675; If <tt><small>FontSizesAboveBelowOverNotSmallerIfTitlesNotLonger</small></tt>, then, in turn and separately for each of <tt>Abovetitles</tt>, <tt>Belowtitles</tt> and <tt>Overtitles</tt>, lengths are constrained according to the lengths of the elements of <tt>Titles</tt>.</p>
<p>&#9675; It is possible to force items to be the shown at the same font size. 
<tt>FontSizesTitlesEquivalences</tt> is an array of the same length as <tt>Titles</tt>. 
If two items of <tt>FontSizesTitlesEquivalences</tt> are <tt><span class="operator">eq</span></tt>ual, then the relevant <tt>Titles</tt> are forced to the size of the smaller. 
Likewise <tt>FontSizesAbovetitlesEquivalences</tt> for the <tt>Abovetitles</tt>, and <tt>FontSizesBelowtitlesEquivalences</tt> for the <tt>Belowtitles</tt>, and <tt>FontSizesOvertitlesEquivalences</tt> for the <tt>Overtitles</tt>. 
(But be careful: <tt>FontSizesTitlesEquivalences</tt> and <tt><small>FontSizesAboveBelowOverNotSmallerIfTitlesNotLonger</small></tt> together can force everything to the same size: if a short title is forced to be the same size as a long title, then every other title longer than the short title would also be forced to the same size.)</p>
<p>&#9675; Then the ratio of <tt>FontSizesRatioAboveBelowOverMin</tt> is used, and over the same <tt>FontSizesSetsGlassesPages</tt> sets of pages.</p>
<p>But should <tt>Abovetitles</tt> be considered with <tt>Overtitles</tt>? If their fonts are very different, perhaps not. 
So there is an array of length three, <tt>FontSizesSetsAboveBelowOver</tt>, the elements of which refer to &lsquo;Above&rsquo;, &lsquo;Below&rsquo; and &lsquo;Over&rsquo;, in that order. 
If the elements of <tt>FontSizesSetsAboveBelowOver</tt> are <tt><span class="operator">eq</span></tt>ual, the arrays are considered jointly. 
Typically, arrays in the same or similar fonts should be considered together; those in very different fonts should not.</p>

<h3 id="BackgroundTextsGlasses"><a href="#BackgroundTextsGlasses">&bull;</a>&nbsp;BackgroundTextsGlasses</h3>
<div style="clear: both;  float: right; margin: 2px; border-collapse: collapse;">
<span style="white-space:nowrap;"><span class="BorderGraphic"><a href="BackgroundTextsGlasses.pdf"><img width="223" height="316" src="BackgroundTextsGlasses_1935a.png" alt="BackgroundTextsGlasses: some 1935s"></a></span> 
<span class="BorderGraphic"><a href="BackgroundTextsGlasses.pdf"><img width="223" height="316" src="BackgroundTextsGlasses_1945a.png" alt="BackgroundTextsGlasses: some 1945s"></a></span> 
<span class="BorderGraphic"><a href="BackgroundTextsGlasses.pdf"><img width="223" height="316" src="BackgroundTextsGlasses_1955a.png" alt="BackgroundTextsGlasses: some 1955s"></a></span></span></div>
<p>In&nbsp;some multi-page tastings, for each page all the wines have something in common. 
A typical example is a multi-horizontal, in which wines from several houses are tasted from two or few vintages. 
As everything on a page has a common feature, perhaps this common feature should be marked, faintly, as in the example on the right 
(in which the <tt><span class="operator">setlinewidth</span></tt> is much wider than the default) .</p>

<p>This is activated by setting <tt>BackgroundTextsGlasses</tt> to <tt><span class="operator">true</span></tt>. 
Then <tt>BackgroundTextsGlassesTexts</tt> is an array of the same length as <tt>GlassesOnSheets</tt>, containing the strings to be shown on glasses pages. 
The strings should be short: one or two characters is recommended, and are shown in font <tt>BackgroundTextsFont</tt>. 
Likewise <tt>BackgroundTextsTNsTexts</tt> is of the same length as <tt>GlassesOnTastingNotePages</tt>.</p>

<p>The text is aligned with <tt>BackgroundTextsAlignmentVertical</tt> (being one of <tt><span class="nametype">/Middle</span></tt>, <tt><span class="nametype">/Bottom</span></tt>, <tt><span class="nametype">/Top</span></tt>) and <tt>BackgroundTextsAlignmentHorizontal</tt> (being one of <tt><span class="nametype">/Centre</span></tt>, <tt><span class="nametype">/Left</span></tt>, <tt><span class="nametype">/Right</span></tt>).</p>
<p>The separate <i>x</i> and <i>y</i> sizes each as large as possible, subject to the following.</p>
<ul>
<li>The ratio of the vertical and horizontal font sizes, <i>y</i>&divide;<i>x</i>, must lie between <tt>BackgroundTextsSquooshMin</tt> and <tt>BackgroundTextsSquooshMax</tt>. 
For non-squooshed text, as recommended in <a href="http://typophile.com/node/82379">this thread on typophile.com</a>, set both to <tt>1</tt>.</li>
<li><tt>BackgroundTextsGlassesSameSizeIfAllOf</tt>, which determines whether the background texts on different pages are compelled to be the same size. 
They are if all the &lsquo;conditions&rsquo; specified are true. Valid conditions are <tt><span class="nametype">/False</span></tt> (always false, so each is fitted separately); <tt><span class="nametype">/OnSheetWithSameNumberGlasses</span></tt> (obvious meaning); <tt><span class="nametype">/OnSheetWithSameRadius</span></tt> (ditto); <tt><span class="nametype">/SamePageOrdering</span></tt> (ditto); <tt><span class="nametype">/SamePaperSize</span></tt> (ditto); <tt><span class="nametype">/TextSameLength</span></tt> (ditto); and <tt><span class="nametype">/RadiiShrunkToBeSame</span></tt> (referring to <tt><a href="#maxradius">ShrinkRadii</a></tt>).</li>
<li>Neither <i>x</i> nor <i>y</i> size may exceed <tt>BackgroundTextsFontSizeMax</tt>, which defaults to large.</li>
<li><tt>BackgroundTextsGlassesVerticalMiddling</tt>, which determines whether the vertical alignment is determined jointly or separately, much like the <a href="obscure_parameters.html#vertical_middling">VerticalMiddling&hellip;</a> parameters.
<tt>BackgroundTextsGlassesVerticalMiddling</tt> must be one of <tt><span class="nametype">/MatchAll</span></tt>, <tt><span class="nametype">/MatchSamePaperSize</span></tt>, or <tt><span class="nametype">/MatchNone</span></tt>.</li>
</ul>

<p>The bounding path of the text is constructed and then <tt>BackgroundTextsGlassesPaintCode</tt> is <tt><span class="operator">exec</span></tt>uted. 
The default <tt><span class="operator">clip</span></tt>s then <tt><span class="operator">stroke</span></tt>s.</p>

<p><tt>BackgroundTexts&hellip;</tt>  looks best with the &lsquo;Squoosh&rsquo; at 1 (so not squooshed), but still touching all four margins. 
This precise fitting can be done by inserting into the compound string some <tt><span class="array">{</span><i>&plusmn;x</i> Kern<span class="array">}</span></tt>. 
The amount of extra kerning required is computed, and <span title="E.g., &ldquo;(with a &quot;{+0.0123456 Kern}&quot; it would fit snugly)&rdquo;.">appears in the output log</span>&mdash;typically the last page of the PDF.</p>

<p>The boolean parameter <tt>BackgroundTextsTastingNotes</tt> also shows these on the tasting-note pages. 
For pre-pour pages, which are naturally associated with a glasses page, the boolean <tt>PrePourShowBackgroundTexts</tt> causes the <tt>BackgroundTextsGlassesTexts</tt> to appear; and likewise <tt>BackgroundTextsDecanterLabels</tt> underneath each decanter label.</p>

<h3 id="GlassesCirclesFadingFactor"><a href="#GlassesCirclesFadingFactor">&bull;</a>&nbsp;But I&rsquo;m not drinking that: <tt>GlassesCirclesFadingFactor</tt> and <tt>GlassesCrossedOut</tt></h3>
<p>Sometimes some people aren&rsquo;t drinking some things. 
Perhaps the men are refraining from the Champagne to save more for their wives (<a href="http://www.theportforum.com/viewtopic.php?p=93797#p93797">e.g.</a>); perhaps some people just don&rsquo;t want some things. 
The placemats should indicate this, so that unwanted glasses are not wastefully filled. 
The parameter <tt>GlassesCirclesFadingFactor</tt> can be code that returns a real &ge;0 and &le;1, in which 0 means entirely faded away and 1 is the black-is-black default. 
E.g., <tt><span class="nametype">/GlassesCirclesFadingFactor</span> <span class="array">{</span><span class="stringtype">(Julian)</span> Names NameNum <span class="operator">get</span> <span class="operator">eq</span>&nbsp; WithinTitles 0 <span class="operator">eq</span>&nbsp; <span class="operator">and</span> <span class="array">{</span>0.125<span class="array">}</span> <span class="array">{</span>1<span class="array">}</span> <span class="operator">ifelse</span><span class="array">}</span> <span class="operator">def</span></tt> fades the first glass (glass <tt>0</tt>) of Julian. 
It is also possible to cross out a glass, with the boolean parameter <tt>GlassesCrossedOut</tt>, which by default is <tt><span class="array">{</span>GlassesCirclesFadingFactor 0.5 <span class="operator">le</span><span class="array">}</span></tt>.</p>

<h3 id="flightseparations"><a href="#flightseparations">&bull;</a>&nbsp;Separating flights within a page</h3>
<div style="clear: both;  float: right; margin: 2px; border-collapse: collapse;">
<div class="BorderGraphic" style="margin-bottom: 4px;"><a href="FlightSeparations.pdf"><img width="398" height="273" src="FlightSeparations_g0.png" alt="Complicated FlightSeparations example, 5 paths" title="[&#13;&nbsp;&nbsp;[ [/Left 0 3 -0.5] [0 3] [/Top 3 0 +0.5] ]&#13;&nbsp;&nbsp;[ [/Left 5 +1.0] [/Clockwise 5] [/Bottom 5 +1.0] ]&#13;&nbsp;&nbsp;[ [/Bottom 3] /Curve [3 6] /Curve [3 1] /Curve [/Top 3] ]&#13;&nbsp;&nbsp;[ [/Top 4] [1 4] [/Widdershins 4] [/Bottom 4] ]&#13;&nbsp;&nbsp;[ /Closed [/Right] [/Bottom] [/Clockwise 7] [/Widdershins 4] [/Clockwise 2] ]&#13;]"></a></div>
<div class="BorderGraphic"><a href="FlightSeparations.pdf"><img width="398" height="272" src="FlightSeparations_g1.png" alt="FlightSeparations example, 1 closed path" title="[&#13;&nbsp;&nbsp;[ /Closed [0 3] [3 1] /Curve [1 4] [4 2] [4 7] /Curve  [4 6] [/Widdershins 6] [6 3] /Curve [3 5] ]&#13;]"></a></div>
</div>

<p>&loz; It is often natural to split a tasting into &lsquo;flights&rsquo; of a few wines. 
This can structure a balance between quietly contemplating the differences between wines, and subsequent sociable discussion. 
The parameters <tt>FlightSeparations</tt> and <tt>FlightSeparationLines</tt> allow the page to be divided into zones. 
However <tt>FlightSeparationLines</tt> is fiddly, and if one wine is added or taken away, will need to be completely reworked.
Hence it is recommended that division into flights be saved until late in the planning.</p>
<p><tt>FlightSeparations</tt> is a boolean: <tt><span class="operator">true</span></tt> to activate the line-drawing code, <tt><span class="operator">false</span></tt> de-activated.
The real work is done by <tt>FlightSeparationLines</tt>, being an array nested four deep. 
<tt>FlightSeparationLines</tt> is of the same length as <tt><a href="#glassesonsheets_glassesontastingnotepages">GlassesOnSheets</a></tt>.
Each item of <tt>FlightSeparationLines</tt> is an array, each of which holds line descriptions, as many as there are lines on that page. 
Each line description is an array, pieces of which can be as follows.</p>
<ul><li>The first, and only the first, item of a line description may be <tt><span class="nametype">/Closed</span></tt>, which specifies that the line is a closed loop.</li>
<li>The typical piece is <tt><span class="array">[</span><i>a</i>&nbsp;<i>b</i><span class="array">]</span></tt>, which specifies that the line runs through the mid-point of the glass positions <i>a</i> and <i>b</i>, the line being perpendicular to the line connecting the centres. 
So if the circles touch then the line segment touches their joint tangent.
Order doesn&rsquo;t matter: <tt><span class="array">[</span><i>a</i>&nbsp;<i>b</i><span class="array">]</span></tt> and <tt><span class="array">[</span><i>b</i>&nbsp;<i>a</i><span class="array">]</span></tt> do the same job. 
The integer <tt><i>a</i></tt> can be replaced with <tt><span class="array">[</span><i>xa</i>&nbsp;<i>ya</i><span class="array">]</span></tt> (making <tt><span class="array">[</span><span class="array">[</span><i>xa</i>&nbsp;<i>ya</i><span class="array">]</span>&nbsp;<i>b</i><span class="array">]</span></tt>), and likewise <tt><i>b</i></tt> with <tt><span class="array">[</span><i>xb</i>&nbsp;<i>yb</i><span class="array">]</span></tt>.</li>
<li>There are other allowed interior pieces, including <tt><span class="array">[</span><span class="nametype">/HorizontalLeftwards</span>&nbsp;&hellip;<span class="array">]</span></tt>.
This is a horizontal line at a <i>y</i> specifed by the &lsquo;&hellip;&rsquo;, which is an average of at least one absolute level, perhaps &plusmn; some real number of radii. 
Absolutes can be <tt><span class="nametype">/Bottom</span></tt> (with obvious meaning); <tt><span class="nametype">/Top</span></tt> (ditto); or an integer, in which case the <i>y</i> is that of the centre of that circle number. 
Reals are handled differently, that number of radii being added to the average (the radius being that of <span class="nametype">/Clockwise</span> or <span class="nametype">/Widdershins</span> arcs). 
So <tt><span class="array">[</span><span class="nametype">/HorizontalLeftwards</span>&nbsp;0&nbsp;3&nbsp;-0.5<span class="array">]</span></tt> is a horizontal line, at a <i>y</i> value of the average of those of circles 0 and 3, minus half a radius. 
This can be thought of as Average[Circle 0&rsquo;s bottom, Circle 3&rsquo;s centre].
If the previous item is an arc, the <tt><span class="nametype">/Horizontal<b>Left</b>wards</span></tt> means that the left-most intersection is chosen. 
Note that the integer <tt>1</tt> and the real <tt>1.0</tt> are therefore very different, the former referring to the centre of circle 1, the latter to an offset of +1.0 radii.
<i>Mutatis mutandis</i>, <tt><span class="nametype"><span class="nametype">/HorizontalLeftwards</span></span></tt> can be replaced with <tt><span class="nametype">/HorizontalRightwards</span></tt>, <tt><span class="nametype">/VerticalDown</span></tt> or <tt><span class="nametype">/VerticalUp</span></tt>.</li>
<li><tt><span class="array">[</span><span class="nametype">/Left</span>&nbsp;&hellip;<span class="array">]</span></tt> is like <tt><span class="array">[</span><span class="nametype">/HorizontalLeftwards</span>&nbsp;&hellip;<span class="array">]</span></tt>, and at the same <i>y</i> value, except that it is certain to touch the left margin. 
Again <i>mutatis mutandis</i>, <tt><span class="array">[</span><span class="nametype">/Right</span>&nbsp;&hellip;<span class="array">]</span></tt>, <tt><span class="array">[</span><span class="nametype">/Top</span>&nbsp;&hellip;<span class="array">]</span></tt>, and <tt><span class="array">[</span><span class="nametype">/Bottom</span>&nbsp;&hellip;<span class="array">]</span></tt>.
<tt><span class="array">[</span><span class="nametype">/Left</span><span class="array">]</span></tt>, with no specification of the <i>y</i> value, reaches the left margin at whatever angle the neighbouring segment causes the line to travel. 
It is not sensible for more than one of these to occur consecutively. 
With obvious variations, <tt><span class="array">[</span><span class="nametype">/Right</span><span class="array">]</span></tt>, <tt><span class="array">[</span><span class="nametype">/Top</span><span class="array">]</span></tt>, and <tt><span class="array">[</span><span class="nametype">/Bottom</span><span class="array">]</span></tt>.
It is easiest to think about these margin specifications as being of two types: if the position is specified, the line is perpendicular to the margin; if unspecified, parallel.</li>
<li><tt><span class="array">[</span><span class="nametype">/Clockwise</span> <i>a</i><span class="array">]</span></tt> draws a part of clockwise circle centered on glass position <i>a</i>; <tt><span class="array">[</span><span class="nametype">/Widdershins</span> <i>a</i><span class="array">]</span></tt> being anti-clockwise. 
(&ldquo;Widdershins&rdquo;? <a href="http://en.wikipedia.org/wiki/Widdershins">Widdershins</a>!) 
There are variants, <tt><span class="array">[</span><span class="nametype">/Clockwise</span> <i>a</i> <i>b</i> <i>c</i><span class="array">]</span></tt> and <tt><span class="array">[</span><span class="nametype">/Widdershins</span> <i>a</i> <i>b</i> <i>c</i><span class="array">]</span></tt>, in which the radius of the arc is half the distance between the centres of circles <i>b</i> and <i>c</i>. 
As above, the integer <tt><i>a</i></tt> can be replaced with <tt><span class="array">[</span><i>xa</i>&nbsp;<i>ya</i><span class="array">]</span></tt>.</li>
<li>Between two pieces the non-array item <tt><span class="nametype">/Curve</span></tt> causes what would have been a straight line to be replaced with a B&eacute;zier curve made with the PostScript command <tt><span class="operator">curveto</span></tt>.</li></ul>

<p>In the <a href="FlightSeparations.pdf">PDF of examples</a> the header shows that page&rsquo;s item of 
<tt>FlightSeparationLines</tt> (i.e., <tt>FlightSeparationLines</tt> is an array one deeper than the header). 
If using <tt>FlightSeparations</tt> it is strongly recommended that these <a href="FlightSeparations.pdf">PDF examples</a> be examined and appropriate parts used as a starting draft. 
The first two pages of this file are shown on the right, the first having many example lines, to the gain of instruction and the loss of aesthetics.</p>

<p>The path can be <tt><span class="operator">stroke</span></tt>d, <tt><span class="operator">clip</span></tt>ped or <tt><span class="operator">fill</span></tt>ed by the code <tt>FlightSeparationPaintCode</tt>, which has a default <tt><span class="operator">stroke</span></tt> that is complicated but elegant. 
Use of <tt><span class="operator">fill</span></tt> is discouraged, as it impedes comparison of colours of the wines. 
If <tt>FlightSeparationPaintSeparately</tt> then <tt>FlightSeparationPaintCode</tt> is invoked after each line, the variable <tt>FlightSeparationLineNum</tt> being set to the appropriate integer &ge;&nbsp;0. 
If not <tt>FlightSeparationPaintSeparately</tt>, then all the lines on the current page are drawn, after which is the single call of <tt>FlightSeparationPaintCode</tt>. 
The former is better if the format is not constant; 
the latter preferred if overlapping or crossing lines are to be double-<tt><span class="operator">stroke</span></tt>d.</p>

<p>Some control over the radius of the arcs is sometimes possible.  
If any circles touch, the radius of the arcs equals that of the circles. 
If no circles touch (probably because of <tt><a href="#maxradius">MaxRadius</a></tt> or <tt><a href="#maxradius">ShrinkRadii</a></tt>) 
then <tt>FlightSeparationArcRadiusControl</tt> controls the radius. 
<tt>FlightSeparationArcRadiusControl</tt> should be both &ge;0 and &le;1; the default being the maximum. 
If it is 0, the radius of the arcs is that of the circles. 
If 1, the radius is the half the distance between the closest circles. 
If between, between.</p>

<p>There is a <a href="http://groups.google.com/forum/#!topic/comp.lang.postscript/amUp28S-JFM">bug in Adobe Distiller</a>, such that if <tt>FlightSeparationPaintSeparately</tt> is <tt><span class="operator">false</span></tt> and there are multiple lines on one page (&hArr;&nbsp;<tt>FlightSeparationLines SheetNum <span class="operator">get</span> <span class="operator">length</span></tt>&nbsp;&ge;&nbsp;2), the apparent ends of some lines are controlled by <tt><span class="operator">setlinejoin</span></tt> rather than <tt><span class="operator">setlinecap</span></tt>. 
It is a small aesthetic imperfection, but an aesthetic imperfection nonetheless. 
The problem can be avoided if no line begins where the previous one ended, achievable by reversing the direction of individual lines, or by re-ordering the set of lines.</p>

<p style="margin-bottom: 0;">The <a href="http://www.theportforum.com/viewtopic.php?t=8612">1997 Horizontal on 16<small><sup>th</sup></small>&nbsp;June 2014</a> had <a href="http://www.theportforum.com/viewtopic.php?p=77355#p77355">complicated usage of <tt>FlightSeparationLines</tt></a>, as can be seen from the following explanatory diagram. 
Some <span style="color: #ff0000;">text</span> nudged to keep it on the page, most obviously that referring to the corners.)</p>
<p title="Placemats used on 16th June 2014, reworked to help explain usage of FlightSeparationLines." style="margin-top: 0;  text-align: center;"><a href="../../2014/20140616_1997s.pdf"><img class="BorderGraphic" height="449" width="829" src="../../2014/20140616_FlightSeparations_explanation.png" alt="Example of complicated usage of FlightSeparationLines."></a></p>

<h3 id="page_order"><a href="#page_order">&bull;</a>&nbsp;Page order</h3>

<p>&loz; The order of the pages is controlled by eight arrays of integers.</p>

<table class="TableParameterSpecification"><tr><th>Array name</th><th>Length</th><th>Default<br>entries</th><th>Default explained</th></tr>
<tr><td><tt>PageOrderingGlasses</tt></td><td>same as <tt>GlassesOnSheets</tt></td><td><tt>1</tt></td>
<td class="Shrunk" rowspan="8">Sorted into order by the algorithm: in the outermost loop, by paper size. 
Within that, for simplicity of table setting, starting with interleaved glasses sheets and tasting-note sheets; 
then the vote-recording page(s) to be placed with the returning officer&rsquo;s tasting-note sheets; then decanting notes, accounts, cork display and pre-pour pages.</td></tr>
<tr><td><tt>PageOrderingTastingNotePages</tt></td><td>same as <tt>GlassesOnTastingNotePages</tt></td><td><tt>1</tt></td></tr>
<tr><td><tt>PageOrderingVoteRecorder</tt></td><td>same as <tt>GlassesClusteredOnVoteRecorders</tt></td><td><tt>1</tt></td></tr>
<tr><td><tt>PageOrderingDecantingNotes</tt></td><td>same as <tt>GlassesClusteredOnDecantingNotes</tt></td><td><tt>1</tt></td></tr>
<tr><td><tt>PageOrderingAccounts</tt></td><td>arbitrary</td><td>same as <tt>PageOrderingVoteRecorder</tt>, duplicates removed</td></tr>
<tr><td><tt>PageOrderingCorkDisplay</tt></td><td>same as <tt>GlassesClusteredOnCorkDisplay</tt></td><td><tt>1</tt></td></tr>
<tr><td><tt>PageOrderingNeckTags</tt></td><td>same as <tt>GlassesOnSheets</tt></td><td><tt>1</tt></td></tr>
<tr><td><tt>PageOrderingPrePourPages</tt></td><td>same as <tt>GlassesOnSheets</tt></td><td><tt>1</tt></td></tr>
<tr><td><tt>PageOrderingPlaceNames</tt></td><td>same as <tt>NamesPlaceNames</tt></td><td><tt>100</tt></td><td class="Shrunk">Separated from <tt>1</tt>s to facilitate pre-tasting folding.</td></tr>
<tr><td><tt>PageOrderingDecanterLabels</tt></td><td>same as <tt>GlassesOnSheets</tt></td><td><tt>200</tt></td><td class="Shrunk">Separated from above to facilitate pre-tasting gluing.</td></tr>
<tr><td><tt>PageOrderingStickyLabels</tt></td><td>same as <tt>GlassesOnSheets</tt></td><td><tt>300</tt></td><td class="Shrunk">Separated from above so there is a single switch of printer paper to the labels.</td></tr>
</table>

<p>Draws are resolved in a manner that separates pages on different paper types, perhaps simplifing printer loading, 
as described by the following algorithm (in which &ldquo;matching&rdquo; means matching the page ordering and the paper type).</p>

<ul>
	<li>Loop over all used page orderings.
	<ul>
		<li>Loop over all used paper types.
		<ul>
			<li>Loop over all <tt>Names</tt>, the decanter labels being deemed to be suffixed to the end of <tt>Names</tt>.
			<ul>
				<li>Paint matching <tt>/Glasses</tt> pages (including matching decanter-label variants);</li>
				<li>Paint matching <tt>/TastingNotes</tt> pages;</li>
				<li>Paint matching <tt>/PlaceName</tt> pages;</li>
			</ul>
			<small><small>End <tt>Names</tt> loop</small></small></li>
			<li>Paint matching <tt>/VoteRecorder</tt> pages;</li>
			<li>Paint matching <tt>/DecantingNotes</tt> pages;</li>
			<li>Paint matching <tt>/Accounts</tt> pages;</li>
			<li>Paint matching <tt>/CorkDisplay</tt> pages;</li>
			<li>Paint matching <tt>/NeckTags</tt> pages;</li>
			<li>Paint matching <tt>/PrePour</tt> pages;</li>
			<li>Paint matching <tt>/StickyLabels</tt> pages.</li>
		</ul>
		<small><small>End paper-type loop</small></small></li>
	</ul>
	<small><small>End page-orderings loop</small></small></li>
</ul>

<p>The values in <tt>PageOrderingGlasses</tt> are also used by <tt><a href="#maxradius">ShrinkRadii</a></tt> 
as they are presumed to define sessions. 
The values in <tt>PageOrderingGlasses</tt> are also used to determine the default values of 
<tt><a href="#waterboxes">WaterBoxesShowRight</a></tt> and <tt><a href="#waterboxes">WaterBoxesShowLeft</a></tt>.</p>

<div id="PageOrderingSections">
<div style="clear: right;  float: right;  margin-left: 4px;"><a href="http://www.theportforum.com/viewtopic.php?t=7404"><img width="146" height="920" src="preview_table_contents.png" alt="Example Table of contents" title="Table of Contents from Mac Preview of AHB&rsquo;s Quinquagenary 1963 Horizontal"></a></div>
<p>The sections can be lightly titled. 
The parameter <tt>PageOrderingSections</tt> is an array of even length, alternately items of the page orderings and compound strings, that adds extra rows to the PDF reader&rsquo;s table of contents. 
The compound strings appear before the page orderings with which they are paired. 
On the right is an extract from a screen image, taken from a Mac&rsquo;s PDF reader, Preview. 
The <span style="background-color: #ffe0e0;">pinked regions</span> (highlighted here for clarity but not in <a href="http://www.jdawiseman.com/2013/20131011_1963_ahb.pdf">the actual PDF</a>) were added with the following&mdash;do observe the separate addition of the empty lines. 
(Since this was made the software has become more assiduous about adding page numbers to the Table of Contents.) 
Alas Mac Preview, at least up to version 10.0 (944.5), ignores a little of the formating, as illustrated on the <a href="https://discussions.apple.com/thread/5317016">Apple Support Communities</a>.</p>
<pre><span class="nametype">/PageOrderingSections</span> <span class="array">[</span>
	  0  <span class="stringtype">()</span>
	  0  <span class="array">[</span><span class="nametype">/section</span> <span class="stringtype">( Friday evening, Cantley House)</span><span class="array">]</span>
	 10  <span class="stringtype">()</span>
	 10  <span class="array">[</span><span class="nametype">/section</span> <span class="stringtype">( Saturday afternoon, Walter Arms)</span><span class="array">]</span>
	 20  <span class="stringtype">()</span>
	 20  <span class="array">[</span><span class="nametype">/section</span> <span class="stringtype">( Saturday evening, Cantley House)</span><span class="array">]</span>
	200  <span class="stringtype">()</span>
	200  <span class="array">[</span><span class="nametype">/section</span> <span class="stringtype">( Multiple sessions)</span><span class="array">]</span>
<span class="array">]</span> <span class="operator">def</span></pre>
</div>

<h3 id="PagesToBeInserted"><a href="#PagesToBeInserted">&bull;</a>&nbsp;<tt>PagesToBeInserted&hellip;</tt></h3>
<p>Sometimes PDF pages are to be inserted after the PostScript, typically made in Word or Excel or another application. 
That mostly works, except that it would mess the page numbering in the Table of Contents. 
This can be repaired, and the inserted pages can have their own ToC entries. 
Start by <tt><span class="nametype">/PagesToBeInserted</span> <span class="operator">true</span> <span class="operator">def</span></tt>. 
Then there are five arrays of the same length, one of which is an array of arrays. 
ToC entries appear before a page of one of the types in the sub-arrays of <tt>PagesToBeInsertedBeforeTypeOneOf</tt>, and before instance number of the item of <tt>PagesToBeInsertedBeforeInstances</tt>. 
(The double-depth array allows some flexibility by <i>de facto</i> merging several types; and instance <tt>0</tt> is the first such block of these types, <tt>1</tt> the second, etc.) 
If the element of <tt>PagesToBeInsertedDests</tt> is a name, so beginning with a &ldquo;<tt><span class="nametype">/</span></tt>&rdquo;, there will be a ToC entry pointing to this &lsquo;<tt>DEST</tt>&rsquo;, titled with the element of <tt>PagesToBeInsertedDescriptions</tt>. 
And the number of pages being inserted is the element of <tt>PagesToBeInsertedNumPages</tt>, which allows the page numbering to be correct.</p>

<p>If changing the PDF with Mac Adobe Pro XI, the user could take the following steps. 
&bull;&nbsp;<img width="14" height ="14" alt="Adobe Pro XI, show thumbnails icon"src="AdobeProXI_ShowThumbnails.png">&nbsp;Show the page thumbnails. 
&bull;&nbsp;Drag from the finder to the gap between the appropriate pages the PDF to be inserted. 
&bull;&nbsp;Right-click the inserted page, &lsquo;Number&nbsp;Pages&hellip;&rsquo;; Style=&lsquo;None&rsquo;, Prefix=&ldquo;Food order&rdquo;. 
&bull;&nbsp;<img width="14" height ="14" alt="Adobe Pro XI, show DESTinations icon"src="AdobeProXI_ShowDests.png">&nbsp;Show the <tt>DEST</tt>inations. 
&bull;&nbsp;Navigate to inserted page; <img width="11" height ="10" alt="Adobe Pro XI, new DESTinations icon"src="AdobeProXI_NewDest.png">&nbsp;click new <tt>DEST</tt>ination icon; give it the correct name (such as &ldquo;<tt>FoodOrder_0</tt>&rdquo;, <b>without</b> the &ldquo;<tt><span class="nametype">/</span></tt>&rdquo; prefix needed in the PostScript). 
&bull;&nbsp;Save. Done.</p>

<h3 id="page_mirroring"><a href="#page_mirroring">&bull;</a>&nbsp;Page mirroring</h3>
<p>&loz; Generally one should print using toner not ink, as a single drop of wine or water causes ink to smudge. 
Alternatively, one could print the glasses mats onto acetate, and use the non-printed side. 
This requires mirroring the page, this being controlled by the eight arrays <tt>MirrorPagesGlasses</tt>, 
<tt>MirrorPagesTastingNotePages</tt>, <tt>MirrorPagesVoteRecorder</tt>, <tt>MirrorPagesDecantingNotes</tt>, <tt>MirrorPagesAccounts</tt>, <tt>MirrorPagesCorkDisplay</tt>, 
<tt>MirrorPagesPrePour</tt>, <tt>MirrorPagesPlaceNames</tt>, <tt>MirrorPagesDecanterLabels</tt>, and <tt>MirrorPagesStickyLabels</tt>.
These are of the  same length as the arrays <tt><a href="#page_order">PageOrdering</a></tt>&hellip;, though contain booleans.
By default all values are false.</p>

<p>Use of page mirroring should be accompanied by use of <tt><a href="#page_order">PageOrdering</a></tt>&hellip;, 
to ensure that the acetates are consecutive.</p>

<h3 id="numcopies"><a href="#numcopies">&bull;</a>&nbsp;Numbers of copies</h3>
<p>For most types of sheet, there is a parameter controlling how many copies appear. 
Already described are <tt><a href="#decanterlabels">DecanterLabelsNumCopies</a></tt>, 
<tt><a href="#stickylabels">StickyLabelsNumCopies</a></tt>, 
<tt><a href="#prepour">PrePourNumCopies</a></tt>, 
<tt><a href="#decantingnotes">DecantingNotesNumCopies</a></tt>, 
<tt><a href="#decantingnotes">AccountsNumCopies</a></tt>. 
Analogously, there are parameters <tt>GlassesNumCopies</tt> and <tt>TastingNotePagesNumCopies</tt>, both defaulting to <tt>1</tt>. 
For the vote-recorder sheets the parameter is a boolean, <tt><a href="#voterecorder">VoteRecorders</a></tt>.</p>

<p><tt>GlassesNumCopies</tt> has a role that is not obvious. 
For both the <a href="#prepour">pre-pour sheets</a> and the <a href="#stickylabels">sticky labels</a> what appears there is a scaled version of that on the glasses sheets. 
So if a wine does not appear on the glasses sheets, it cannot appear on the pre-pours or sticky labels. 
But what if this is wanted? 
What if the pre-pour sheets should be known wines such as D63 F63 G63 T63, but the glasses sheets should be a blinded version of this such as &alpha;63 &beta;63 &gamma;63 &delta;63 (<a href="http://www.jdawiseman.com/port/20111011.pdf">example of such a tasting</a>)? 
Then construct additional glasses sheets to hold the material for the extra pre-pour or sticky-label sheets, but suppress their output with something like <tt><span class="nametype">/GlassesNumCopies</span> <span class="array">{</span>SheetNum 4 <span class="operator">ge</span> <span class="array">{</span>0<span class="array">}</span> <span class="array">{</span>1<span class="array">}</span> <span class="operator">ifelse</span><span class="array">}</span> <span class="operator">def</span></tt>. 
That done, the values of <tt><a href="#tasting_note_pages">GlassesOnTastingNotePages</a></tt> and <tt><a href="#decantingnotes">GlassesClusteredOnDecantingNotes</a></tt> might also need work.</p>

<h3 id="page_suppression"><a href="#page_suppression">&bull;</a>&nbsp;Suppressing pages</h3>
<p>You have made the placemats for somebody else&rsquo;s large tasting. 
But that somebody else wants to change a font; or doesn&rsquo;t know what is a pre-pour sheet nor whether they are wanted. 
One could make several new versions, each of several megabytes and several hundred pages, and email those. 
But only a few pages are relevant. 
One could kill the other pages by specifying <tt>0</tt> copies or setting their presence to <tt><span class="operator">false</span></tt>, and by reducing the number of wines and people. 
What a faff, and because of the interactions between font sizes, doing so might change the shown pages. 
Instead suppress temporarily-unwanted page types with the array <tt>TestingSuppressPageTypes</tt>, which can contain any of 
<tt><span class="nametype">/Glasses</span></tt> <tt><span class="nametype">/TastingNotes</span></tt> <tt><span class="nametype">/VoteRecorder</span></tt> <tt><span class="nametype">/DecantingNotes</span></tt> <tt><span class="nametype">/Accounts</span></tt> <tt><span class="nametype">/CorkDisplay</span></tt> <tt><span class="nametype">/NeckTags</span></tt> <tt><span class="nametype">/PrePour</span></tt> <tt><span class="nametype">/PlaceName</span></tt> <tt><span class="nametype">/DecanterLabels</span></tt> <tt><span class="nametype">/StickyLabels</span></tt> <tt><span class="nametype">/DistillerLog</span></tt>. 
Any of these (except <tt><span class="nametype">/DistillerLog</span></tt>) may be followed by an integer, which is the maximum number of that type to be produced.
Alternatively, <tt>TestingMaxNumPagesToShow</tt> is a pages-of-any-type maximum number&mdash;subsequent pages being suppressed. 
(But, due to <a href="https://groups.google.com/forum/#!topic/comp.lang.postscript/HVZVz0eBwrw">a bug in <tt><span class="operator">erasepage</span></tt></a>, it is possible that there could be an extra page at the end, blank.)</p>
<p>Or use neither of these, instead <tt><span class="operator">def</span></tt>fing <tt>TestingShowThesePagesOnly</tt> to an array of integers, zero-based, of the pages to show. (If making a PDF for inclusion in another document, perhaps also suppress non-printing artefacts with &ldquo;<tt><span class="nametype">/pdfmark</span> <span class="array">{</span><span class="operator">cleartomark</span><span class="array">}</span> <span class="operator">def</span></tt>&rdquo;.)</p>

<h3 id="CMYK"><a href="#CMYK">&bull;</a>&nbsp;CMYK black</h3>
<p>There are different colour models, aka colour spaces, in which colours can be defined. 
Some printers work much better with CMYK colours than with screen-optimal RGB. 
By default, this software uses RGB colours. 
Setting the parameter <tt>CMYK0001replacesRGB000</tt> to <tt><span class="nametype">true</span></tt> causes RGB black (<tt>0&nbsp;<span class="nametype">setgray</span></tt> = <tt>0&nbsp;0&nbsp;0&nbsp;<span class="nametype">setrgbcolor</span></tt>) to be replaced with CMYK black (<tt>0&nbsp;0&nbsp;0&nbsp;1&nbsp;<span class="nametype">setcmykcolor</span></tt>). 
This could be extended to greys: expert comment would be welcomed (see <a href="http://www.theportforum.com/viewtopic.php?t=175&amp;start=1093">TPF</a> and <a href="https://www.fortheloveofport.com/ftlopforum/viewtopic.php?t=1206&amp;start=90">FTLoP</a>).</p>

<h2 id="placematcopyright"><a href="#placematcopyright">&bull;</a>&nbsp;Placemat &copy;</h2>
<p>Who owns the &copy; of the output, of the placemats? 
The parameter <tt>CopyrightStatementPlacemats</tt> holds this, defaulting to &ldquo;Copyright 2020 Julian&nbsp;D.&nbsp;A.&nbsp;Wiseman of www.jdawiseman.com&rdquo;. 
Obviously, adjust to your needs, copying the form. 
By default others may use the output, as given in the human-readable text <tt>LicensingAgreementTextPlacemats</tt>, defaulting to &ldquo;This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International Licence.&rdquo; 
There is the related parameter <tt>LicensingAgreementLinkPlacemats</tt>, defaulting to <tt><span class="stringtype">(<a href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_GB">http://creativecommons.org/licenses/by-sa/4.0/deed.en_GB</a>)</span></tt>. 
Obviously <tt>LicensingAgreement<b>Text</b>Placemats</tt> and <tt>LicensingAgreement<b>Link</b>Placemats</tt> should be consistent. 
It is hoped to embed these permissions, and perhaps additional parameters, in a machine-readable manner. 
Please could those with expertise in the use of <tt>pdfmark</tt> read the <a href="https://groups.google.com/forum/#!topic/comp.lang.postscript/2SM9hpY2xBI">request for help</a>, and then help.</p>

<h2 id="code"><a href="#code">&bull;</a>&nbsp;Code within parameters</h2>
<p><a href="placemat-code.html#varying-parameters-summary">Another manual page</a> explains how and why to vary the parameters by sheet or by glass, and how and why to add code inside compound strings.</p>

<table id="url_tags" class="TableParameterSpecification" style="clear: both;  float: right;"><tr><th>Page type</th><th><small><tt>TypeOfPagesBeingRendered</tt></small></th><th>URL ending of first<br>page of this type</th></tr>
<tr><td>Glasses</td><td><tt><span class="nametype">/Glasses</span></tt></td><td><span class="PseudoLink">&hellip;#Glasses_0</span></td></tr>
<tr><td>Tasting notes</td><td><tt><span class="nametype">/TastingNotes</span></tt></td><td><span class="PseudoLink">&hellip;#TastingNotes_0</span></td></tr>
<tr><td>Vote recorders</td><td><tt><span class="nametype">/VoteRecorder</span></tt></td><td><span class="PseudoLink">&hellip;#VoteRecorder_0</span></td></tr>
<tr><td>Decanting notes</td><td><tt><span class="nametype">/DecantingNotes</span></tt></td><td><span class="PseudoLink">&hellip;#DecantingNotes_0</span></td></tr>
<tr><td>Accounts</td><td><tt><span class="nametype">/Accounts</span></tt></td><td><span class="PseudoLink">&hellip;#Accounts_0</span></td></tr>
<tr><td>Cork display</td><td><tt><span class="nametype">/CorkDisplay</span></tt></td><td><span class="PseudoLink">&hellip;#CorkDisplay_0</span></td></tr>
<tr><td>Neck-tag pages</td><td><tt><span class="nametype">/NeckTags</span></tt></td><td><span class="PseudoLink">&hellip;#NeckTags_0</span></td></tr>
<tr><td>Pre-pour pages</td><td><tt><span class="nametype">/PrePour</span></tt></td><td><span class="PseudoLink">&hellip;#PrePour_0</span></td></tr>
<tr><td>Place names</td><td><tt><span class="nametype">/PlaceName</span></tt></td><td><span class="PseudoLink">&hellip;#PlaceName_0</span></td></tr>
<tr><td>Decanter labels</td><td><tt><span class="nametype">/DecanterLabels</span></tt></td><td><span class="PseudoLink">&hellip;#DecanterLabels_0</span></td></tr>
<tr><td>Sticky labels</td><td><tt><span class="nametype">/StickyLabels</span></tt></td><td><span class="PseudoLink">&hellip;#StickyLabels_0</span></td></tr>
</table>

<h2 id="linking_within_pdf"><a href="#linking_within_pdf">&bull;</a>&nbsp;Linking to specific pages within the PDF</h2>

<p>So that it is possible to link to specific pages within the PDF, the PDF includes some &lsquo;<span style="font-family: monospace;">nameddest</span>&rsquo;s. 
However, the  use of these is imperfectly reliable (see <a href="http://groups.google.com/group/comp.text.pdf/browse_thread/thread/0b6439fe8ccef9b3">help received</a>). 
It seems to work when opening a PDF within the browser, but if the PDF is read by a separate application, it seems not to work.</p> 

<p>To link to the first of the pages of glasses the URL should end <span class="PseudoLink">&hellip;#Glasses_0</span>. 
For second page, <span class="PseudoLink">&hellip;#Glasses_1</span>; etc. 
Links for other types of pages are shown in the <a href="#url_tags">table on the right</a>.
The log file also contains a list of the &ldquo;URL # tags&rdquo; added to the PDF. 
<p>If <tt>GlassesDestForEachCircle</tt> is <tt><span class="operator">true</span></tt>, there are also # tags for individual glass circles, as detailed in the log. 
(But not all PDF viewers correctly zoom to these circles: see bugs in <a href="https://discussions.apple.com/thread/7234631">Apple Preview</a> and <a href="https://code.google.com/p/chromium/issues/detail?id=535978">Google Chrome</a>.) 
For some actual placemats, changing <tt>GlassesDestForEachCircle</tt> from <tt><span class="operator">false</span></tt> to <tt><span class="operator">true</span></tt> increased the file size from &asymp;&nbsp;360k to &asymp;&nbsp;400k, &asymp;&nbsp;11%: not tiny. 
These &lsquo;Dest&rsquo;s are most useful for the placemat maker, speeding the checking of an individual circle&ndash;but there&rsquo;s no need to check the same circle on multiples <tt>Names</tt>, because they are all the same. 
So <tt>GlassesDestForEachCircle</tt>&rsquo;s default value is <tt><span class="array">{</span>NameNum 0 <span class="operator">eq</span><span class="array">}</span></tt>, which makes them for only the first of the <tt>Names</tt>.</p>

<h2 id="errors"><a href="#errors">&bull;</a>&nbsp;Errors: causation and avoidance</h2>

<p>This is a PostScript program, and its various parameters are entered directly in PostScript. 
The program does little error checking. 
If parameters are malformed (e.g., non-matching parentheses), or if the parameters have nonsense values, 
then the output might be inelegant, incomplete, or non-existent.</p> 

<p>If it just won&rsquo;t work, then start again with <a href="http://www.jdawiseman.com/papers/placemat/placemat.ps">the code as published at www.jdawiseman.com</a>. 
Does that distill correctly? Then change the <tt>Titles</tt> etc, and set the 
<tt>Circlearrays</tt> to be something simple of the same length. Does that distill correctly? 
Then add any required complexity to the <tt>Circlearrays</tt>, and re-test, before setting the other parameters one at a time. 
If you believe yourself to be coping competently, and it still won&rsquo;t work, 
contact <a href="../../author.html">the author</a>, 
enclosing in the email a link to the PostScript file and the log file produced by the distiller, 
and saying which program you use for the ps&rarr;pdf conversion.</p>

<p id="log_file"><a href="#log_file">&loz;</a> The program outputs to a log file. 
This can contain various &lsquo;Error&rsquo;s, &lsquo;Warning&rsquo;s, and &lsquo;Advice&rsquo;s, as well as values of variables and other diagnostics. 
Perusal of this data might help. 
If <tt>OutputLogToPage</tt> is still at its default value of <tt><span class="operator">true</span></tt>, this log file also appears at the end of the output. 
There are the analogous Boolean parameters <tt>OutputLogTo<b>Log</b></tt> and <tt>OutputLogTo<b>Annotation</b></tt>, and also a user-chosen string <tt>LogThisExtra</tt> which is output to the log.</p>

<h2 id="comment"><a href="#comment">&bull;</a>&nbsp;Comment</h2>
<p>The <a href="../../author.html">author</a> welcomes comment on this program, 
which may be by email or in the appropriate thread on 
<a href="http://www.theportforum.com/viewtopic.php?t=175&amp;view=unread#unread">The Port Forum</a> 
There are also threads on <a href="https://www.fortheloveofport.com/ftlopforum/viewtopic.php?t=1206&amp;view=unread#unread">For The Love Of Port</a>, 
on <a href="http://www.wineberserkers.com/forum/viewtopic.php?t=12565&amp;view=unread#unread">Wine Berserkers</a>, 
and on <a href="https://wine-pages.com/community/threads/placemats-for-tastings-software-that-makes.6090/#post-108864">wine-pages.com</a>). 
Conceptualy slightly separate, there is also <a href="http://www.theportforum.com/viewtopic.php?t=5837&amp;view=unread#unread">a thread showing the used parameters from actual tastings</a>, some of which appear on the <a href="placemats_list.html">list of placemats</a>.</p> 
<!--
 | <a href="http://www.whiskywhiskywhisky.com/forum/viewtopic.php?t=7881&amp;view=unread#unread">WhiskyWhiskyWhisky.com</a>
 | <a href="https://www.cellartracker.com/forum/tm.asp?m=11618">CellarTracker</a>
 | <a href="http://dat.erobertparker.com/bboard/showthread.php?goto=lastpost&amp;t=204202">eRobertParker</a>
 | <a href="http://www.jancisrobinson.com/forum/showthread.php?t=6246&amp;view=unread#unread">JancisRobinson.com</a>
-->

<h2 id="invite" style="clear: left;"><a href="#invite">&bull;</a>&nbsp;Who to invite?</h2>

<p>Permission is given to make non-commercial use of this program as you see fit, and to distribute its output. 
But not to distribute <a href="http://www.jdawiseman.com/papers/placemat/placemat.ps">the code</a>: refer interested parties to the latest version via this page 
(<a href="http://www.jdawiseman.com/papers/placemat/placemat.html">www.jdawiseman.com/papers/&#8203;placemat/&#8203;placemat.html</a>). 
Those with improvements to the code are invited to send them to <a href="../../author.html">the author</a>.</p>

<p>It hardly needs saying that the finest way to thank me for this excellent product would be an invitation to your tasting! 
I&rsquo;m particularly fond of Port and Madeira, and to a lesser extent of whisky and beer, but am willing to have my horizons broadened. 
Let me check my diary&hellip; yes, that evening is good&mdash;thank you very much indeed.</p>

<p align="right"><i>&mdash;&nbsp;Julian D. A. Wiseman</i></p>

<hr>

<h2 id="version_history"><a href="#version_history">&bull;</a>&nbsp;Recent changes</h2>

<h3>January 2021</h3>
<ul>
<li><p>+<tt><a href="#log_file">OutputLogToAnnotation</a></tt>.</p></li>
</ul>

<h3>October 2020</h3>
<ul>
<li><p><a href="#Droplets">DropletsCharges</a> can now spin, so the array of length a multiple of 4.</p></li>
</ul>

<hr style="clear: both;">

<table width="100%" border="0" id="end">
<tr>
	<td width="40%" align="left"><a href="../../index.html">Main index</a></td>
	<td width="20%" align="center"><a href="#top">Top</a></td>
	<td width="40%" align="right"><a href="../../author.html">About author</a></td>
</tr></table>

</body>
</html>
